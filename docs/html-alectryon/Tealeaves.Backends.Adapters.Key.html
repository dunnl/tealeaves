<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.21.2: https://docutils.sourceforge.io/" />
<title>Key.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.16.0+0.16.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Tealeaves <span class="kn">Require Import</span>
  Backends.LN.LN
  Backends.LN.Atom
  Backends.DB.DB
  Functors.List
  Functors.Option
  Classes.Categorical.ContainerFunctor
  Classes.Kleisli.DecoratedContainerFunctor.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Open Scope</span> nat_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span>
  List.ListNotations
  ContainerFunctor.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Generalizable All Variables</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Miscellaneous lemmas *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk0"><span class="kn">Lemma</span> <span class="nf">nin_list_cons</span>:
  <span class="kr">forall</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">a1</span> <span class="nv">a2</span> : A) (<span class="nv">xs</span> : list A),
    ~ a1 ‚àà (a2 :: xs) &lt;-&gt; a1 &lt;&gt; a2 /\ ~ a1 ‚àà xs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">a1</span> <span class="nv">a2</span> : A) (<span class="nv">xs</span> : list A),
~ a1 ‚àà (a2 :: xs) &lt;-&gt; a1 &lt;&gt; a2 /\ ~ a1 ‚àà xs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">a1</span> <span class="nv">a2</span> : A) (<span class="nv">xs</span> : list A),
~ a1 ‚àà (a2 :: xs) &lt;-&gt; a1 &lt;&gt; a2 /\ ~ a1 ‚àà xs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk2"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a1, a2</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a1 ‚àà (a2 :: xs) &lt;-&gt; a1 &lt;&gt; a2 /\ ~ a1 ‚àà xs</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk3"><span class="nb">rewrite</span> element_of_list_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a1, a2</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (a1 = a2 \/ a1 ‚àà xs) &lt;-&gt; a1 &lt;&gt; a2 /\ ~ a1 ‚àà xs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intuition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk4"><span class="kn">Lemma</span> <span class="nf">map_Some_inv</span>: <span class="kr">forall</span> `(f: A -&gt; B) (x: option A)  y,
    (<span class="kr">forall</span> <span class="nv">a</span> <span class="nv">a&#39;</span>, f a = f a&#39; -&gt; a = a&#39;) -&gt;
    map f x = Some (f y) -&gt;
    x = Some y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B) (<span class="nv">x</span> : option A)
  (<span class="nv">y</span> : A),
(<span class="kr">forall</span> <span class="nv">a</span> <span class="nv">a&#39;</span> : A, f a = f a&#39; -&gt; a = a&#39;) -&gt;
map f x = Some (f y) -&gt; x = Some y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B) (<span class="nv">x</span> : option A)
  (<span class="nv">y</span> : A),
(<span class="kr">forall</span> <span class="nv">a</span> <span class="nv">a&#39;</span> : A, f a = f a&#39; -&gt; a = a&#39;) -&gt;
map f x = Some (f y) -&gt; x = Some y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk6">introv Hinj Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>option A</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hinj</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">a&#39;</span> : A, f a = f a&#39; -&gt; a = a&#39;</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>map f x = Some (f y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = Some y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk7"><span class="nb">destruct</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>a, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hinj</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">a&#39;</span> : A, f a = f a&#39; -&gt; a = a&#39;</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>map f (Some a) = Some (f y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some a = Some y</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hinj</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">a&#39;</span> : A, f a = f a&#39; -&gt; a = a&#39;</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>map f None = Some (f y)</span></span></span><br></div><label class="goal-separator" for="key-v-chk8"><hr></label><div class="goal-conclusion">None = Some y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>a, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hinj</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">a&#39;</span> : A, f a = f a&#39; -&gt; a = a&#39;</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>map f (Some a) = Some (f y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some a = Some y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chka"><span class="nb">inversion</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>a, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hinj</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">a&#39;</span> : A, f a = f a&#39; -&gt; a = a&#39;</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>map f (Some a) = Some (f y)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>f a = f y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some a = Some y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkb">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>a, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hinj</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">a&#39;</span> : A, f a = f a&#39; -&gt; a = a&#39;</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>map f (Some a) = Some (f y)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>f a = f y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkc"><span class="nb">apply</span> Hinj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>a, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hinj</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">a&#39;</span> : A, f a = f a&#39; -&gt; a = a&#39;</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>map f (Some a) = Some (f y)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>f a = f y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = f y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hinj</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">a&#39;</span> : A, f a = f a&#39; -&gt; a = a&#39;</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>map f None = Some (f y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">None = Some y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Heq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">compare_atoms</span> :=
    <span class="kr">match goal with</span>
    | H: <span class="kp">context</span>[<span class="nl">?a</span> == <span class="nl">?a&#39;</span>] |- _ =&gt;
        destruct_eq_args a a&#39;
    | |- <span class="kp">context</span>[<span class="nl">?a</span> == <span class="nl">?a&#39;</span>] =&gt;
        destruct_eq_args a a&#39;
    <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Tactic Notation</span> <span class="s2">&quot;compare&quot;</span> <span class="s2">&quot;atoms&quot;</span> := compare_atoms.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Definition of &lt;&lt;key&gt;&gt; and main operations *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">key</span> :=
  list atom.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Insertion and lookup *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">key_insert_atom</span> (<span class="nv">k</span>: key) (<span class="nv">a</span>: atom): key :=
  <span class="kr">match</span> k <span class="kr">with</span>
  | nil =&gt; [a]
  | cons x rest =&gt;
      <span class="kr">if</span> a == x <span class="kr">then</span> k <span class="kr">else</span>
        x :: key_insert_atom rest a
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">key_lookup_atom</span> (<span class="nv">k</span>: key) (<span class="nv">a</span>: atom): option nat :=
  <span class="kr">match</span> k <span class="kr">with</span>
  | [] =&gt; None
  | x :: rest =&gt;
      <span class="kr">if</span> a == x
      <span class="kr">then</span> Some <span class="mi">0</span>
      <span class="kr">else</span> map S (key_lookup_atom rest a)
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">key_lookup_index</span> (<span class="nv">k</span>: key) (<span class="nv">ix</span>: nat): option atom :=
  <span class="kr">match</span> k, ix <span class="kr">with</span>
  | nil, _ =&gt; None
  | cons a rest, <span class="mi">0</span> =&gt; Some a
  | cons a rest, S ix =&gt; key_lookup_index rest ix
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">key_lookup_atom_rec</span> (<span class="nv">k</span>: key) (<span class="nv">acc</span>: nat) (<span class="nv">a</span>: atom): option nat :=
  <span class="kr">match</span> k <span class="kr">with</span>
  | nil =&gt; None
  | cons x rest =&gt;
      <span class="kr">if</span> a == x <span class="kr">then</span> Some acc <span class="kr">else</span> key_lookup_atom_rec rest (S acc) a
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">key_lookup_atom_alt</span>: key -&gt; atom -&gt; option nat :=
  <span class="kr">fun</span> <span class="nv">k</span> =&gt; key_lookup_atom_rec k <span class="mi">0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Well-formedness predicates *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">unique</span> (<span class="nv">l</span>: list atom): <span class="kt">Prop</span> :=
  <span class="kr">match</span> l <span class="kr">with</span>
  | nil =&gt; <span class="kt">True</span>
  | cons a rest =&gt;
      ~ (a ‚àà rest) /\ unique rest
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">wf_LN</span>
  `{ToSubset T} (t: T LN) (k: key): <span class="kt">Prop</span> :=
  unique k /\ <span class="kr">forall</span> (<span class="nv">x</span>: atom), Fr x ‚àà t -&gt; x ‚àà k.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">contains_ix_upto</span> (<span class="nv">n</span>: nat) (<span class="nv">k</span>: key): <span class="kt">Prop</span> :=
  n &lt; length k.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">wf_DB</span> `{ToCtxset nat T} (t: T nat) (k: key): <span class="kt">Prop</span> :=
  unique k /\ <span class="kr">exists</span> (<span class="nv">gap</span>: nat), cl_at gap t /\ contains_ix_upto gap k.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Misc *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chke"><span class="kn">Definition</span> <span class="nf">key_is_atom_in</span> (<span class="nv">k</span>: key) (<span class="nv">a</span>: atom):
  {a ‚àà k} + {~ a ‚àà k}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a ‚àà k} + {~ a ‚àà k}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a ‚àà k} + {~ a ‚àà k}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk10"><span class="nb">induction</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a ‚àà []} + {~ a ‚àà []}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk11" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>{a ‚àà k} + {~ a ‚àà k}</span></span></span><br></div><label class="goal-separator" for="key-v-chk11"><hr></label><div class="goal-conclusion">{a ‚àà (a0 :: k)} + {~ a ‚àà (a0 :: k)}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk12">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a ‚àà []} + {~ a ‚àà []}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk13"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk14">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>{a ‚àà k} + {~ a ‚àà k}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a ‚àà (a0 :: k)} + {~ a ‚àà (a0 :: k)}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk15"><span class="nb">pose</span> (element_of_list_cons a a0 k).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>{a ‚àà k} + {~ a ‚àà k}</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>element_of_list_cons a a0 k</span></span><span class="hyp-type"><b>: </b><span>a ‚àà (a0 :: k) &lt;-&gt; a = a0 \/ a ‚àà k</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a ‚àà (a0 :: k)} + {~ a ‚àà (a0 :: k)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk16"><span class="nb">destruct</span> (a == a0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>{a ‚àà k} + {~ a ‚àà k}</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>element_of_list_cons a a0 k</span></span><span class="hyp-type"><b>: </b><span>a ‚àà (a0 :: k) &lt;-&gt; a = a0 \/ a ‚àà k</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>a = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a ‚àà (a0 :: k)} + {~ a ‚àà (a0 :: k)}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk17" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>{a ‚àà k} + {~ a ‚àà k}</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>element_of_list_cons a a0 k</span></span><span class="hyp-type"><b>: </b><span>a ‚àà (a0 :: k) &lt;-&gt; a = a0 \/ a ‚àà k</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br></div><label class="goal-separator" for="key-v-chk17"><hr></label><div class="goal-conclusion">{a ‚àà (a0 :: k)} + {~ a ‚àà (a0 :: k)}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk18">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>{a ‚àà k} + {~ a ‚àà k}</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>element_of_list_cons a a0 k</span></span><span class="hyp-type"><b>: </b><span>a ‚àà (a0 :: k) &lt;-&gt; a = a0 \/ a ‚àà k</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>a = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a ‚àà (a0 :: k)} + {~ a ‚àà (a0 :: k)}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> (<span class="nb">left</span>; <span class="nb">left</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk19">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>{a ‚àà k} + {~ a ‚àà k}</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>element_of_list_cons a a0 k</span></span><span class="hyp-type"><b>: </b><span>a ‚àà (a0 :: k) &lt;-&gt; a = a0 \/ a ‚àà k</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a ‚àà (a0 :: k)} + {~ a ‚àà (a0 :: k)}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1a"><span class="nb">destruct</span> IHk.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>element_of_list_cons a a0 k</span></span><span class="hyp-type"><b>: </b><span>a ‚àà (a0 :: k) &lt;-&gt; a = a0 \/ a ‚àà k</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a ‚àà (a0 :: k)} + {~ a ‚àà (a0 :: k)}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk1b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>element_of_list_cons a a0 k</span></span><span class="hyp-type"><b>: </b><span>a ‚àà (a0 :: k) &lt;-&gt; a = a0 \/ a ‚àà k</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br></div><label class="goal-separator" for="key-v-chk1b"><hr></label><div class="goal-conclusion">{a ‚àà (a0 :: k)} + {~ a ‚àà (a0 :: k)}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1c">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>element_of_list_cons a a0 k</span></span><span class="hyp-type"><b>: </b><span>a ‚àà (a0 :: k) &lt;-&gt; a = a0 \/ a ‚àà k</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a ‚àà (a0 :: k)} + {~ a ‚àà (a0 :: k)}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> (<span class="nb">left</span>; <span class="nb">right</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1d">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>element_of_list_cons a a0 k</span></span><span class="hyp-type"><b>: </b><span>a ‚àà (a0 :: k) &lt;-&gt; a = a0 \/ a ‚àà k</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a ‚àà (a0 :: k)} + {~ a ‚àà (a0 :: k)}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1e"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>element_of_list_cons a a0 k</span></span><span class="hyp-type"><b>: </b><span>a ‚àà (a0 :: k) &lt;-&gt; a = a0 \/ a ‚àà k</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà (a0 :: k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1f"><span class="nb">rewrite</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>element_of_list_cons a a0 k</span></span><span class="hyp-type"><b>: </b><span>a ‚àà (a0 :: k) &lt;-&gt; a = a0 \/ a ‚àà k</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (a = a0 \/ a ‚àà k)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> [contra|contra];
          <span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk20"><span class="kn">Definition</span> <span class="nf">key_is_ix_in</span> (<span class="nv">k</span>: key) (<span class="nv">ix</span>: nat):
  {contains_ix_upto ix k} + {~ contains_ix_upto ix k}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{contains_ix_upto ix k} + {~ contains_ix_upto ix k}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk21"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{contains_ix_upto ix k} + {~ contains_ix_upto ix k}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk22"><span class="nb">unfold</span> contains_ix_upto.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{ix &lt; length k} + {~ ix &lt; length k}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk23"><span class="nb">generalize</span> ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">ix</span> : nat, {ix &lt; length k} + {~ ix &lt; length k}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk24"><span class="nb">generalize</span> (length k).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> <span class="nv">ix</span> : nat, {ix &lt; n} + {~ ix &lt; n}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk25"><span class="nb">intros</span> a b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix, a, b</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{b &lt; a} + {~ b &lt; a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Compare_dec.le_dec.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Lemmas about &lt;&lt;key_insert_atom&gt;&gt; *)</span>
<span class="sd">(******************************************************************************)</span>

<span class="sd">(** ** Rewriting *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk26"><span class="kn">Lemma</span> <span class="nf">insert_cons_eq</span>: <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">k</span> <span class="nv">x</span>,
    a = x -&gt;
    key_insert_atom (a :: k) x = a :: k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">x</span> : atom),
a = x -&gt; key_insert_atom (a :: k) x = a :: k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk27"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">x</span> : atom),
a = x -&gt; key_insert_atom (a :: k) x = a :: k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk28"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_insert_atom (a :: k) x = a :: k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk29"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> x == a <span class="kr">then</span> a :: k <span class="kr">else</span> a :: key_insert_atom k x) =
a :: k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">destruct_eq_args x a.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk2a"><span class="kn">Lemma</span> <span class="nf">insert_cons_neq</span>: <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">k</span> <span class="nv">x</span>,
    a &lt;&gt; x -&gt;
    key_insert_atom (a :: k) x = a :: key_insert_atom k x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">x</span> : atom),
a &lt;&gt; x -&gt;
key_insert_atom (a :: k) x = a :: key_insert_atom k x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk2b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">x</span> : atom),
a &lt;&gt; x -&gt;
key_insert_atom (a :: k) x = a :: key_insert_atom k x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk2c"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_insert_atom (a :: k) x = a :: key_insert_atom k x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk2d"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> x == a <span class="kr">then</span> a :: k <span class="kr">else</span> a :: key_insert_atom k x) =
a :: key_insert_atom k x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">destruct_eq_args x a.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Alternative spec *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk2e"><span class="kn">Lemma</span> <span class="nf">key_lookup_atom_rec_spec</span> (<span class="nv">k</span>: key) (<span class="nv">a</span>: atom) (<span class="nv">n</span>: nat):
  key_lookup_atom_rec k n a = map (<span class="kr">fun</span> <span class="nv">m</span> =&gt; m + n) (key_lookup_atom k a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom_rec k n a =
map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk2f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom_rec k n a =
map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk30"><span class="nb">generalize dependent</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom_rec k n a =
map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk31"><span class="nb">induction</span> k; <span class="nb">intro</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom_rec [] n a =
map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom [] a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk32" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom_rec k n a = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="key-v-chk32"><hr></label><div class="goal-conclusion">key_lookup_atom_rec (a0 :: k) n a =
map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n)
  (key_lookup_atom (a0 :: k) a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk33">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom_rec [] n a =
map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom [] a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk34">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom_rec k n a = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom_rec (a0 :: k) n a =
map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n)
  (key_lookup_atom (a0 :: k) a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk35"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom_rec k n a = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> a == a0
 <span class="kr">then</span> Some n
 <span class="kr">else</span> key_lookup_atom_rec k (S n) a) =
map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n)
  (<span class="kr">if</span> a == a0
   <span class="kr">then</span> Some <span class="mi">0</span>
   <span class="kr">else</span> map S (key_lookup_atom k a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk36"><span class="nb">destruct</span> (a == a0).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom_rec k n a = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>a = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some n = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (Some <span class="mi">0</span>)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk37" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom_rec k n a = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br></div><label class="goal-separator" for="key-v-chk37"><hr></label><div class="goal-conclusion">key_lookup_atom_rec k (S n) a =
map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n)
  (map S (key_lookup_atom k a))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk38">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom_rec k n a = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>a = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some n = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (Some <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk39">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom_rec k n a = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom_rec k (S n) a =
map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n)
  (map S (key_lookup_atom k a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk3a"><span class="nb">rewrite</span> (IHk (S n)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom_rec k n a = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + S n) (key_lookup_atom k a) =
map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n)
  (map S (key_lookup_atom k a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk3b">compose near (key_lookup_atom k a) on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom_rec k n a = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + S n) (key_lookup_atom k a) =
(map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) ‚àò map S)
  (key_lookup_atom k a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk3c"><span class="nb">rewrite</span> (fun_map_map).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom_rec k n a = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + S n) (key_lookup_atom k a) =
map ((<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) ‚àò S) (key_lookup_atom k a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk3d">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom_rec k n a = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + S n) = (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) ‚àò S</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk3e">ext m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom_rec k n a = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m + S n = ((<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) ‚àò S) m</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk3f"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom_rec k n a = map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + n) (key_lookup_atom k a)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m + S n = S (m + n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk40"><span class="kn">Corollary</span> <span class="nf">key_lookup_atom_spec</span> (<span class="nv">k</span>: key) (<span class="nv">a</span>: atom):
  key_lookup_atom_alt k a = key_lookup_atom k a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom_alt k a = key_lookup_atom k a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk41"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom_alt k a = key_lookup_atom k a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk42"><span class="nb">unfold</span> key_lookup_atom_alt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom_rec k <span class="mi">0</span> a = key_lookup_atom k a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk43"><span class="nb">rewrite</span> key_lookup_atom_rec_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + <span class="mi">0</span>) (key_lookup_atom k a) =
key_lookup_atom k a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk44"><span class="nb">replace</span> (<span class="kr">fun</span> <span class="nv">m</span> =&gt; m + <span class="mi">0</span>) <span class="kr">with</span> (@id nat).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map id (key_lookup_atom k a) = key_lookup_atom k a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk45" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><label class="goal-separator" for="key-v-chk45"><hr></label><div class="goal-conclusion">id = (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + <span class="mi">0</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk46"><span class="bp">now</span> <span class="nb">rewrite</span> fun_map_id.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">id = (<span class="kr">fun</span> <span class="nv">m</span> : nat =&gt; m + <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk47">ext m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">id m = m + <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk48"><span class="nb">unfold</span> id.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m = m + <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Insertion and &lt;&lt;unique&gt;&gt; *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk49"><span class="kn">Lemma</span> <span class="nf">key_nin_insert</span>: <span class="kr">forall</span> <span class="nv">k</span> <span class="nv">a</span> <span class="nv">a&#39;</span>,
    a &lt;&gt; a&#39; -&gt;
    ~ a ‚àà k -&gt;
    ~ a ‚àà key_insert_atom k a&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : list atom) (<span class="nv">a</span> <span class="nv">a&#39;</span> : atom),
a &lt;&gt; a&#39; -&gt; ~ a ‚àà k -&gt; ~ a ‚àà key_insert_atom k a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk4a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : list atom) (<span class="nv">a</span> <span class="nv">a&#39;</span> : atom),
a &lt;&gt; a&#39; -&gt; ~ a ‚àà k -&gt; ~ a ‚àà key_insert_atom k a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk4b">introv Hneq Hnin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà key_insert_atom k a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk4c"><span class="nb">induction</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà key_insert_atom [] a&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk4d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k -&gt; ~ a ‚àà key_insert_atom k a&#39;</span></span></span><br></div><label class="goal-separator" for="key-v-chk4d"><hr></label><div class="goal-conclusion">~ a ‚àà key_insert_atom (a0 :: k) a&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk4e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà key_insert_atom [] a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk4f"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (a&#39; = a \/ <span class="kt">False</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk50"><span class="nb">intros</span> [H1|H2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà []</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a&#39; = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk51" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà []</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kt">False</span></span></span></span><br></div><label class="goal-separator" for="key-v-chk51"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk52">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà []</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>a&#39; = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">subst</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk53">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà []</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk54">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k -&gt; ~ a ‚àà key_insert_atom k a&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà key_insert_atom (a0 :: k) a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk55"><span class="nb">rewrite</span> nin_list_cons <span class="kr">in</span> Hnin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0 /\ ~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k -&gt; ~ a ‚àà key_insert_atom k a&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà key_insert_atom (a0 :: k) a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk56"><span class="nb">destruct</span> Hnin <span class="kr">as</span> [? Hnin].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k -&gt; ~ a ‚àà key_insert_atom k a&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà key_insert_atom (a0 :: k) a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk57"><span class="nb">specialize</span> (IHk Hnin).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà key_insert_atom k a&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà key_insert_atom (a0 :: k) a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk58"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà key_insert_atom k a&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~
List.In a
  (<span class="kr">if</span> a&#39; == a0
   <span class="kr">then</span> a0 :: k
   <span class="kr">else</span> a0 :: key_insert_atom k a&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk59"><span class="nb">compare</span> atoms.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq, H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà key_insert_atom k a0</span></span></span><br><span><var>DESTR_EQs</var><span class="hyp-type"><b>: </b><span>a0 = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ List.In a (a0 :: k)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk5a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà key_insert_atom k a&#39;</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a&#39;</span></span></span><br></div><label class="goal-separator" for="key-v-chk5a"><hr></label><div class="goal-conclusion">~ List.In a (a0 :: key_insert_atom k a&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk5b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq, H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà key_insert_atom k a0</span></span></span><br><span><var>DESTR_EQs</var><span class="hyp-type"><b>: </b><span>a0 = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ List.In a (a0 :: k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk5c"><span class="nb">intros</span> [contra|contra].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq, H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà key_insert_atom k a0</span></span></span><br><span><var>DESTR_EQs</var><span class="hyp-type"><b>: </b><span>a0 = a0</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>a0 = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk5d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq, H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà key_insert_atom k a0</span></span></span><br><span><var>DESTR_EQs</var><span class="hyp-type"><b>: </b><span>a0 = a0</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>List.In a k</span></span></span><br></div><label class="goal-separator" for="key-v-chk5d"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk5e"><span class="bp">now</span> <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq, H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà key_insert_atom k a0</span></span></span><br><span><var>DESTR_EQs</var><span class="hyp-type"><b>: </b><span>a0 = a0</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>List.In a k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk5f">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà key_insert_atom k a&#39;</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ List.In a (a0 :: key_insert_atom k a&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk60"><span class="nb">intros</span> [contra|contra].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà key_insert_atom k a&#39;</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a&#39;</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>a0 = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk61" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà key_insert_atom k a&#39;</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a&#39;</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>List.In a (key_insert_atom k a&#39;)</span></span></span><br></div><label class="goal-separator" for="key-v-chk61"><hr></label><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk62"><span class="bp">now</span> <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà key_insert_atom k a&#39;</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a&#39;</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>List.In a (key_insert_atom k a&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk63"><span class="kn">Theorem</span> <span class="nf">key_insert_unique</span> (<span class="nv">k</span>: key) (<span class="nv">a</span>: atom):
  unique k -&gt;
  unique (key_insert_atom k a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">unique k -&gt; unique (key_insert_atom k a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk64"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">unique k -&gt; unique (key_insert_atom k a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk65"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">unique (key_insert_atom k a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk66"><span class="nb">induction</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>unique []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">unique (key_insert_atom [] a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk67" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>unique (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique k -&gt; unique (key_insert_atom k a)</span></span></span><br></div><label class="goal-separator" for="key-v-chk67"><hr></label><div class="goal-conclusion">unique (key_insert_atom (a0 :: k) a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk68">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>unique []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">unique (key_insert_atom [] a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk69"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>unique []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ <span class="kt">False</span> /\ <span class="kt">True</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk6a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>unique (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique k -&gt; unique (key_insert_atom k a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">unique (key_insert_atom (a0 :: k) a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk6b"><span class="nb">destruct</span> H <span class="kr">as</span> [H1 H2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique k -&gt; unique (key_insert_atom k a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">unique (key_insert_atom (a0 :: k) a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk6c"><span class="nb">specialize</span> (IHk H2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique (key_insert_atom k a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">unique (key_insert_atom (a0 :: k) a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk6d"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique (key_insert_atom k a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">unique
  (<span class="kr">if</span> a == a0
   <span class="kr">then</span> a0 :: k
   <span class="kr">else</span> a0 :: key_insert_atom k a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk6e"><span class="nb">compare</span> atoms.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique (key_insert_atom k a)</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">unique (a0 :: key_insert_atom k a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk6f"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique (key_insert_atom k a)</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a0 ‚àà key_insert_atom k a /\
unique (key_insert_atom k a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk70"><span class="nb">split</span>; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique (key_insert_atom k a)</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a0 ‚àà key_insert_atom k a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> key_nin_insert; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Insertion and &lt;&lt;key_lookup_atom&gt;&gt; *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk71"><span class="kn">Lemma</span> <span class="nf">key_lookup_atom_not_in1</span>:
  <span class="kr">forall</span> (<span class="nv">k</span>:  key) (<span class="nv">a</span>: atom),
    ~ a ‚àà k -&gt; key_lookup_atom k a = None.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom),
~ a ‚àà k -&gt; key_lookup_atom k a = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk72"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom),
~ a ‚àà k -&gt; key_lookup_atom k a = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk73"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom k a = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk74"><span class="nb">induction</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>~ a ‚àà []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom [] a = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk75" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>~ a ‚àà (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k -&gt; key_lookup_atom k a = None</span></span></span><br></div><label class="goal-separator" for="key-v-chk75"><hr></label><div class="goal-conclusion">key_lookup_atom (a0 :: k) a = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk76">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>~ a ‚àà []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom [] a = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk77">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>~ a ‚àà (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k -&gt; key_lookup_atom k a = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom (a0 :: k) a = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk78"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>~ a ‚àà (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k -&gt; key_lookup_atom k a = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> a == a0
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> map S (key_lookup_atom k a)) = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk79"><span class="nb">rewrite</span> nin_list_cons <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0 /\ ~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k -&gt; key_lookup_atom k a = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> a == a0
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> map S (key_lookup_atom k a)) = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk7a"><span class="nb">compare</span> atoms.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0 /\ ~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k -&gt; key_lookup_atom k a = None</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map S (key_lookup_atom k a) = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk7b"><span class="nb">rewrite</span> IHk.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0 /\ ~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k -&gt; key_lookup_atom k a = None</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map S None = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk7c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0 /\ ~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k -&gt; key_lookup_atom k a = None</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><label class="goal-separator" for="key-v-chk7c"><hr></label><div class="goal-conclusion">~ a ‚àà k</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk7d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0 /\ ~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k -&gt; key_lookup_atom k a = None</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map S None = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk7e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0 /\ ~ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k -&gt; key_lookup_atom k a = None</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intuition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk7f"><span class="kn">Lemma</span> <span class="nf">key_lookup_atom_not_in2</span>:
  <span class="kr">forall</span> (<span class="nv">k</span>:  key) (<span class="nv">a</span>: atom),
    key_lookup_atom k a = None -&gt; ~ a ‚àà k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom),
key_lookup_atom k a = None -&gt; ~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk80"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom),
key_lookup_atom k a = None -&gt; ~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk81"><span class="nb">intros</span> k a hyp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk82"><span class="nb">induction</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>key_lookup_atom [] a = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk83" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>key_lookup_atom (a0 :: k) a = None</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = None -&gt; ~ a ‚àà k</span></span></span><br></div><label class="goal-separator" for="key-v-chk83"><hr></label><div class="goal-conclusion">~ a ‚àà (a0 :: k)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk84">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>key_lookup_atom [] a = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk85"><span class="nb">cbv</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>key_lookup_atom [] a = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span> -&gt; <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk86">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>key_lookup_atom (a0 :: k) a = None</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = None -&gt; ~ a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà (a0 :: k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk87"><span class="nb">rewrite</span> nin_list_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>key_lookup_atom (a0 :: k) a = None</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = None -&gt; ~ a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt;&gt; a0 /\ ~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk88"><span class="nb">cbn</span> <span class="kr">in</span> hyp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> a == a0 <span class="kr">then</span> Some <span class="mi">0</span> <span class="kr">else</span> map S (key_lookup_atom k a)) = None</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = None -&gt; ~ a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt;&gt; a0 /\ ~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk89"><span class="nb">compare</span> atoms.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>map S (key_lookup_atom k a) = None</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = None -&gt; ~ a ‚àà k</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt;&gt; a0 /\ ~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk8a"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>map S (key_lookup_atom k a) = None</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = None -&gt; ~ a ‚àà k</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt;&gt; a0</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk8b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>map S (key_lookup_atom k a) = None</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = None -&gt; ~ a ‚àà k</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><label class="goal-separator" for="key-v-chk8b"><hr></label><div class="goal-conclusion">~ a ‚àà k</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk8c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>map S (key_lookup_atom k a) = None</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = None -&gt; ~ a ‚àà k</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt;&gt; a0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk8d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>map S (key_lookup_atom k a) = None</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = None -&gt; ~ a ‚àà k</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk8e"><span class="nb">apply</span> IHk.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>map S (key_lookup_atom k a) = None</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = None -&gt; ~ a ‚àà k</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom k a = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk8f"><span class="nb">destruct</span> (key_lookup_atom k a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>map S (Some n) = None</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>Some n = None -&gt; ~ a ‚àà k</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some n = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk90" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>map S None = None</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>None = None -&gt; ~ a ‚àà k</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><label class="goal-separator" for="key-v-chk90"><hr></label><div class="goal-conclusion">None = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk91">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>map S (Some n) = None</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>Some n = None -&gt; ~ a ‚àà k</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some n = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> hyp.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk92">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>hyp</var><span class="hyp-type"><b>: </b><span>map S None = None</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>None = None -&gt; ~ a ‚àà k</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">None = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk93"><span class="kn">Theorem</span> <span class="nf">key_lookup_atom_not_in_iff</span>:
  <span class="kr">forall</span> (<span class="nv">k</span>:  key) (<span class="nv">a</span>: atom),
    ~ a ‚àà k &lt;-&gt; key_lookup_atom k a = None.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom),
~ a ‚àà k &lt;-&gt; key_lookup_atom k a = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk94"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom),
~ a ‚àà k &lt;-&gt; key_lookup_atom k a = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk95"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà k &lt;-&gt; key_lookup_atom k a = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk96"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà k -&gt; key_lookup_atom k a = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk97" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><label class="goal-separator" for="key-v-chk97"><hr></label><div class="goal-conclusion">key_lookup_atom k a = None -&gt; ~ a ‚àà k</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk98">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà k -&gt; key_lookup_atom k a = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> key_lookup_atom_not_in1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk99">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom k a = None -&gt; ~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> key_lookup_atom_not_in2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk9a"><span class="kn">Lemma</span> <span class="nf">key_lookup_atom_in1</span>:
  <span class="kr">forall</span> (<span class="nv">k</span>:  key) (<span class="nv">a</span>: atom),
    a ‚àà k -&gt; {n: nat | key_lookup_atom k a = Some n}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom),
a ‚àà k -&gt; {n : nat | key_lookup_atom k a = Some n}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk9b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom),
a ‚àà k -&gt; {n : nat | key_lookup_atom k a = Some n}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk9c">introv Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{n : nat | key_lookup_atom k a = Some n}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk9d"><span class="nb">induction</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ‚àà []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{n : nat | key_lookup_atom [] a = Some n}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk9e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ‚àà (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>a ‚àà k -&gt; {n : nat | key_lookup_atom k a = Some n}</span></span></span><br></div><label class="goal-separator" for="key-v-chk9e"><hr></label><div class="goal-conclusion">{n : nat | key_lookup_atom (a0 :: k) a = Some n}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk9f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ‚àà []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{n : nat | key_lookup_atom [] a = Some n}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Hin.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chka0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ‚àà (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>a ‚àà k -&gt; {n : nat | key_lookup_atom k a = Some n}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{n : nat | key_lookup_atom (a0 :: k) a = Some n}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chka1"><span class="nb">rewrite</span> element_of_list_cons <span class="kr">in</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a = a0 \/ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>a ‚àà k -&gt; {n : nat | key_lookup_atom k a = Some n}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{n : nat | key_lookup_atom (a0 :: k) a = Some n}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chka2"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a = a0 \/ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>a ‚àà k -&gt; {n : nat | key_lookup_atom k a = Some n}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{n : nat
| (<span class="kr">if</span> a == a0
   <span class="kr">then</span> Some <span class="mi">0</span>
   <span class="kr">else</span> map S (key_lookup_atom k a)) = Some n}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chka3"><span class="nb">compare</span> atoms.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>a0 ‚àà k -&gt; {n : nat | key_lookup_atom k a0 = Some n}</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a0 = a0 \/ a0 ‚àà k</span></span></span><br><span><var>DESTR_EQs</var><span class="hyp-type"><b>: </b><span>a0 = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{n : nat | Some <span class="mi">0</span> = Some n}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chka4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a = a0 \/ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>a ‚àà k -&gt;
{n : nat | key_lookup_atom k a = Some n}</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><label class="goal-separator" for="key-v-chka4"><hr></label><div class="goal-conclusion">{n : nat | map S (key_lookup_atom k a) = Some n}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chka5">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>a0 ‚àà k -&gt; {n : nat | key_lookup_atom k a0 = Some n}</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a0 = a0 \/ a0 ‚àà k</span></span></span><br><span><var>DESTR_EQs</var><span class="hyp-type"><b>: </b><span>a0 = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{n : nat | Some <span class="mi">0</span> = Some n}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> (<span class="kr">exists</span> <span class="mi">0</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chka6">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a = a0 \/ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>a ‚àà k -&gt; {n : nat | key_lookup_atom k a = Some n}</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{n : nat | map S (key_lookup_atom k a) = Some n}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chka7"><span class="nb">assert</span> (Hink: a ‚àà k) <span class="bp">by</span> <span class="bp">now</span> <span class="nb">inversion</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a = a0 \/ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>a ‚àà k -&gt; {n : nat | key_lookup_atom k a = Some n}</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br><span><var>Hink</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{n : nat | map S (key_lookup_atom k a) = Some n}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chka8"><span class="nb">destruct</span> (IHk Hink) <span class="kr">as</span> [m Hm].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a = a0 \/ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>a ‚àà k -&gt; {n : nat | key_lookup_atom k a = Some n}</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br><span><var>Hink</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = Some m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{n : nat | map S (key_lookup_atom k a) = Some n}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chka9"><span class="nb">rewrite</span> Hm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a = a0 \/ a ‚àà k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>a ‚àà k -&gt; {n : nat | key_lookup_atom k a = Some n}</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br><span><var>Hink</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hm</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = Some m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{n : nat | map S (Some m) = Some n}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> (<span class="kr">exists</span> (<span class="nv">S</span> <span class="nv">m</span>)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkaa"><span class="kn">Lemma</span> <span class="nf">key_lookup_atom_in2</span>:
  <span class="kr">forall</span> (<span class="nv">k</span>:  key) (<span class="nv">a</span>: atom) (<span class="nv">n</span>: nat),
    key_lookup_atom k a = Some n -&gt; a ‚àà k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom) (<span class="nv">n</span> : nat),
key_lookup_atom k a = Some n -&gt; a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkab"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom) (<span class="nv">n</span> : nat),
key_lookup_atom k a = Some n -&gt; a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkac"><span class="nb">intros</span> k a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n -&gt; a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkad"><span class="nb">induction</span> k; <span class="nb">intros</span> n Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>key_lookup_atom [] a = Some n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chkae" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n -&gt; a ‚àà k</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>key_lookup_atom (a0 :: k) a = Some n</span></span></span><br></div><label class="goal-separator" for="key-v-chkae"><hr></label><div class="goal-conclusion">a ‚àà (a0 :: k)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkaf">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>key_lookup_atom [] a = Some n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Heq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkb0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n -&gt; a ‚àà k</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>key_lookup_atom (a0 :: k) a = Some n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà (a0 :: k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkb1"><span class="nb">rewrite</span> element_of_list_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n -&gt; a ‚àà k</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>key_lookup_atom (a0 :: k) a = Some n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = a0 \/ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkb2"><span class="nb">cbn</span> <span class="kr">in</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n -&gt; a ‚àà k</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> a == a0 <span class="kr">then</span> Some <span class="mi">0</span> <span class="kr">else</span> map S (key_lookup_atom k a)) = Some n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = a0 \/ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkb3"><span class="nb">compare</span> atoms.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, key_lookup_atom k a0 = Some n -&gt; a0 ‚àà k</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>Some <span class="mi">0</span> = Some n</span></span></span><br><span><var>DESTR_EQs</var><span class="hyp-type"><b>: </b><span>a0 = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 = a0 \/ a0 ‚àà k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chkb4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
key_lookup_atom k a = Some n -&gt; a ‚àà k</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>map S (key_lookup_atom k a) = Some n</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><label class="goal-separator" for="key-v-chkb4"><hr></label><div class="goal-conclusion">a = a0 \/ a ‚àà k</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkb5">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, key_lookup_atom k a0 = Some n -&gt; a0 ‚àà k</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>Some <span class="mi">0</span> = Some n</span></span></span><br><span><var>DESTR_EQs</var><span class="hyp-type"><b>: </b><span>a0 = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 = a0 \/ a0 ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkb6">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n -&gt; a ‚àà k</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>map S (key_lookup_atom k a) = Some n</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = a0 \/ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkb7"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n -&gt; a ‚àà k</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>map S (key_lookup_atom k a) = Some n</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkb8"><span class="nb">destruct</span> (key_lookup_atom k a);
        <span class="nb">inversion</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat, Some n0 = Some n -&gt; a ‚àà k</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>map S (Some n0) = Some n</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>S n0 = n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">eapply</span> IHk.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkb9"><span class="kn">Theorem</span> <span class="nf">key_lookup_in_atom_iff</span>: <span class="kr">forall</span> <span class="nv">k</span> <span class="nv">a</span>,
    (<span class="kr">exists</span> <span class="nv">n</span>, key_lookup_atom k a = Some n) &lt;-&gt; a ‚àà k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom),
(<span class="kr">exists</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n) &lt;-&gt;
a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkba"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom),
(<span class="kr">exists</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n) &lt;-&gt;
a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkbb"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n) &lt;-&gt;
a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkbc"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n) -&gt;
a ‚àà k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chkbd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><label class="goal-separator" for="key-v-chkbd"><hr></label><div class="goal-conclusion">a ‚àà k -&gt; <span class="kr">exists</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkbe">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n) -&gt;
a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkbf"><span class="nb">intros</span> [n H].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = Some n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eauto using</span> key_lookup_atom_in2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkc0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà k -&gt; <span class="kr">exists</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkc1"><span class="nb">intro</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkc2"><span class="nb">apply</span> key_lookup_atom_in1 <span class="kr">in</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>{n : nat | key_lookup_atom k a = Some n}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">n</span> : nat, key_lookup_atom k a = Some n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">firstorder</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkc3"><span class="kn">Theorem</span> <span class="nf">key_lookup_atom_decide</span>:
  <span class="kr">forall</span> (<span class="nv">k</span>: key) (<span class="nv">a</span>: atom),
    ((a ‚àà k) * {n: nat | key_lookup_atom k a = Some n}) +
      {~ a ‚àà k /\ key_lookup_atom k a = None}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom),
(a ‚àà k) * {n : nat | key_lookup_atom k a = Some n} +
{~ a ‚àà k /\ key_lookup_atom k a = None}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkc4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom),
(a ‚àà k) * {n : nat | key_lookup_atom k a = Some n} +
{~ a ‚àà k /\ key_lookup_atom k a = None}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkc5"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a ‚àà k) * {n : nat | key_lookup_atom k a = Some n} +
{~ a ‚àà k /\ key_lookup_atom k a = None}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkc6"><span class="nb">destruct</span> (key_is_atom_in k a); [<span class="nb">left</span>|<span class="nb">right</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((a ‚àà k) * {n : nat | key_lookup_atom k a = Some n})%type</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chkc7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br></div><label class="goal-separator" for="key-v-chkc7"><hr></label><div class="goal-conclusion">~ a ‚àà k /\ key_lookup_atom k a = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkc8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((a ‚àà k) * {n : nat | key_lookup_atom k a = Some n})%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkc9"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chkca" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br></div><label class="goal-separator" for="key-v-chkca"><hr></label><div class="goal-conclusion">{n : nat | key_lookup_atom k a = Some n}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkcb">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkcc">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{n : nat | key_lookup_atom k a = Some n}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto using</span> key_lookup_atom_in1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkcd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà k /\ key_lookup_atom k a = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkce"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chkcf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br></div><label class="goal-separator" for="key-v-chkcf"><hr></label><div class="goal-conclusion">key_lookup_atom k a = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkd0">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkd1">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom k a = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto using</span> key_lookup_atom_not_in1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">lookup_atom_in_key</span> k a :=
  <span class="kr">let</span> <span class="nv">n</span> := <span class="kp">fresh</span> <span class="s2">&quot;n&quot;</span> <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">Hin</span> := <span class="kp">fresh</span> <span class="s2">&quot;H_in&quot;</span> <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">Hnin</span> := <span class="kp">fresh</span> <span class="s2">&quot;H_not_in&quot;</span> <span class="kr">in</span>
  <span class="nb">destruct</span> (key_lookup_atom_decide k a) <span class="kr">as</span>
    [[Hin [n H_key_lookup]] | [Hnin H_key_lookup]];
  <span class="kp">try</span> <span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Tactic Notation</span> <span class="s2">&quot;lookup&quot;</span> <span class="s2">&quot;atom&quot;</span> <span class="kp">constr</span>(a) <span class="s2">&quot;in&quot;</span> <span class="s2">&quot;key&quot;</span> <span class="kp">constr</span>(k) :=
  lookup_atom_in_key k a.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkd2"><span class="kn">Goal</span> <span class="kr">forall</span> (<span class="nv">k</span>: key) (<span class="nv">a</span>: atom), a ‚àà k \/ ~ a ‚àà k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom), a ‚àà k \/ ~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkd3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">a</span> : atom), a ‚àà k \/ ~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkd4"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà k \/ ~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkd5">lookup atom a <span class="kr">in</span> key k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_key_lookup</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = Some n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà k \/ ~ a ‚àà k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chkd6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H_not_in</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>H_key_lookup</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = None</span></span></span><br></div><label class="goal-separator" for="key-v-chkd6"><hr></label><div class="goal-conclusion">a ‚àà k \/ ~ a ‚àà k</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkd7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_key_lookup</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = Some n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà k \/ ~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkd8"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H_in</var><span class="hyp-type"><b>: </b><span>a ‚àà k</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H_key_lookup</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = Some n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intuition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkd9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H_not_in</var><span class="hyp-type"><b>: </b><span>~ a ‚àà k</span></span></span><br><span><var>H_key_lookup</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà k \/ ~ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">right</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkda"><span class="kn">Lemma</span> <span class="nf">key_lookup_atom_cons_0</span>: <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">a&#39;</span> <span class="nv">k</span>,
    key_lookup_atom (a :: k) a&#39; = Some <span class="mi">0</span> -&gt;
    a = a&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">a&#39;</span> : atom) (<span class="nv">k</span> : list atom),
key_lookup_atom (a :: k) a&#39; = Some <span class="mi">0</span> -&gt; a = a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkdb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">a&#39;</span> : atom) (<span class="nv">k</span> : list atom),
key_lookup_atom (a :: k) a&#39; = Some <span class="mi">0</span> -&gt; a = a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkdc">introv Hlookup; <span class="nb">cbn</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hlookup</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> a&#39; == a
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> map S (key_lookup_atom k a&#39;)) = 
Some <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkdd"><span class="nb">compare</span> atoms.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; a</span></span></span><br><span><var>Hlookup</var><span class="hyp-type"><b>: </b><span>map S (key_lookup_atom k a&#39;) = Some <span class="mi">0</span></span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = a&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">lookup atom a&#39; <span class="kr">in</span> key k;
    <span class="nb">rewrite</span> H_key_lookup <span class="kr">in</span> Hlookup;
    <span class="bp">now</span> <span class="nb">inversion</span> Hlookup.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkde"><span class="kn">Lemma</span> <span class="nf">key_lookup_atom_cons_S</span>: <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">x</span> <span class="nv">k</span> <span class="nv">ix</span>,
    key_lookup_atom (x :: k) a = Some (S ix) -&gt;
    a &lt;&gt; x /\ key_lookup_atom k a = Some ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">x</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">ix</span> : nat),
key_lookup_atom (x :: k) a = Some (S ix) -&gt;
a &lt;&gt; x /\ key_lookup_atom k a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkdf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">x</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">ix</span> : nat),
key_lookup_atom (x :: k) a = Some (S ix) -&gt;
a &lt;&gt; x /\ key_lookup_atom k a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chke0">introv HH.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, x</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>HH</var><span class="hyp-type"><b>: </b><span>key_lookup_atom (x :: k) a = Some (S ix)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt;&gt; x /\ key_lookup_atom k a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chke1"><span class="nb">cbn</span> <span class="kr">in</span> HH.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, x</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>HH</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> a == x
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> map S (key_lookup_atom k a)) = Some (S ix)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt;&gt; x /\ key_lookup_atom k a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chke2">destruct_eq_args a x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, x</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; x</span></span></span><br><span><var>HH</var><span class="hyp-type"><b>: </b><span>map S (key_lookup_atom k a) = Some (S ix)</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>x &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt;&gt; x /\ key_lookup_atom k a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chke3"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, x</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; x</span></span></span><br><span><var>HH</var><span class="hyp-type"><b>: </b><span>map S (key_lookup_atom k a) = Some (S ix)</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>x &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a &lt;&gt; x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chke4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, x</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; x</span></span></span><br><span><var>HH</var><span class="hyp-type"><b>: </b><span>map S (key_lookup_atom k a) = Some (S ix)</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>x &lt;&gt; a</span></span></span><br></div><label class="goal-separator" for="key-v-chke4"><hr></label><div class="goal-conclusion">key_lookup_atom k a = Some ix</div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chke5"><span class="bp">assumption</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, x</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; x</span></span></span><br><span><var>HH</var><span class="hyp-type"><b>: </b><span>map S (key_lookup_atom k a) = Some (S ix)</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>x &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom k a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eauto using</span> (map_Some_inv S).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chke6"><span class="kn">Theorem</span> <span class="nf">key_lookup_atom_cons</span>: <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">k</span> <span class="nv">a&#39;</span> <span class="nv">ix</span>,
    key_lookup_atom (a :: k) a&#39; = Some ix -&gt;
    (a&#39; = a /\ ix = <span class="mi">0</span>) \/
      (a&#39; &lt;&gt; a /\ <span class="kr">exists</span> <span class="nv">ix&#39;</span>, ix = S ix&#39; /\ key_lookup_atom k a&#39; = Some ix&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">a&#39;</span> : atom)
  (<span class="nv">ix</span> : nat),
key_lookup_atom (a :: k) a&#39; = Some ix -&gt;
a&#39; = a /\ ix = <span class="mi">0</span> \/
a&#39; &lt;&gt; a /\
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   ix = S ix&#39; /\ key_lookup_atom k a&#39; = Some ix&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chke7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">a&#39;</span> : atom)
  (<span class="nv">ix</span> : nat),
key_lookup_atom (a :: k) a&#39; = Some ix -&gt;
a&#39; = a /\ ix = <span class="mi">0</span> \/
a&#39; &lt;&gt; a /\
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   ix = S ix&#39; /\ key_lookup_atom k a&#39; = Some ix&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chke8">introv Hyp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hyp</var><span class="hyp-type"><b>: </b><span>key_lookup_atom (a :: k) a&#39; = Some ix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a&#39; = a /\ ix = <span class="mi">0</span> \/
a&#39; &lt;&gt; a /\
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   ix = S ix&#39; /\ key_lookup_atom k a&#39; = Some ix&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chke9"><span class="nb">destruct</span> ix; [<span class="nb">left</span>|<span class="nb">right</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hyp</var><span class="hyp-type"><b>: </b><span>key_lookup_atom (a :: k) a&#39; = Some <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a&#39; = a /\ <span class="mi">0</span> = <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chkea" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hyp</var><span class="hyp-type"><b>: </b><span>key_lookup_atom (a :: k) a&#39; = Some (S ix)</span></span></span><br></div><label class="goal-separator" for="key-v-chkea"><hr></label><div class="goal-conclusion">a&#39; &lt;&gt; a /\
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   S ix = S ix&#39; /\ key_lookup_atom k a&#39; = Some ix&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkeb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hyp</var><span class="hyp-type"><b>: </b><span>key_lookup_atom (a :: k) a&#39; = Some <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a&#39; = a /\ <span class="mi">0</span> = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkec"><span class="nb">apply</span> key_lookup_atom_cons_0 <span class="kr">in</span> Hyp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hyp</var><span class="hyp-type"><b>: </b><span>a = a&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a&#39; = a /\ <span class="mi">0</span> = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intuition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chked">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hyp</var><span class="hyp-type"><b>: </b><span>key_lookup_atom (a :: k) a&#39; = Some (S ix)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a&#39; &lt;&gt; a /\
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   S ix = S ix&#39; /\ key_lookup_atom k a&#39; = Some ix&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkee"><span class="nb">apply</span> key_lookup_atom_cons_S <span class="kr">in</span> Hyp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hyp</var><span class="hyp-type"><b>: </b><span>a&#39; &lt;&gt; a /\ key_lookup_atom k a&#39; = Some ix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a&#39; &lt;&gt; a /\
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   S ix = S ix&#39; /\ key_lookup_atom k a&#39; = Some ix&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intuition</span> <span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Insertion and &lt;&lt;key_lookup_ix&gt;&gt; *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkef"><span class="kn">Lemma</span> <span class="nf">key_lookup_ix_in</span>:
  <span class="kr">forall</span> (<span class="nv">k</span>:  key) (<span class="nv">ix</span>: nat) (<span class="nv">a</span>: atom),
    key_lookup_index k ix = Some a -&gt; a ‚àà k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat) (<span class="nv">a</span> : atom),
key_lookup_index k ix = Some a -&gt; a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkf0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat) (<span class="nv">a</span> : atom),
key_lookup_index k ix = Some a -&gt; a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkf1">introv Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkf2"><span class="nb">generalize dependent</span> ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt; a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkf3"><span class="nb">induction</span> k; <span class="nb">intros</span> ix Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index [] ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chkf4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; a ‚àà k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) ix = Some a</span></span></span><br></div><label class="goal-separator" for="key-v-chkf4"><hr></label><div class="goal-conclusion">a ‚àà (a0 :: k)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkf5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index [] ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Hin.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkf6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; a ‚àà k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà (a0 :: k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkf7"><span class="nb">destruct</span> ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; a ‚àà k</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) <span class="mi">0</span> = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà (a0 :: k)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chkf8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; a ‚àà k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) (S ix) = Some a</span></span></span><br></div><label class="goal-separator" for="key-v-chkf8"><hr></label><div class="goal-conclusion">a ‚àà (a0 :: k)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkf9">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; a ‚àà k</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) <span class="mi">0</span> = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà (a0 :: k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkfa"><span class="nb">cbn</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; a ‚àà k</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>Some a0 = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a0 = a \/ List.In a k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkfb"><span class="nb">inversion</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; a ‚àà k</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>Some a0 = Some a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>a0 = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = a \/ List.In a k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">left</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkfc">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; a ‚àà k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) (S ix) = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà (a0 :: k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkfd"><span class="nb">cbn</span> <span class="kr">in</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; a ‚àà k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà (a0 :: k)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkfe"><span class="nb">rewrite</span> element_of_list_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; a ‚àà k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = a0 \/ a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chkff"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; a ‚àà k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a ‚àà k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk100"><span class="kn">Lemma</span> <span class="nf">key_lookup_ix_Some1</span>:
  <span class="kr">forall</span> (<span class="nv">k</span>:  key) (<span class="nv">ix</span>: nat) (<span class="nv">a</span>: atom),
    key_lookup_index k ix = Some a -&gt; contains_ix_upto ix k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat) (<span class="nv">a</span> : atom),
key_lookup_index k ix = Some a -&gt;
contains_ix_upto ix k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk101"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat) (<span class="nv">a</span> : atom),
key_lookup_index k ix = Some a -&gt;
contains_ix_upto ix k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk102">introv Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains_ix_upto ix k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk103"><span class="nb">unfold</span> contains_ix_upto.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ix &lt; length k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk104"><span class="nb">generalize dependent</span> ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt; ix &lt; length k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk105"><span class="nb">induction</span> k; <span class="nb">intros</span> ix Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index [] ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ix &lt; length []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk106" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; ix &lt; length k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) ix = Some a</span></span></span><br></div><label class="goal-separator" for="key-v-chk106"><hr></label><div class="goal-conclusion">ix &lt; length (a0 :: k)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk107">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index [] ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ix &lt; length []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">false.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk108">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; ix &lt; length k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ix &lt; length (a0 :: k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk109"><span class="nb">destruct</span> ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; ix &lt; length k</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) <span class="mi">0</span> = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; length (a0 :: k)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk10a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; ix &lt; length k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) (S ix) = Some a</span></span></span><br></div><label class="goal-separator" for="key-v-chk10a"><hr></label><div class="goal-conclusion">S ix &lt; length (a0 :: k)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk10b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; ix &lt; length k</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) <span class="mi">0</span> = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; length (a0 :: k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk10c"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; ix &lt; length k</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) <span class="mi">0</span> = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; S (length k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk10d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; ix &lt; length k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) (S ix) = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S ix &lt; length (a0 :: k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk10e"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; ix &lt; length k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) (S ix) = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S ix &lt; S (length k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk10f"><span class="nb">cbn</span> <span class="kr">in</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = Some a -&gt; ix &lt; length k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S ix &lt; S (length k)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk110"><span class="nb">specialize</span> (IHk ix Hin).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>ix &lt; length k</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S ix &lt; S (length k)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk111"><span class="kn">Lemma</span> <span class="nf">key_lookup_ix_Some2</span>:
  <span class="kr">forall</span> (<span class="nv">k</span>:  key) (<span class="nv">ix</span>: nat),
    contains_ix_upto ix k -&gt;
    {a:atom | key_lookup_index k ix = Some a}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat),
contains_ix_upto ix k -&gt;
{a : atom | key_lookup_index k ix = Some a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk112"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat),
contains_ix_upto ix k -&gt;
{a : atom | key_lookup_index k ix = Some a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk113"><span class="nb">unfold</span> contains_ix_upto.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat),
ix &lt; length k -&gt;
{a : atom | key_lookup_index k ix = Some a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk114"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ix &lt; length k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : atom | key_lookup_index k ix = Some a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk115"><span class="nb">generalize dependent</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">k</span> : key,
ix &lt; length k -&gt;
{a : atom | key_lookup_index k ix = Some a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk116"><span class="nb">induction</span> ix; <span class="nb">intros</span> k Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; length k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : atom | key_lookup_index k <span class="mi">0</span> = Some a}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk117" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHix</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : key,
ix &lt; length k -&gt;
{a : atom | key_lookup_index k ix = Some a}</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S ix &lt; length k</span></span></span><br></div><label class="goal-separator" for="key-v-chk117"><hr></label><div class="goal-conclusion">{a : atom | key_lookup_index k (S ix) = Some a}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk118">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; length k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : atom | key_lookup_index k <span class="mi">0</span> = Some a}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk119"><span class="nb">destruct</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Hlt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; length []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : atom | key_lookup_index [] <span class="mi">0</span> = Some a}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk11a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; length (a :: k)</span></span></span><br></div><label class="goal-separator" for="key-v-chk11a"><hr></label><div class="goal-conclusion">{a0 : atom | key_lookup_index (a :: k) <span class="mi">0</span> = Some a0}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk11b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Hlt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; length []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : atom | key_lookup_index [] <span class="mi">0</span> = Some a}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk11c"><span class="nb">cbn</span> <span class="kr">in</span> Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Hlt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : atom | key_lookup_index [] <span class="mi">0</span> = Some a}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk11d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; length (a :: k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a0 : atom | key_lookup_index (a :: k) <span class="mi">0</span> = Some a0}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk11e"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span><span class="mi">0</span> &lt; length (a :: k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a0 : atom | Some a = Some a0}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk11f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHix</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : key,
ix &lt; length k -&gt;
{a : atom | key_lookup_index k ix = Some a}</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S ix &lt; length k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : atom | key_lookup_index k (S ix) = Some a}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk120"><span class="nb">destruct</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHix</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : key,
ix &lt; length k -&gt;
{a : atom | key_lookup_index k ix = Some a}</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S ix &lt; length []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : atom | key_lookup_index [] (S ix) = Some a}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk121" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHix</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : key,
ix &lt; length k -&gt;
{a : atom | key_lookup_index k ix = Some a}</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S ix &lt; length (a :: k)</span></span></span><br></div><label class="goal-separator" for="key-v-chk121"><hr></label><div class="goal-conclusion">{a0 : atom
| key_lookup_index (a :: k) (S ix) = Some a0}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk122">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHix</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : key,
ix &lt; length k -&gt;
{a : atom | key_lookup_index k ix = Some a}</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S ix &lt; length []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : atom | key_lookup_index [] (S ix) = Some a}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk123">false.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHix</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : key,
ix &lt; length k -&gt;
{a : atom | key_lookup_index k ix = Some a}</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S ix &lt; length []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk124"><span class="nb">cbn</span> <span class="kr">in</span> Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHix</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : key,
ix &lt; length k -&gt;
{a : atom | key_lookup_index k ix = Some a}</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S ix &lt; <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk125">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHix</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : key,
ix &lt; length k -&gt;
{a : atom | key_lookup_index k ix = Some a}</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S ix &lt; length (a :: k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a0 : atom
| key_lookup_index (a :: k) (S ix) = Some a0}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk126"><span class="nb">cbn</span> <span class="kr">in</span> Hlt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHix</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : key,
ix &lt; length k -&gt;
{a : atom | key_lookup_index k ix = Some a}</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S ix &lt; S (length k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a0 : atom
| key_lookup_index (a :: k) (S ix) = Some a0}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk127"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHix</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : key,
ix &lt; length k -&gt;
{a : atom | key_lookup_index k ix = Some a}</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S ix &lt; S (length k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : atom | key_lookup_index k ix = Some a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk128"><span class="nb">specialize</span> (IHix k <span class="kp">ltac</span>:(<span class="bp">lia</span>)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHix</var><span class="hyp-type"><b>: </b><span>{a : atom | key_lookup_index k ix = Some a}</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Hlt</var><span class="hyp-type"><b>: </b><span>S ix &lt; S (length k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : atom | key_lookup_index k ix = Some a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk129"><span class="kn">Lemma</span> <span class="nf">key_lookup_ix_Some_iff</span>:
  <span class="kr">forall</span> (<span class="nv">k</span>:  key) (<span class="nv">ix</span>: nat),
    contains_ix_upto ix k &lt;-&gt;
      <span class="kr">exists</span> <span class="nv">a</span>, key_lookup_index k ix = Some a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat),
contains_ix_upto ix k &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">a</span> : atom, key_lookup_index k ix = Some a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk12a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat),
contains_ix_upto ix k &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">a</span> : atom, key_lookup_index k ix = Some a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk12b"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains_ix_upto ix k &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">a</span> : atom, key_lookup_index k ix = Some a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk12c"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains_ix_upto ix k -&gt;
<span class="kr">exists</span> <span class="nv">a</span> : atom, key_lookup_index k ix = Some a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk12d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="key-v-chk12d"><hr></label><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a</span> : atom, key_lookup_index k ix = Some a) -&gt;
contains_ix_upto ix k</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk12e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains_ix_upto ix k -&gt;
<span class="kr">exists</span> <span class="nv">a</span> : atom, key_lookup_index k ix = Some a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk12f"><span class="nb">intro</span> H; <span class="nb">apply</span> key_lookup_ix_Some2 <span class="kr">in</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>{a : atom | key_lookup_index k ix = Some a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">a</span> : atom, key_lookup_index k ix = Some a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">firstorder</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk130">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a</span> : atom, key_lookup_index k ix = Some a) -&gt;
contains_ix_upto ix k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk131"><span class="nb">intros</span> [a H].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains_ix_upto ix k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk132"><span class="nb">eapply</span> key_lookup_ix_Some1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index k ix = Some <span class="nl">?a</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk133"><span class="kn">Lemma</span> <span class="nf">key_lookup_ix_None1</span>:
  <span class="kr">forall</span> (<span class="nv">k</span>:  key) (<span class="nv">ix</span>: nat),
    key_lookup_index k ix = None -&gt; ~ (contains_ix_upto ix k).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat),
key_lookup_index k ix = None -&gt;
~ contains_ix_upto ix k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk134"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat),
key_lookup_index k ix = None -&gt;
~ contains_ix_upto ix k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk135">introv Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ contains_ix_upto ix k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk136" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk136"><span class="nb">unfold</span> contains_ix_upto.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ ix &lt; length k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk137"><span class="nb">generalize dependent</span> ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = None -&gt; ~ ix &lt; length k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk138"><span class="nb">induction</span> k; <span class="nb">intros</span> ix Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index [] ix = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ ix &lt; length []</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk139" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = None -&gt; ~ ix &lt; length k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a :: k) ix = None</span></span></span><br></div><label class="goal-separator" for="key-v-chk139"><hr></label><div class="goal-conclusion">~ ix &lt; length (a :: k)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk13a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index [] ix = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ ix &lt; length []</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk13b"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index [] ix = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ ix &lt; <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk13c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = None -&gt; ~ ix &lt; length k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a :: k) ix = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ ix &lt; length (a :: k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk13d"><span class="nb">destruct</span> ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = None -&gt; ~ ix &lt; length k</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a :: k) <span class="mi">0</span> = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ <span class="mi">0</span> &lt; length (a :: k)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk13e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = None -&gt; ~ ix &lt; length k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a :: k) (S ix) = None</span></span></span><br></div><label class="goal-separator" for="key-v-chk13e"><hr></label><div class="goal-conclusion">~ S ix &lt; length (a :: k)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk13f">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = None -&gt; ~ ix &lt; length k</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a :: k) <span class="mi">0</span> = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ <span class="mi">0</span> &lt; length (a :: k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">false.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk140">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = None -&gt; ~ ix &lt; length k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a :: k) (S ix) = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ S ix &lt; length (a :: k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk141"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = None -&gt; ~ ix &lt; length k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a :: k) (S ix) = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ S ix &lt; S (length k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk142"><span class="nb">cbn</span> <span class="kr">in</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, key_lookup_index k ix = None -&gt; ~ ix &lt; length k</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ S ix &lt; S (length k)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk143"><span class="nb">specialize</span> (IHk ix Hin).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ ix &lt; length k</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ S ix &lt; S (length k)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk144"><span class="nb">apply</span> PeanoNat.Nat.le_ngt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>~ ix &lt; length k</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S (length k) &lt;= S ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk145"><span class="kn">Lemma</span> <span class="nf">key_lookup_ix_None2</span>:
  <span class="kr">forall</span> (<span class="nv">k</span>:  key) (<span class="nv">ix</span>: nat),
    ~ (contains_ix_upto ix k) -&gt;
    key_lookup_index k ix = None.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat),
~ contains_ix_upto ix k -&gt;
key_lookup_index k ix = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk146" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk146"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat),
~ contains_ix_upto ix k -&gt;
key_lookup_index k ix = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk147">introv Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>~ contains_ix_upto ix k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index k ix = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk148"><span class="nb">unfold</span> contains_ix_upto <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>~ ix &lt; length k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index k ix = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk149"><span class="nb">generalize dependent</span> ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">ix</span> : nat,
~ ix &lt; length k -&gt; key_lookup_index k ix = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk14a"><span class="nb">induction</span> k; <span class="nb">intros</span> ix Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>~ ix &lt; length []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index [] ix = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk14b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, ~ ix &lt; length k -&gt; key_lookup_index k ix = None</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>~ ix &lt; length (a :: k)</span></span></span><br></div><label class="goal-separator" for="key-v-chk14b"><hr></label><div class="goal-conclusion">key_lookup_index (a :: k) ix = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk14c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>~ ix &lt; length []</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index [] ix = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk14d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, ~ ix &lt; length k -&gt; key_lookup_index k ix = None</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>~ ix &lt; length (a :: k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index (a :: k) ix = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk14e"><span class="nb">cbn</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, ~ ix &lt; length k -&gt; key_lookup_index k ix = None</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>~ ix &lt; S (length k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span> ix <span class="kr">with</span>
| <span class="mi">0</span> =&gt; Some a
| S ix =&gt; key_lookup_index k ix
<span class="kr">end</span> = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk14f"><span class="nb">destruct</span> ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, ~ ix &lt; length k -&gt; key_lookup_index k ix = None</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>~ <span class="mi">0</span> &lt; S (length k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some a = None</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk150" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, ~ ix &lt; length k -&gt; key_lookup_index k ix = None</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>~ S ix &lt; S (length k)</span></span></span><br></div><label class="goal-separator" for="key-v-chk150"><hr></label><div class="goal-conclusion">key_lookup_index k ix = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk151">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, ~ ix &lt; length k -&gt; key_lookup_index k ix = None</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>~ <span class="mi">0</span> &lt; S (length k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some a = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk152"><span class="bp">contradict</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, ~ ix &lt; length k -&gt; key_lookup_index k ix = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt; S (length k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">lia</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk153">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat, ~ ix &lt; length k -&gt; key_lookup_index k ix = None</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>~ S ix &lt; S (length k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index k ix = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk154"><span class="nb">specialize</span> (IHk ix <span class="kp">ltac</span>:(<span class="bp">lia</span>)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = None</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>~ S ix &lt; S (length k)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index k ix = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk155"><span class="kn">Theorem</span> <span class="nf">key_lookup_ix_decide</span>:
  <span class="kr">forall</span> (<span class="nv">k</span>: key) (<span class="nv">n</span>: nat),
    ((contains_ix_upto n k) * {a: atom | key_lookup_index k n = Some a}) +
      {~ contains_ix_upto n k /\ key_lookup_index k n = None}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">n</span> : nat),
contains_ix_upto n k *
{a : atom | key_lookup_index k n = Some a} +
{~ contains_ix_upto n k /\ key_lookup_index k n = None}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk156"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">n</span> : nat),
contains_ix_upto n k *
{a : atom | key_lookup_index k n = Some a} +
{~ contains_ix_upto n k /\ key_lookup_index k n = None}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk157"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains_ix_upto n k *
{a : atom | key_lookup_index k n = Some a} +
{~ contains_ix_upto n k /\ key_lookup_index k n = None}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk158"><span class="nb">destruct</span> (key_is_ix_in k n); [<span class="nb">left</span>|<span class="nb">right</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>contains_ix_upto n k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(contains_ix_upto n k *
 {a : atom | key_lookup_index k n = Some a})%type</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk159" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>~ contains_ix_upto n k</span></span></span><br></div><label class="goal-separator" for="key-v-chk159"><hr></label><div class="goal-conclusion">~ contains_ix_upto n k /\ key_lookup_index k n = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk15a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>contains_ix_upto n k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(contains_ix_upto n k *
 {a : atom | key_lookup_index k n = Some a})%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk15b"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>contains_ix_upto n k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains_ix_upto n k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk15c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>contains_ix_upto n k</span></span></span><br></div><label class="goal-separator" for="key-v-chk15c"><hr></label><div class="goal-conclusion">{a : atom | key_lookup_index k n = Some a}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk15d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>contains_ix_upto n k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains_ix_upto n k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk15e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>contains_ix_upto n k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : atom | key_lookup_index k n = Some a}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto using</span> key_lookup_ix_Some2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk15f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>~ contains_ix_upto n k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ contains_ix_upto n k /\ key_lookup_index k n = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk160"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>~ contains_ix_upto n k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ contains_ix_upto n k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk161" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>~ contains_ix_upto n k</span></span></span><br></div><label class="goal-separator" for="key-v-chk161"><hr></label><div class="goal-conclusion">key_lookup_index k n = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk162">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>~ contains_ix_upto n k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ contains_ix_upto n k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk163">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>n0</var><span class="hyp-type"><b>: </b><span>~ contains_ix_upto n k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index k n = None</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto using</span> key_lookup_ix_None2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">lookup_ix_in_key</span> k n :=
  <span class="kr">let</span> <span class="nv">a</span> := <span class="kp">fresh</span> <span class="s2">&quot;a&quot;</span> <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">Hcont</span> := <span class="kp">fresh</span> <span class="s2">&quot;Hcont&quot;</span> <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">H_key_lookup</span> := <span class="kp">fresh</span> <span class="s2">&quot;H_key_lookup&quot;</span> <span class="kr">in</span>
  <span class="nb">destruct</span> (key_lookup_ix_decide k n) <span class="kr">as</span>
    [[Hcont [a H_key_lookup]] | [Hcont H_key_lookup]];
  <span class="kp">try</span> <span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Tactic Notation</span> <span class="s2">&quot;lookup&quot;</span> <span class="s2">&quot;index&quot;</span> <span class="kp">constr</span>(ix) <span class="s2">&quot;in&quot;</span> <span class="s2">&quot;key&quot;</span> <span class="kp">constr</span>(k) :=
  lookup_ix_in_key k ix.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk164"><span class="kn">Goal</span> <span class="kr">forall</span> <span class="nv">k</span> (<span class="nv">ix</span>: nat), contains_ix_upto ix k \/ ~ contains_ix_upto ix k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat),
contains_ix_upto ix k \/ ~ contains_ix_upto ix k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk165"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat),
contains_ix_upto ix k \/ ~ contains_ix_upto ix k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk166"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains_ix_upto ix k \/ ~ contains_ix_upto ix k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk167">lookup index ix <span class="kr">in</span> key k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hcont</var><span class="hyp-type"><b>: </b><span>contains_ix_upto ix k</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H_key_lookup</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains_ix_upto ix k \/ ~ contains_ix_upto ix k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk168" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hcont</var><span class="hyp-type"><b>: </b><span>~ contains_ix_upto ix k</span></span></span><br><span><var>H_key_lookup</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = None</span></span></span><br></div><label class="goal-separator" for="key-v-chk168"><hr></label><div class="goal-conclusion">contains_ix_upto ix k \/ ~ contains_ix_upto ix k</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk169">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hcont</var><span class="hyp-type"><b>: </b><span>contains_ix_upto ix k</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H_key_lookup</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains_ix_upto ix k \/ ~ contains_ix_upto ix k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk16a"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hcont</var><span class="hyp-type"><b>: </b><span>contains_ix_upto ix k</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H_key_lookup</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains_ix_upto ix k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intuition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk16b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hcont</var><span class="hyp-type"><b>: </b><span>~ contains_ix_upto ix k</span></span></span><br><span><var>H_key_lookup</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">contains_ix_upto ix k \/ ~ contains_ix_upto ix k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">right</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Properties of &lt;&lt;key_lookup_index&gt;&gt; *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk16c"><span class="kn">Lemma</span> <span class="nf">key_lookup_zero</span>: <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">k</span> <span class="nv">ix</span>,
    ix = <span class="mi">0</span> -&gt;
    key_lookup_index (a :: k) ix = Some a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">ix</span> : nat),
ix = <span class="mi">0</span> -&gt; key_lookup_index (a :: k) ix = Some a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk16d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">ix</span> : nat),
ix = <span class="mi">0</span> -&gt; key_lookup_index (a :: k) ix = Some a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk16e"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>ix = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index (a :: k) ix = Some a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk16f"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index (a :: k) <span class="mi">0</span> = Some a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk170"><span class="kn">Lemma</span> <span class="nf">key_lookup_index_S</span>: <span class="kr">forall</span> <span class="nv">k</span> <span class="nv">ix</span> <span class="nv">a</span>,
    key_lookup_index k ix = Some a -&gt;
    <span class="kr">forall</span> <span class="nv">a&#39;</span>, key_lookup_index (a&#39; :: k) (S ix) = Some a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat) (<span class="nv">a</span> : atom),
key_lookup_index k ix = Some a -&gt;
<span class="kr">forall</span> <span class="nv">a&#39;</span> : atom,
key_lookup_index (a&#39; :: k) (S ix) = Some a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk171"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat) (<span class="nv">a</span> : atom),
key_lookup_index k ix = Some a -&gt;
<span class="kr">forall</span> <span class="nv">a&#39;</span> : atom,
key_lookup_index (a&#39; :: k) (S ix) = Some a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk172"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index (a&#39; :: k) (S ix) = Some a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk173"><span class="kn">Lemma</span> <span class="nf">key_lookup_index_cons</span>: <span class="kr">forall</span> <span class="nv">a&#39;</span> <span class="nv">a</span> <span class="nv">k</span> <span class="nv">ix</span>,
    key_lookup_index (a&#39; :: k) ix = Some a -&gt;
    ix = <span class="mi">0</span> /\ a = a&#39; \/
      <span class="kr">exists</span> <span class="nv">ix&#39;</span>, ix = S ix&#39; /\ key_lookup_index k ix&#39; = Some a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a&#39;</span> <span class="nv">a</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">ix</span> : nat),
key_lookup_index (a&#39; :: k) ix = Some a -&gt;
ix = <span class="mi">0</span> /\ a = a&#39; \/
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   ix = S ix&#39; /\ key_lookup_index k ix&#39; = Some a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk174"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a&#39;</span> <span class="nv">a</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">ix</span> : nat),
key_lookup_index (a&#39; :: k) ix = Some a -&gt;
ix = <span class="mi">0</span> /\ a = a&#39; \/
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   ix = S ix&#39; /\ key_lookup_index k ix&#39; = Some a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk175">introv Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a', a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a&#39; :: k) ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ix = <span class="mi">0</span> /\ a = a&#39; \/
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   ix = S ix&#39; /\ key_lookup_index k ix&#39; = Some a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk176"><span class="nb">destruct</span> ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a', a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a&#39; :: k) <span class="mi">0</span> = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = <span class="mi">0</span> /\ a = a&#39; \/
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   <span class="mi">0</span> = S ix&#39; /\ key_lookup_index k ix&#39; = Some a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk177" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a', a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a&#39; :: k) (S ix) = Some a</span></span></span><br></div><label class="goal-separator" for="key-v-chk177"><hr></label><div class="goal-conclusion">S ix = <span class="mi">0</span> /\ a = a&#39; \/
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   S ix = S ix&#39; /\ key_lookup_index k ix&#39; = Some a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk178">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a', a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a&#39; :: k) <span class="mi">0</span> = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = <span class="mi">0</span> /\ a = a&#39; \/
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   <span class="mi">0</span> = S ix&#39; /\ key_lookup_index k ix&#39; = Some a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk179"><span class="nb">cbn</span> <span class="kr">in</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a', a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>Some a&#39; = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = <span class="mi">0</span> /\ a = a&#39; \/
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   <span class="mi">0</span> = S ix&#39; /\ key_lookup_index k ix&#39; = Some a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk17a"><span class="nb">inversion</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a', a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>Some a&#39; = Some a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>a&#39; = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = <span class="mi">0</span> /\ a = a \/
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   <span class="mi">0</span> = S ix&#39; /\ key_lookup_index k ix&#39; = Some a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk17b"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a', a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>Some a&#39; = Some a</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>a&#39; = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = <span class="mi">0</span> /\ a = a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">split</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk17c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a', a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a&#39; :: k) (S ix) = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S ix = <span class="mi">0</span> /\ a = a&#39; \/
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   S ix = S ix&#39; /\ key_lookup_index k ix&#39; = Some a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk17d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk17d"><span class="nb">cbn</span> <span class="kr">in</span> Hin.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a', a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S ix = <span class="mi">0</span> /\ a = a&#39; \/
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   S ix = S ix&#39; /\ key_lookup_index k ix&#39; = Some a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk17e"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a', a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
  S ix = S ix&#39; /\ key_lookup_index k ix&#39; = Some a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk17f"><span class="kr">exists</span> <span class="nv">ix</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a', a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S ix = S ix /\ key_lookup_index k ix = Some a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk180" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk180"><span class="kn">Lemma</span> <span class="nf">key_bijection1</span>: <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">k</span> <span class="nv">ix</span>,
    key_lookup_atom k a = Some ix -&gt;
    key_lookup_index k ix = Some a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : atom) (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat),
key_lookup_atom k a = Some ix -&gt;
key_lookup_index k ix = Some a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk181"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : atom) (<span class="nv">k</span> : key) (<span class="nv">ix</span> : nat),
key_lookup_atom k a = Some ix -&gt;
key_lookup_index k ix = Some a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk182"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = Some ix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index k ix = Some a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk183"><span class="nb">generalize dependent</span> ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>key</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_atom k a = Some ix -&gt;
key_lookup_index k ix = Some a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk184"><span class="nb">induction</span> k; <span class="nb">intros</span> ix Hix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>key_lookup_atom [] a = Some ix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index [] ix = Some a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk185" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_atom k a = Some ix -&gt; key_lookup_index k ix = Some a</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>key_lookup_atom (a0 :: k) a = Some ix</span></span></span><br></div><label class="goal-separator" for="key-v-chk185"><hr></label><div class="goal-conclusion">key_lookup_index (a0 :: k) ix = Some a</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk186">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>key_lookup_atom [] a = Some ix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index [] ix = Some a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk187" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk187"><span class="nb">cbn</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>None = Some ix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">None = Some a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Hix.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk188">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_atom k a = Some ix -&gt; key_lookup_index k ix = Some a</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>key_lookup_atom (a0 :: k) a = Some ix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index (a0 :: k) ix = Some a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk189"><span class="nb">apply</span> key_lookup_atom_cons <span class="kr">in</span> Hix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_atom k a = Some ix -&gt; key_lookup_index k ix = Some a</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>a = a0 /\ ix = <span class="mi">0</span> \/
a &lt;&gt; a0 /\ (<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat, ix = S ix&#39; /\ key_lookup_atom k a = Some ix&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index (a0 :: k) ix = Some a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk18a"><span class="nb">destruct</span> Hix <span class="kr">as</span>
      [ [Heq Hix0] | [Hneq [Hix [Heq Hlookup]]] ]; <span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_atom k a0 = Some ix -&gt; key_lookup_index k ix = Some a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index (a0 :: k) <span class="mi">0</span> = Some a0</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk18b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_atom k a = Some ix -&gt; key_lookup_index k ix = Some a</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlookup</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = Some Hix</span></span></span><br></div><label class="goal-separator" for="key-v-chk18b"><hr></label><div class="goal-conclusion">key_lookup_index (a0 :: k) (S Hix) = Some a</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk18c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_atom k a0 = Some ix -&gt;
key_lookup_index k ix = Some a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index (a0 :: k) <span class="mi">0</span> = Some a0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk18d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk18d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_atom k a = Some ix -&gt;
key_lookup_index k ix = Some a</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlookup</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = Some Hix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index (a0 :: k) (S Hix) = Some a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk18e"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_atom k a = Some ix -&gt;
key_lookup_index k ix = Some a</span></span></span><br><span><var>Hneq</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hlookup</var><span class="hyp-type"><b>: </b><span>key_lookup_atom k a = Some Hix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index k Hix = Some a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk18f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk18f"><span class="kn">Lemma</span> <span class="nf">key_bijection2</span>: <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">k</span> <span class="nv">ix</span>,
    unique k -&gt;
    key_lookup_index k ix = Some a -&gt;
    key_lookup_atom k a = Some ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">ix</span> : nat),
unique k -&gt;
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk190"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">ix</span> : nat),
unique k -&gt;
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk191" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk191">introv Huniq Hix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom k a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk192"><span class="nb">generalize dependent</span> ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk193" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk193"><span class="nb">induction</span> k; <span class="nb">intros</span> ix Hix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique []</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>key_lookup_index [] ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom [] a = Some ix</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk194" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique k -&gt;
<span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) ix = Some a</span></span></span><br></div><label class="goal-separator" for="key-v-chk194"><hr></label><div class="goal-conclusion">key_lookup_atom (a0 :: k) a = Some ix</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk195">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique []</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>key_lookup_index [] ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom [] a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk196"><span class="nb">cbn</span> <span class="kr">in</span> Hix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique []</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>None = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom [] a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> Hix.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk197">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique k -&gt;
<span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_atom (a0 :: k) a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk198"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique k -&gt;
<span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>key_lookup_index (a0 :: k) ix = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> a == a0
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> map S (key_lookup_atom k a)) = 
Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk199"><span class="nb">apply</span> key_lookup_index_cons <span class="kr">in</span> Hix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique k -&gt;
<span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix</var><span class="hyp-type"><b>: </b><span>ix = <span class="mi">0</span> /\ a = a0 \/
(<span class="kr">exists</span> <span class="nv">ix&#39;</span> : nat,
   ix = S ix&#39; /\ key_lookup_index k ix&#39; = Some a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> a == a0
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> map S (key_lookup_atom k a)) = 
Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk19a" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk19a"><span class="nb">destruct</span> Hix <span class="kr">as</span> [[Hix_zero Heq] | [ix&#39; [Heq Hrest]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique k -&gt;
<span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix_zero</var><span class="hyp-type"><b>: </b><span>ix = <span class="mi">0</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>a = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> a == a0
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> map S (key_lookup_atom k a)) = 
Some ix</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk19b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique k -&gt;
<span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</span></span></span><br><span><var>ix, ix'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>ix = S ix&#39;</span></span></span><br><span><var>Hrest</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix&#39; = Some a</span></span></span><br></div><label class="goal-separator" for="key-v-chk19b"><hr></label><div class="goal-conclusion">(<span class="kr">if</span> a == a0
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> map S (key_lookup_atom k a)) = 
Some ix</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk19c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique k -&gt;
<span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hix_zero</var><span class="hyp-type"><b>: </b><span>ix = <span class="mi">0</span></span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>a = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> a == a0
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> map S (key_lookup_atom k a)) = 
Some ix</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk19d"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique k -&gt;
<span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a0 -&gt;
key_lookup_atom k a0 = Some ix</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> a0 == a0
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> map S (key_lookup_atom k a0)) = 
Some <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">compare</span> atoms.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk19e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique (a0 :: k)</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique k -&gt;
<span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</span></span></span><br><span><var>ix, ix'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>ix = S ix&#39;</span></span></span><br><span><var>Hrest</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix&#39; = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> a == a0
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> map S (key_lookup_atom k a)) = 
Some ix</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk19f"><span class="nb">destruct</span> Huniq <span class="kr">as</span> [Hnin Huniq].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span>unique k -&gt;
<span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</span></span></span><br><span><var>ix, ix'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>ix = S ix&#39;</span></span></span><br><span><var>Hrest</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix&#39; = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> a == a0
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> map S (key_lookup_atom k a)) = 
Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1a0"><span class="nb">specialize</span> (IHk Huniq).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</span></span></span><br><span><var>ix, ix'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>ix = S ix&#39;</span></span></span><br><span><var>Hrest</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix&#39; = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> a == a0
 <span class="kr">then</span> Some <span class="mi">0</span>
 <span class="kr">else</span> map S (key_lookup_atom k a)) = 
Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1a1"><span class="nb">compare</span> atoms.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a0 -&gt;
key_lookup_atom k a0 = Some ix</span></span></span><br><span><var>ix'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hrest</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix&#39; = Some a0</span></span></span><br><span><var>DESTR_EQs</var><span class="hyp-type"><b>: </b><span>a0 = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some <span class="mi">0</span> = Some (S ix&#39;)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk1a2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</span></span></span><br><span><var>ix'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hrest</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix&#39; = Some a</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><label class="goal-separator" for="key-v-chk1a2"><hr></label><div class="goal-conclusion">map S (key_lookup_atom k a) = Some (S ix&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1a3">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a0 -&gt;
key_lookup_atom k a0 = Some ix</span></span></span><br><span><var>ix'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hrest</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix&#39; = Some a0</span></span></span><br><span><var>DESTR_EQs</var><span class="hyp-type"><b>: </b><span>a0 = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some <span class="mi">0</span> = Some (S ix&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1a4">false.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a0 -&gt;
key_lookup_atom k a0 = Some ix</span></span></span><br><span><var>ix'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hrest</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix&#39; = Some a0</span></span></span><br><span><var>DESTR_EQs</var><span class="hyp-type"><b>: </b><span>a0 = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1a5" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1a5"><span class="nb">apply</span> key_lookup_ix_in <span class="kr">in</span> Hrest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a0 -&gt;
key_lookup_atom k a0 = Some ix</span></span></span><br><span><var>ix'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hrest</var><span class="hyp-type"><b>: </b><span>a0 ‚àà k</span></span></span><br><span><var>DESTR_EQs</var><span class="hyp-type"><b>: </b><span>a0 = a0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1a6">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</span></span></span><br><span><var>ix'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hrest</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix&#39; = Some a</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map S (key_lookup_atom k a) = Some (S ix&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1a7"><span class="nb">rewrite</span> (IHk ix&#39; Hrest).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, a0</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>Hnin</var><span class="hyp-type"><b>: </b><span>~ a0 ‚àà k</span></span></span><br><span><var>Huniq</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br><span><var>IHk</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">ix</span> : nat,
key_lookup_index k ix = Some a -&gt;
key_lookup_atom k a = Some ix</span></span></span><br><span><var>ix'</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hrest</var><span class="hyp-type"><b>: </b><span>key_lookup_index k ix&#39; = Some a</span></span></span><br><span><var>DESTR_NEQ</var><span class="hyp-type"><b>: </b><span>a &lt;&gt; a0</span></span></span><br><span><var>DESTR_NEQs</var><span class="hyp-type"><b>: </b><span>a0 &lt;&gt; a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map S (Some ix&#39;) = Some (S ix&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1a8" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1a8"><span class="kn">Lemma</span> <span class="nf">key_bijection</span>: <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">k</span> <span class="nv">ix</span>,
    unique k -&gt;
    key_lookup_index k ix = Some a &lt;-&gt;
      key_lookup_atom k a = Some ix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">ix</span> : nat),
unique k -&gt;
key_lookup_index k ix = Some a &lt;-&gt;
key_lookup_atom k a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1a9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : atom) (<span class="nv">k</span> : list atom) (<span class="nv">ix</span> : nat),
unique k -&gt;
key_lookup_index k ix = Some a &lt;-&gt;
key_lookup_atom k a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1aa"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a</var><span class="hyp-type"><b>: </b><span>atom</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>list atom</span></span></span><br><span><var>ix</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>unique k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">key_lookup_index k ix = Some a &lt;-&gt;
key_lookup_atom k a = Some ix</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">auto using</span> key_bijection1, key_bijection2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">PartialBijection</span> {<span class="nv">A</span> <span class="nv">B</span>: <span class="kt">Type</span>}
  (<span class="nv">f</span>: A -&gt; option B)
  (<span class="nv">g</span>: B -&gt; option A) :=
  { pb_fwd: <span class="kr">forall</span> (<span class="nv">a</span>: A) (<span class="nv">b</span>: B),
      f a = Some b -&gt; g b = Some a;
    pb_bwd: <span class="kr">forall</span> (<span class="nv">b</span>: B) (<span class="nv">a</span>: A),
      g b = Some a -&gt; f a = Some b;

  }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1ab"><span class="kn">Lemma</span> <span class="nf">pb_iff</span> `{PartialBijection A B f g}:
  <span class="kr">forall</span> (<span class="nv">a</span>: A) (<span class="nv">b</span>: B),
    f a = Some b &lt;-&gt; g b = Some a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B), f a = Some b &lt;-&gt; g b = Some a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1ac"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B), f a = Some b &lt;-&gt; g b = Some a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1ad"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = Some b &lt;-&gt; g b = Some a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1ae"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = Some b -&gt; g b = Some a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk1af" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="key-v-chk1af"><hr></label><div class="goal-conclusion">g b = Some a -&gt; f a = Some b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1b0"><span class="nb">apply</span> pb_fwd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">g b = Some a -&gt; f a = Some b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> pb_bwd.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1b1"><span class="kn">Lemma</span> <span class="nf">pb_fwd_None</span> `{PartialBijection A B f g}:
  <span class="kr">forall</span> (<span class="nv">a</span>: A),
    f a = None -&gt; <span class="kr">forall</span> <span class="nv">b</span>, g b = Some a -&gt; <span class="kt">False</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : A,
f a = None -&gt; <span class="kr">forall</span> <span class="nv">b</span> : B, g b = Some a -&gt; <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1b2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : A,
f a = None -&gt; <span class="kr">forall</span> <span class="nv">b</span> : B, g b = Some a -&gt; <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1b3">introv H1 H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>f a = None</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>g b = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1b4" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1b4"><span class="nb">apply</span> pb_bwd <span class="kr">in</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>f a = None</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>f a = Some b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1b5"><span class="kn">Lemma</span> <span class="nf">pb_bwd_None</span> `{PartialBijection A B f g}:
  <span class="kr">forall</span> (<span class="nv">b</span>: B),
    g b = None -&gt; <span class="kr">forall</span> <span class="nv">a</span>, f a = Some b -&gt; <span class="kt">False</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : B,
g b = None -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, f a = Some b -&gt; <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1b6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : B,
g b = None -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, f a = Some b -&gt; <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1b7">introv H1 H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>g b = None</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>f a = Some b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1b8"><span class="nb">apply</span> pb_fwd <span class="kr">in</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>g b = None</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>g b = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">congruence</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1b9"><span class="kn">Lemma</span> <span class="nf">pb_iff_None</span> `{PartialBijection A B f g}:
  <span class="kr">forall</span> (<span class="nv">a</span>: A),
    f a = None &lt;-&gt; <span class="kr">forall</span> (<span class="nv">b</span>: B), ~ (g b = Some a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : A,
f a = None &lt;-&gt; (<span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1ba"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : A,
f a = None &lt;-&gt; (<span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1bb"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a = None &lt;-&gt; (<span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1bc" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1bc"><span class="nb">remember</span> (f a) <span class="kr">as</span> fa.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>fa</var><span class="hyp-type"><b>: </b><span>option B</span></span></span><br><span><var>Heqfa</var><span class="hyp-type"><b>: </b><span>fa = f a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fa = None &lt;-&gt; (<span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1bd" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1bd"><span class="nb">symmetry in</span> Heqfa.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>fa</var><span class="hyp-type"><b>: </b><span>option B</span></span></span><br><span><var>Heqfa</var><span class="hyp-type"><b>: </b><span>f a = fa</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fa = None &lt;-&gt; (<span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1be" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1be"><span class="nb">destruct</span> fa.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Heqfa</var><span class="hyp-type"><b>: </b><span>f a = Some b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some b = None &lt;-&gt; (<span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk1bf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Heqfa</var><span class="hyp-type"><b>: </b><span>f a = None</span></span></span><br></div><label class="goal-separator" for="key-v-chk1bf"><hr></label><div class="goal-conclusion">None = None &lt;-&gt; (<span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1c0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Heqfa</var><span class="hyp-type"><b>: </b><span>f a = Some b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some b = None &lt;-&gt; (<span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1c1" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1c1"><span class="nb">apply</span> pb_fwd <span class="kr">in</span> Heqfa.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Heqfa</var><span class="hyp-type"><b>: </b><span>g b = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some b = None &lt;-&gt; (<span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1c2" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1c2"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Heqfa</var><span class="hyp-type"><b>: </b><span>g b = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some b = None -&gt; <span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="key-v-chk1c3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Heqfa</var><span class="hyp-type"><b>: </b><span>g b = Some a</span></span></span><br></div><label class="goal-separator" for="key-v-chk1c3"><hr></label><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a) -&gt; Some b = None</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1c4" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1c4"><span class="nb">inversion</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Heqfa</var><span class="hyp-type"><b>: </b><span>g b = Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a) -&gt; Some b = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1c5" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1c5"><span class="nb">intros</span> contra.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Heqfa</var><span class="hyp-type"><b>: </b><span>g b = Some a</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some b = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1c6" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1c6"><span class="nb">specialize</span> (contra b Heqfa).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Heqfa</var><span class="hyp-type"><b>: </b><span>g b = Some a</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span><span class="kt">False</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Some b = None</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1c7" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1c7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Heqfa</var><span class="hyp-type"><b>: </b><span>f a = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">None = None &lt;-&gt; (<span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="key-v-chk1c8" style="display: none" type="checkbox"><label class="alectryon-input" for="key-v-chk1c8"><span class="nb">specialize</span> (pb_fwd_None a Heqfa).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; option B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; option A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PartialBijection f g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Heqfa</var><span class="hyp-type"><b>: </b><span>f a = None</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">b</span> : B, g b = Some a -&gt; <span class="kt">False</span>) -&gt;
None = None &lt;-&gt; (<span class="kr">forall</span> <span class="nv">b</span> : B, g b &lt;&gt; Some a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span></span></pre>
</div>
</div></body>
</html>
