<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.21.2: https://docutils.sourceforge.io/" />
<title>Batch.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.16.0+0.16.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Tealeaves <span class="kn">Require Import</span>
  Classes.Categorical.Applicative
  Categories.TypeFamily.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Applicative.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Generalizable Variables</span> <span class="nf">A</span> B C D W S G T.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Set Implicit Arguments</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * The &lt;&lt;BatchM&gt;&gt; idiom *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">BatchM</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    `{ix: Index}
     {T: K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span>}
     {W A B: <span class="kt">Type</span>}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">BatchM</span> <span class="nv">C</span>: <span class="kt">Type</span>:=
  | Go: C -&gt; BatchM C
  | Ap: <span class="kr">forall</span> (<span class="nv">k</span>: K), BatchM (T k B -&gt; C) -&gt; W * A -&gt; BatchM C.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Infix</span> <span class="s2">&quot;‚ßÜ&quot;</span>:= Ap (<span class="kn">at level</span> <span class="mi">51</span>, <span class="kn">left associativity</span>): tealeaves_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** ** Functor instance *)</span>
  <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">map_BatchM</span> `{f: C -&gt; D} `(c: BatchM C): BatchM D:=
    <span class="kr">match</span> c <span class="kr">with</span>
    | Go c =&gt; Go (f c)
    | @Ap _ k rest (pair w a) =&gt;
        Ap (@map_BatchM (T k B -&gt; C) (T k B -&gt; D) (compose f) rest) (w, a)
    <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Instance</span> <span class="nf">Map_BatchM</span>: Map BatchM:= @map_BatchM.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk0"><span class="kn">Lemma</span> <span class="nf">map_id_BatchM</span>: <span class="kr">forall</span> (<span class="nv">C</span>: <span class="kt">Type</span>),
      map (F:= BatchM) id = @id (BatchM C).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span>, map id = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span>, map id = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk2"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map id = id</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk3">ext s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map id s = id s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk4"><span class="nb">induction</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map id (Go c) = id (Go c)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="batch-v-chk5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>map id s = id s</span></span></span><br></div><label class="goal-separator" for="batch-v-chk5"><hr></label><div class="goal-conclusion">map id (s ‚ßÜ p) = id (s ‚ßÜ p)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map id (Go c) = id (Go c)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>map id s = id s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map id (s ‚ßÜ p) = id (s ‚ßÜ p)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk8"><span class="nb">unfold</span> id <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>map (<span class="kr">fun</span> <span class="nv">x</span> : T k B -&gt; C =&gt; x) s = s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> <span class="nv">x</span> : C =&gt; x) (s ‚ßÜ p) = s ‚ßÜ p</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk9"><span class="nb">destruct</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span>map (<span class="kr">fun</span> <span class="nv">x</span> : T k B -&gt; C =&gt; x) s = s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> <span class="nv">x</span> : C =&gt; x) (s ‚ßÜ (w, a)) = s ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- IHs <span class="nb">at</span> <span class="mi">2</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chka"><span class="kn">Lemma</span> <span class="nf">map_map_BatchM</span>: <span class="kr">forall</span> (<span class="nv">C</span> <span class="nv">D</span> <span class="nv">E</span>: <span class="kt">Type</span>) (<span class="nv">f</span>: C -&gt; D) (<span class="nv">g</span>: D -&gt; E),
      map (F:= BatchM) g ‚àò map (F:= BatchM) f = map (F:= BatchM) (g ‚àò f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> <span class="nv">D</span> <span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : C -&gt; D) (<span class="nv">g</span> : D -&gt; E),
map g ‚àò map f = map (g ‚àò f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> <span class="nv">D</span> <span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : C -&gt; D) (<span class="nv">g</span> : D -&gt; E),
map g ‚àò map f = map (g ‚àò f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkc"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D, E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>D -&gt; E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map g ‚àò map f = map (g ‚àò f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkd"><span class="nb">unfold</span> compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D, E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>D -&gt; E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map g ‚óã map f = map (g ‚óã f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chke">ext s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D, E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>D -&gt; E</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map g (map f s) = map (g ‚óã f) s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkf"><span class="nb">generalize dependent</span> E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : D -&gt; E),
map g (map f s) = map (g ‚óã f) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk10"><span class="nb">generalize dependent</span> D.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : C -&gt; D) (<span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : D -&gt; E),
map g (map f s) = map (g ‚óã f) s</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk11"><span class="nb">induction</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : C -&gt; D) (<span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : D -&gt; E),
map g (map f (Go c)) = map (g ‚óã f) (Go c)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="batch-v-chk12" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : (T k B -&gt; C) -&gt; D) (<span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : D -&gt; E),
map g (map f s) = map (g ‚óã f) s</span></span></span><br></div><label class="goal-separator" for="batch-v-chk12"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : C -&gt; D) (<span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : D -&gt; E),
map g (map f (s ‚ßÜ p)) = map (g ‚óã f) (s ‚ßÜ p)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk13">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : C -&gt; D) (<span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : D -&gt; E),
map g (map f (Go c)) = map (g ‚óã f) (Go c)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk14">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : (T k B -&gt; C) -&gt; D) (<span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : D -&gt; E),
map g (map f s) = map (g ‚óã f) s</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : C -&gt; D) (<span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : D -&gt; E),
map g (map f (s ‚ßÜ p)) = map (g ‚óã f) (s ‚ßÜ p)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk15"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : (T k B -&gt; C) -&gt; D) (<span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : D -&gt; E),
map g (map f s) = map (g ‚óã f) s</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>D -&gt; E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map g (map f (s ‚ßÜ p)) = map (g ‚óã f) (s ‚ßÜ p)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk16"><span class="nb">destruct</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : (T k B -&gt; C) -&gt; D) (<span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : D -&gt; E),
map g (map f s) = map (g ‚óã f) s</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>D -&gt; E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map g (map f (s ‚ßÜ (w, a))) = map (g ‚óã f) (s ‚ßÜ (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk17"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : (T k B -&gt; C) -&gt; D) (<span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : D -&gt; E),
map g (map f s) = map (g ‚óã f) s</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>D -&gt; E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose g) (map (compose f) s) ‚ßÜ (w, a) =
map (compose (g ‚óã f)) s ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk18">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : (T k B -&gt; C) -&gt; D) (<span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : D -&gt; E),
map g (map f s) = map (g ‚óã f) s</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>D -&gt; E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose g) (map (compose f) s) =
map (compose (g ‚óã f)) s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHs.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>, program] <span class="kn">Instance</span> <span class="nf">Functor_BatchM</span>: Functor BatchM:=
    {| fun_map_id:= map_id_BatchM;
      fun_map_map:= map_map_BatchM;
    |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** ** Applicative Instance *)</span>
  <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Instance</span> <span class="nf">Pure_BatchM</span>: Pure BatchM:=
    <span class="kr">fun</span> (<span class="nv">C</span>: <span class="kt">Type</span>) (<span class="nv">c</span>: C) =&gt; Go c.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">mult_BatchM</span> `(jc: BatchM C) `(jd: BatchM D): BatchM (C * D):=
    <span class="kr">match</span> jd <span class="kr">with</span>
    | Go d =&gt; map (F:= BatchM) (<span class="kr">fun</span> (<span class="nv">c</span>: C) =&gt; (c, d)) jc
    | Ap rest (pair w a) =&gt;
      Ap (map (F:= BatchM) strength_arrow (mult_BatchM jc rest)) (pair w a)
    <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Instance</span> <span class="nf">Mult_BatchM</span>: Mult BatchM:=
    <span class="kr">fun</span> <span class="nv">C</span> <span class="nv">D</span> &#39;(c, d) =&gt; mult_BatchM c d.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk19"><span class="kn">Lemma</span> <span class="nf">mult_BatchM_rw1</span>: <span class="kr">forall</span> `(a: A) `(b: B),
      Go a ‚äó Go b = Go (a, b).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B), Go a ‚äó Go b = Go (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk1a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B), Go a ‚äó Go b = Go (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk1b"><span class="kn">Lemma</span> <span class="nf">mult_BatchM_rw2</span>: <span class="kr">forall</span> `(d: D) `(jc: BatchM C),
      jc ‚äó Go d = map (F:= BatchM) (pair_right d) jc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">d</span> : D) (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">jc</span> : BatchM C),
jc ‚äó Go d = map (pair_right d) jc</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk1c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">d</span> : D) (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">jc</span> : BatchM C),
jc ‚äó Go d = map (pair_right d) jc</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk1d"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>jc</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">jc ‚äó Go d = map (pair_right d) jc</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> jc; <span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk1e"><span class="kn">Lemma</span> <span class="nf">mult_BatchM_rw3</span>: <span class="kr">forall</span> `(d: D) `(jc: BatchM C),
      Go d ‚äó jc =
        map (F:= BatchM) (pair d) jc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">d</span> : D) (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">jc</span> : BatchM C),
Go d ‚äó jc = map (pair d) jc</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk1f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">d</span> : D) (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">jc</span> : BatchM C),
Go d ‚äó jc = map (pair d) jc</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk20"><span class="nb">induction</span> jc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Go d ‚äó Go c = map (pair d) (Go c)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="batch-v-chk21" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>jc</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHjc</var><span class="hyp-type"><b>: </b><span>Go d ‚äó jc = map (pair d) jc</span></span></span><br></div><label class="goal-separator" for="batch-v-chk21"><hr></label><div class="goal-conclusion">Go d ‚äó (jc ‚ßÜ p) = map (pair d) (jc ‚ßÜ p)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk22">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Go d ‚äó Go c = map (pair d) (Go c)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk23">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>jc</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHjc</var><span class="hyp-type"><b>: </b><span>Go d ‚äó jc = map (pair d) jc</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Go d ‚äó (jc ‚ßÜ p) = map (pair d) (jc ‚ßÜ p)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk24"><span class="nb">destruct</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>jc</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHjc</var><span class="hyp-type"><b>: </b><span>Go d ‚äó jc = map (pair d) jc</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Go d ‚äó (jc ‚ßÜ (w, a)) = map (pair d) (jc ‚ßÜ (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk25"><span class="nb">cbn</span>; <span class="nb">change</span> (mult_BatchM <span class="nl">?x</span> <span class="nl">?y</span>) <span class="kr">with</span> (x ‚äó y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>jc</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHjc</var><span class="hyp-type"><b>: </b><span>Go d ‚äó jc = map (pair d) jc</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map strength_arrow (Go d ‚äó jc) ‚ßÜ (w, a) =
map (compose (pair d)) jc ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk26">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>jc</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHjc</var><span class="hyp-type"><b>: </b><span>Go d ‚äó jc = map (pair d) jc</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map strength_arrow (Go d ‚äó jc) =
map (compose (pair d)) jc</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk27"><span class="nb">rewrite</span> IHjc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>jc</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHjc</var><span class="hyp-type"><b>: </b><span>Go d ‚äó jc = map (pair d) jc</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map strength_arrow (map (pair d) jc) =
map (compose (pair d)) jc</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk28">compose near jc on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>jc</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHjc</var><span class="hyp-type"><b>: </b><span>Go d ‚äó jc = map (pair d) jc</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map strength_arrow ‚àò map (pair d)) jc =
map (compose (pair d)) jc</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (fun_map_map (F:= BatchM)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk29"><span class="kn">Lemma</span> <span class="nf">mult_BatchM_rw4</span>: <span class="kr">forall</span> (<span class="nv">w</span>: W) (<span class="nv">a</span>: A) (<span class="nv">k</span>: K) `(jc: @BatchM (T k B -&gt; C)) `(d: D),
      (jc ‚ßÜ (w, a)) ‚äó Go d =
        map (F:= BatchM) (costrength_arrow ‚àò pair_right d) jc ‚ßÜ (w, a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">w</span> : W) (<span class="nv">a</span> : A) (<span class="nv">k</span> : K) (<span class="nv">C</span> : <span class="kt">Type</span>)
  (<span class="nv">jc</span> : BatchM (T k B -&gt; C)) (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">d</span> : D),
(jc ‚ßÜ (w, a)) ‚äó Go d =
map (costrength_arrow ‚àò pair_right d) jc ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk2a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">w</span> : W) (<span class="nv">a</span> : A) (<span class="nv">k</span> : K) (<span class="nv">C</span> : <span class="kt">Type</span>)
  (<span class="nv">jc</span> : BatchM (T k B -&gt; C)) (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">d</span> : D),
(jc ‚ßÜ (w, a)) ‚äó Go d =
map (costrength_arrow ‚àò pair_right d) jc ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk2b"><span class="kn">Lemma</span> <span class="nf">mult_BatchM_rw5</span>: <span class="kr">forall</span> (<span class="nv">w</span>: W) (<span class="nv">a</span>: A) (<span class="nv">k</span>: K) `(jc: @BatchM (T k B -&gt; C)) `(d: D),
      Go d ‚äó (jc ‚ßÜ (w, a)) =
        map (F:= BatchM) (strength_arrow ‚àò pair d) jc ‚ßÜ (w, a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">w</span> : W) (<span class="nv">a</span> : A) (<span class="nv">k</span> : K) (<span class="nv">C</span> : <span class="kt">Type</span>)
  (<span class="nv">jc</span> : BatchM (T k B -&gt; C)) (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">d</span> : D),
Go d ‚äó (jc ‚ßÜ (w, a)) =
map (strength_arrow ‚àò pair d) jc ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk2c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">w</span> : W) (<span class="nv">a</span> : A) (<span class="nv">k</span> : K) (<span class="nv">C</span> : <span class="kt">Type</span>)
  (<span class="nv">jc</span> : BatchM (T k B -&gt; C)) (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">d</span> : D),
Go d ‚äó (jc ‚ßÜ (w, a)) =
map (strength_arrow ‚àò pair d) jc ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk2d"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>jc</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Go d ‚äó (jc ‚ßÜ (w, a)) =
map (strength_arrow ‚àò pair d) jc ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk2e"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>jc</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map strength_arrow (mult_BatchM (Go d) jc) ‚ßÜ (w, a) =
map (strength_arrow ‚àò pair d) jc ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk2f"><span class="nb">change</span> (mult_BatchM <span class="nl">?x</span> <span class="nl">?y</span>) <span class="kr">with</span> (x ‚äó y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>jc</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map strength_arrow (Go d ‚äó jc) ‚ßÜ (w, a) =
map (strength_arrow ‚àò pair d) jc ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk30"><span class="nb">rewrite</span> (mult_BatchM_rw3 d).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>jc</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map strength_arrow (map (pair d) jc) ‚ßÜ (w, a) =
map (strength_arrow ‚àò pair d) jc ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk31">compose near jc on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>jc</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map strength_arrow ‚àò map (pair d)) jc ‚ßÜ (w, a) =
map (strength_arrow ‚àò pair d) jc ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk32"><span class="nb">rewrite</span> (fun_map_map (F:= BatchM)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>jc</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (strength_arrow ‚àò pair d) jc ‚ßÜ (w, a) =
map (strength_arrow ‚àò pair d) jc ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk33"><span class="kn">Lemma</span> <span class="nf">mult_BatchM_rw6</span>:
    <span class="kr">forall</span> (<span class="nv">w1</span> <span class="nv">w2</span>: W) (<span class="nv">a1</span> <span class="nv">a2</span>: A) (<span class="nv">k</span>: K)
      `(jc: BatchM (T k B -&gt; C)) `(jd: BatchM (T k B -&gt; D)),
      (jc ‚ßÜ (w1, a1)) ‚äó (jd ‚ßÜ (w2, a2)) =
      map (F:= BatchM) strength_arrow ((jc ‚ßÜ (w1, a1)) ‚äó jd) ‚ßÜ (w2, a2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">w1</span> <span class="nv">w2</span> : W) (<span class="nv">a1</span> <span class="nv">a2</span> : A) (<span class="nv">k</span> : K) (<span class="nv">C</span> : <span class="kt">Type</span>)
  (<span class="nv">jc</span> : BatchM (T k B -&gt; C)) (<span class="nv">D</span> : <span class="kt">Type</span>)
  (<span class="nv">jd</span> : BatchM (T k B -&gt; D)),
(jc ‚ßÜ (w1, a1)) ‚äó (jd ‚ßÜ (w2, a2)) =
map strength_arrow ((jc ‚ßÜ (w1, a1)) ‚äó jd) ‚ßÜ (w2, a2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk34"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">w1</span> <span class="nv">w2</span> : W) (<span class="nv">a1</span> <span class="nv">a2</span> : A) (<span class="nv">k</span> : K) (<span class="nv">C</span> : <span class="kt">Type</span>)
  (<span class="nv">jc</span> : BatchM (T k B -&gt; C)) (<span class="nv">D</span> : <span class="kt">Type</span>)
  (<span class="nv">jd</span> : BatchM (T k B -&gt; D)),
(jc ‚ßÜ (w1, a1)) ‚äó (jd ‚ßÜ (w2, a2)) =
map strength_arrow ((jc ‚ßÜ (w1, a1)) ‚äó jd) ‚ßÜ (w2, a2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk35"><span class="kn">Lemma</span> <span class="nf">app_pure_natural_BatchM</span>:
    <span class="kr">forall</span> (<span class="nv">C</span> <span class="nv">D</span>: <span class="kt">Type</span>) (<span class="nv">f</span>: C -&gt; D) (<span class="nv">x</span>: C),
      map (F:= BatchM) f (pure (F:= BatchM) x) =
        pure (F:= BatchM) (f x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : C -&gt; D) (<span class="nv">x</span> : C),
map f (pure x) = pure (f x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk36"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : C -&gt; D) (<span class="nv">x</span> : C),
map f (pure x) = pure (f x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk37"><span class="kn">Lemma</span> <span class="nf">app_mult_natural_BatchM1</span>: <span class="kr">forall</span> (<span class="nv">C</span> <span class="nv">D</span> <span class="nv">E</span>: <span class="kt">Type</span>) (<span class="nv">f</span>: C -&gt; D) (<span class="nv">x</span>: BatchM C) (<span class="nv">y</span>: BatchM E),
      map (F:= BatchM) f x ‚äó y = map (F:= BatchM) (map_fst f) (x ‚äó y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> <span class="nv">D</span> <span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : C -&gt; D) (<span class="nv">x</span> : BatchM C)
  (<span class="nv">y</span> : BatchM E),
map f x ‚äó y = map (map_fst f) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk38"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> <span class="nv">D</span> <span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : C -&gt; D) (<span class="nv">x</span> : BatchM C)
  (<span class="nv">y</span> : BatchM E),
map f x ‚äó y = map (map_fst f) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk39"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D, E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM E</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f x ‚äó y = map (map_fst f) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk3a"><span class="nb">generalize dependent</span> E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">E</span> : <span class="kt">Type</span>) (<span class="nv">y</span> : BatchM E),
map f x ‚äó y = map (map_fst f) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk3b"><span class="nb">induction</span> y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br><span><var>C0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f x ‚äó Go c = map (map_fst f) (x ‚äó Go c)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="batch-v-chk3c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br><span><var>C0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C0)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span>map f x ‚äó y = map (map_fst f) (x ‚äó y)</span></span></span><br></div><label class="goal-separator" for="batch-v-chk3c"><hr></label><div class="goal-conclusion">map f x ‚äó (y ‚ßÜ p) = map (map_fst f) (x ‚äó (y ‚ßÜ p))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk3d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br><span><var>C0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f x ‚äó Go c = map (map_fst f) (x ‚äó Go c)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk3e"><span class="nb">intros</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br><span><var>C0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> <span class="nv">c0</span> : D =&gt; (c0, c)) (map f x) =
map (map_fst f) (map (<span class="kr">fun</span> <span class="nv">c0</span> : C =&gt; (c0, c)) x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk3f">compose near x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br><span><var>C0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map (<span class="kr">fun</span> <span class="nv">c0</span> : D =&gt; (c0, c)) ‚àò map f) x =
(map (map_fst f) ‚àò map (<span class="kr">fun</span> <span class="nv">c0</span> : C =&gt; (c0, c))) x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> (fun_map_map (F:= BatchM)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk40">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br><span><var>C0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C0)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span>map f x ‚äó y = map (map_fst f) (x ‚äó y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f x ‚äó (y ‚ßÜ p) = map (map_fst f) (x ‚äó (y ‚ßÜ p))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk41"><span class="nb">destruct</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br><span><var>C0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C0)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span>map f x ‚äó y = map (map_fst f) (x ‚äó y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f x ‚äó (y ‚ßÜ (w, a)) =
map (map_fst f) (x ‚äó (y ‚ßÜ (w, a)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk42"><span class="nb">cbn</span>; <span class="nb">change</span> (mult_BatchM <span class="nl">?x</span> <span class="nl">?y</span>) <span class="kr">with</span> (x ‚äó y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br><span><var>C0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C0)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span>map f x ‚äó y = map (map_fst f) (x ‚äó y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map strength_arrow (map f x ‚äó y) ‚ßÜ (w, a) =
map (compose (map_fst f)) (map strength_arrow (x ‚äó y))
‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk43"><span class="nb">rewrite</span> IHy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br><span><var>C0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C0)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span>map f x ‚äó y = map (map_fst f) (x ‚äó y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map strength_arrow (map (map_fst f) (x ‚äó y)) ‚ßÜ (w, a) =
map (compose (map_fst f)) (map strength_arrow (x ‚äó y))
‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk44">compose near (x ‚äó y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br><span><var>C0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C0)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span>map f x ‚äó y = map (map_fst f) (x ‚äó y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map strength_arrow ‚àò map (map_fst f)) (x ‚äó y)
‚ßÜ (w, a) =
(map (compose (map_fst f)) ‚àò map strength_arrow)
  (x ‚äó y) ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk45"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> (fun_map_map (F:= BatchM)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br><span><var>C0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C0)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span>map f x ‚äó y = map (map_fst f) (x ‚äó y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (strength_arrow ‚àò map_fst f) (x ‚äó y) ‚ßÜ (w, a) =
map (compose (map_fst f) ‚àò strength_arrow) (x ‚äó y)
‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk46"><span class="kp">do</span> <span class="mi">2</span> fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br><span><var>C0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C0)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span>map f x ‚äó y = map (map_fst f) (x ‚äó y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">strength_arrow ‚àò map_fst f =
compose (map_fst f) ‚àò strength_arrow</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> ext [? ?].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk47"><span class="kn">Lemma</span> <span class="nf">app_mult_natural_BatchM2</span>: <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">D</span>: <span class="kt">Type</span>) (<span class="nv">g</span>: B -&gt; D) (<span class="nv">x</span>: BatchM A) (<span class="nv">y</span>: BatchM B),
      x ‚äó map (F:= BatchM) g y = map (F:= BatchM) (map_snd g) (x ‚äó y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : B -&gt; D) (<span class="nv">x</span> : BatchM A)
  (<span class="nv">y</span> : BatchM B),
x ‚äó map g y = map (map_snd g) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk48"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : B -&gt; D) (<span class="nv">x</span> : BatchM A)
  (<span class="nv">y</span> : BatchM B),
x ‚äó map g y = map (map_snd g) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk49"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B0 -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ‚äó map g y = map (map_snd g) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk4a"><span class="nb">generalize dependent</span> D.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : B0 -&gt; D),
x ‚äó map g y = map (map_snd g) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk4b"><span class="nb">induction</span> y <span class="kr">as</span> [ANY any | ANY k rest IH [w a]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>any</var><span class="hyp-type"><b>: </b><span>ANY</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : ANY -&gt; D),
x ‚äó map g (Go any) = map (map_snd g) (x ‚äó Go any)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="batch-v-chk4c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : (T k B -&gt; ANY) -&gt; D),
x ‚äó map g rest = map (map_snd g) (x ‚äó rest)</span></span></span><br></div><label class="goal-separator" for="batch-v-chk4c"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : ANY -&gt; D),
x ‚äó map g (rest ‚ßÜ (w, a)) =
map (map_snd g) (x ‚äó (rest ‚ßÜ (w, a)))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk4d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>any</var><span class="hyp-type"><b>: </b><span>ANY</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : ANY -&gt; D),
x ‚äó map g (Go any) = map (map_snd g) (x ‚äó Go any)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk4e"><span class="nb">intros</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>any</var><span class="hyp-type"><b>: </b><span>ANY</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>ANY -&gt; D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> <span class="nv">c</span> : A0 =&gt; (c, g any)) x =
map (map_snd g) (map (<span class="kr">fun</span> <span class="nv">c</span> : A0 =&gt; (c, any)) x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk4f">compose near x on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>any</var><span class="hyp-type"><b>: </b><span>ANY</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>ANY -&gt; D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> <span class="nv">c</span> : A0 =&gt; (c, g any)) x =
(map (map_snd g) ‚àò map (<span class="kr">fun</span> <span class="nv">c</span> : A0 =&gt; (c, any))) x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (fun_map_map (F:= BatchM)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk50">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : (T k B -&gt; ANY) -&gt; D),
x ‚äó map g rest = map (map_snd g) (x ‚äó rest)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : ANY -&gt; D),
x ‚äó map g (rest ‚ßÜ (w, a)) =
map (map_snd g) (x ‚äó (rest ‚ßÜ (w, a)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk51"><span class="nb">intros</span>; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : (T k B -&gt; ANY) -&gt; D),
x ‚äó map g rest = map (map_snd g) (x ‚äó rest)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>ANY -&gt; D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map strength_arrow
  (mult_BatchM x (map (compose g) rest)) ‚ßÜ (w, a) =
map (compose (map_snd g))
  (map strength_arrow (mult_BatchM x rest)) ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk52">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : (T k B -&gt; ANY) -&gt; D),
x ‚äó map g rest = map (map_snd g) (x ‚äó rest)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>ANY -&gt; D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map strength_arrow
  (mult_BatchM x (map (compose g) rest)) =
map (compose (map_snd g))
  (map strength_arrow (mult_BatchM x rest))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk53"><span class="nb">change</span> (mult_BatchM <span class="nl">?jx</span> <span class="nl">?jy</span>) <span class="kr">with</span> (jx ‚äó jy).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : (T k B -&gt; ANY) -&gt; D),
x ‚äó map g rest = map (map_snd g) (x ‚äó rest)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>ANY -&gt; D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map strength_arrow (x ‚äó map (compose g) rest) =
map (compose (map_snd g))
  (map strength_arrow (x ‚äó rest))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk54"><span class="nb">rewrite</span> IH.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : (T k B -&gt; ANY) -&gt; D),
x ‚äó map g rest = map (map_snd g) (x ‚äó rest)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>ANY -&gt; D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map strength_arrow
  (map (map_snd (compose g)) (x ‚äó rest)) =
map (compose (map_snd g))
  (map strength_arrow (x ‚äó rest))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk55">compose near (x ‚äó rest).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : (T k B -&gt; ANY) -&gt; D),
x ‚äó map g rest = map (map_snd g) (x ‚äó rest)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>ANY -&gt; D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map strength_arrow ‚àò map (map_snd (compose g)))
  (x ‚äó rest) =
(map (compose (map_snd g)) ‚àò map strength_arrow)
  (x ‚äó rest)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk56"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> (fun_map_map (F:= BatchM)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : (T k B -&gt; ANY) -&gt; D),
x ‚äó map g rest = map (map_snd g) (x ‚äó rest)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>ANY -&gt; D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (strength_arrow ‚àò map_snd (compose g)) (x ‚äó rest) =
map (compose (map_snd g) ‚àò strength_arrow) (x ‚äó rest)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk57">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : (T k B -&gt; ANY) -&gt; D),
x ‚äó map g rest = map (map_snd g) (x ‚äó rest)</span></span></span><br><span><var>D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>ANY -&gt; D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">strength_arrow ‚àò map_snd (compose g) =
compose (map_snd g) ‚àò strength_arrow</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> ext [a&#39; mk].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk58"><span class="kn">Lemma</span> <span class="nf">app_mult_natural_BatchM</span>: <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> <span class="nv">D</span>: <span class="kt">Type</span>) (<span class="nv">f</span>: A -&gt; C) (<span class="nv">g</span>: B -&gt; D) (<span class="nv">x</span>: BatchM A) (<span class="nv">y</span>: BatchM B),
      map (F:= BatchM) f x ‚äó map (F:= BatchM) g y = map (F:= BatchM) (map_tensor f g) (x ‚äó y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; C) (<span class="nv">g</span> : B -&gt; D)
  (<span class="nv">x</span> : BatchM A) (<span class="nv">y</span> : BatchM B),
map f x ‚äó map g y = map (map_tensor f g) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk59"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; C) (<span class="nv">g</span> : B -&gt; D)
  (<span class="nv">x</span> : BatchM A) (<span class="nv">y</span> : BatchM B),
map f x ‚äó map g y = map (map_tensor f g) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk5a"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A0 -&gt; C</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B0 -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f x ‚äó map g y = map (map_tensor f g) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk5b"><span class="nb">rewrite</span> app_mult_natural_BatchM1, app_mult_natural_BatchM2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A0 -&gt; C</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B0 -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (map_fst f) (map (map_snd g) (x ‚äó y)) =
map (map_tensor f g) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk5c">compose near (x ‚äó y) on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A0 -&gt; C</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B0 -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map (map_fst f) ‚àò map (map_snd g)) (x ‚äó y) =
map (map_tensor f g) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk5d"><span class="nb">rewrite</span> (fun_map_map (F:= BatchM)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A0 -&gt; C</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B0 -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (map_fst f ‚àò map_snd g) (x ‚äó y) =
map (map_tensor f g) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk5e">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A0 -&gt; C</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B0 -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map_fst f ‚àò map_snd g = map_tensor f g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> ext [a b].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk5f"><span class="kn">Lemma</span> <span class="nf">app_assoc_BatchM</span>: <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span>: <span class="kt">Type</span>) (<span class="nv">x</span>: BatchM A) (<span class="nv">y</span>: BatchM B) (<span class="nv">z</span>: BatchM C),
      map (F:= BatchM) associator ((x ‚äó y) ‚äó z) = x ‚äó (y ‚äó z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">x</span> : BatchM A) (<span class="nv">y</span> : BatchM B)
  (<span class="nv">z</span> : BatchM C),
map associator (x ‚äó y ‚äó z) = x ‚äó (y ‚äó z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk60"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">x</span> : BatchM A) (<span class="nv">y</span> : BatchM B)
  (<span class="nv">z</span> : BatchM C),
map associator (x ‚äó y ‚äó z) = x ‚äó (y ‚äó z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk61"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map associator (x ‚äó y ‚äó z) = x ‚äó (y ‚äó z)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk62"><span class="nb">induction</span> z <span class="kr">as</span> [ANY any | ANY k rest IH [w a]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>any</var><span class="hyp-type"><b>: </b><span>ANY</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map associator (x ‚äó y ‚äó Go any) = x ‚äó (y ‚äó Go any)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="batch-v-chk63" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map associator (x ‚äó y ‚äó rest) = x ‚äó (y ‚äó rest)</span></span></span><br></div><label class="goal-separator" for="batch-v-chk63"><hr></label><div class="goal-conclusion">map associator (x ‚äó y ‚äó (rest ‚ßÜ (w, a))) =
x ‚äó (y ‚äó (rest ‚ßÜ (w, a)))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk64">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>any</var><span class="hyp-type"><b>: </b><span>ANY</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map associator (x ‚äó y ‚äó Go any) = x ‚äó (y ‚äó Go any)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk65"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> mult_BatchM_rw2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>any</var><span class="hyp-type"><b>: </b><span>ANY</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map associator (map (pair_right any) (x ‚äó y)) =
x ‚äó map (pair_right any) y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk66"><span class="nb">rewrite</span> (app_mult_natural_BatchM2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>any</var><span class="hyp-type"><b>: </b><span>ANY</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map associator (map (pair_right any) (x ‚äó y)) =
map (map_snd (pair_right any)) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk67">compose near (x ‚äó y) on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>any</var><span class="hyp-type"><b>: </b><span>ANY</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map associator ‚àò map (pair_right any)) (x ‚äó y) =
map (map_snd (pair_right any)) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (fun_map_map (F:= BatchM)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk68">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map associator (x ‚äó y ‚äó rest) = x ‚äó (y ‚äó rest)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map associator (x ‚äó y ‚äó (rest ‚ßÜ (w, a))) =
x ‚äó (y ‚äó (rest ‚ßÜ (w, a)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk69"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map associator (x ‚äó y ‚äó rest) = x ‚äó (y ‚äó rest)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose associator)
  (map strength_arrow
     (mult_BatchM (mult_BatchM x y) rest)) ‚ßÜ (w, a) =
map strength_arrow
  (mult_BatchM x
     (map strength_arrow (mult_BatchM y rest)))
‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk6a"><span class="kp">repeat</span> <span class="nb">change</span> (mult_BatchM <span class="nl">?jx</span> <span class="nl">?jy</span>) <span class="kr">with</span> (jx ‚äó jy).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map associator (x ‚äó y ‚äó rest) = x ‚äó (y ‚äó rest)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose associator)
  (map strength_arrow (x ‚äó y ‚äó rest)) ‚ßÜ (w, a) =
map strength_arrow (x ‚äó map strength_arrow (y ‚äó rest))
‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk6b">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map associator (x ‚äó y ‚äó rest) = x ‚äó (y ‚äó rest)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose associator)
  (map strength_arrow (x ‚äó y ‚äó rest)) =
map strength_arrow (x ‚äó map strength_arrow (y ‚äó rest))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk6c"><span class="nb">rewrite</span> (app_mult_natural_BatchM2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map associator (x ‚äó y ‚äó rest) = x ‚äó (y ‚äó rest)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose associator)
  (map strength_arrow (x ‚äó y ‚äó rest)) =
map strength_arrow
  (map (map_snd strength_arrow) (x ‚äó (y ‚äó rest)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk6d"><span class="nb">rewrite</span> &lt;- IH.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map associator (x ‚äó y ‚äó rest) = x ‚äó (y ‚äó rest)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose associator)
  (map strength_arrow (x ‚äó y ‚äó rest)) =
map strength_arrow
  (map (map_snd strength_arrow)
     (map associator (x ‚äó y ‚äó rest)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk6e">compose near (x ‚äó y ‚äó rest).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map associator (x ‚äó y ‚äó rest) = x ‚äó (y ‚äó rest)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map (compose associator) ‚àò map strength_arrow)
  (x ‚äó y ‚äó rest) =
map strength_arrow
  ((map (map_snd strength_arrow) ‚àò map associator)
     (x ‚äó y ‚äó rest))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk6f"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> (fun_map_map (F:= BatchM)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map associator (x ‚äó y ‚äó rest) = x ‚äó (y ‚äó rest)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose associator ‚àò strength_arrow)
  (x ‚äó y ‚äó rest) =
map strength_arrow
  (map (map_snd strength_arrow ‚àò associator)
     (x ‚äó y ‚äó rest))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk70">compose near (x ‚äó y ‚äó rest) on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map associator (x ‚äó y ‚äó rest) = x ‚äó (y ‚äó rest)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose associator ‚àò strength_arrow)
  (x ‚äó y ‚äó rest) =
(map strength_arrow
 ‚àò map (map_snd strength_arrow ‚àò associator))
  (x ‚äó y ‚äó rest)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk71"><span class="nb">rewrite</span> (fun_map_map (F:= BatchM)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map associator (x ‚äó y ‚äó rest) = x ‚äó (y ‚äó rest)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose associator ‚àò strength_arrow)
  (x ‚äó y ‚äó rest) =
map
  (strength_arrow
   ‚àò (map_snd strength_arrow ‚àò associator))
  (x ‚äó y ‚äó rest)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk72">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map associator (x ‚äó y ‚äó rest) = x ‚äó (y ‚äó rest)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">compose associator ‚àò strength_arrow =
strength_arrow ‚àò (map_snd strength_arrow ‚àò associator)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> ext [[? ?] ?].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk73"><span class="kn">Lemma</span> <span class="nf">app_unital_l_BatchM</span>: <span class="kr">forall</span> (<span class="nv">A</span>: <span class="kt">Type</span>) (<span class="nv">x</span>: BatchM A),
      map (F:= BatchM) left_unitor (pure (F:= BatchM) tt ‚äó x) = x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> : BatchM A),
map left_unitor (pure tt ‚äó x) = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk74"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> : BatchM A),
map left_unitor (pure tt ‚äó x) = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk75"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map left_unitor (pure tt ‚äó x) = x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk76"><span class="nb">induction</span> x <span class="kr">as</span> [ANY any | ANY k rest IH [w a]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>any</var><span class="hyp-type"><b>: </b><span>ANY</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map left_unitor (pure tt ‚äó Go any) = Go any</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="batch-v-chk77" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map left_unitor (pure tt ‚äó rest) = rest</span></span></span><br></div><label class="goal-separator" for="batch-v-chk77"><hr></label><div class="goal-conclusion">map left_unitor (pure tt ‚äó (rest ‚ßÜ (w, a))) =
rest ‚ßÜ (w, a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk78">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>any</var><span class="hyp-type"><b>: </b><span>ANY</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map left_unitor (pure tt ‚äó Go any) = Go any</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk79">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map left_unitor (pure tt ‚äó rest) = rest</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map left_unitor (pure tt ‚äó (rest ‚ßÜ (w, a))) =
rest ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk7a"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map left_unitor (pure tt ‚äó rest) = rest</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose left_unitor)
  (map strength_arrow (mult_BatchM (pure tt) rest))
‚ßÜ (w, a) = rest ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk7b"><span class="nb">change</span> (mult_BatchM <span class="nl">?jx</span> <span class="nl">?jy</span>) <span class="kr">with</span> (jx ‚äó jy).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map left_unitor (pure tt ‚äó rest) = rest</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose left_unitor)
  (map strength_arrow (pure tt ‚äó rest)) ‚ßÜ (w, a) =
rest ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk7c">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map left_unitor (pure tt ‚äó rest) = rest</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose left_unitor)
  (map strength_arrow (pure tt ‚äó rest)) = rest</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk7d">compose near (pure (F:= BatchM) tt ‚äó rest).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map left_unitor (pure tt ‚äó rest) = rest</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map (compose left_unitor) ‚àò map strength_arrow)
  (pure tt ‚äó rest) = rest</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk7e"><span class="nb">rewrite</span> (fun_map_map (F:= BatchM)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map left_unitor (pure tt ‚äó rest) = rest</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose left_unitor ‚àò strength_arrow)
  (pure tt ‚äó rest) = rest</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk7f"><span class="nb">rewrite</span> &lt;- IH.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map left_unitor (pure tt ‚äó rest) = rest</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose left_unitor ‚àò strength_arrow)
  (pure tt ‚äó map left_unitor (pure tt ‚äó rest)) =
map left_unitor (pure tt ‚äó rest)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk80"><span class="kp">repeat</span> fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map left_unitor (pure tt ‚äó rest) = rest</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map left_unitor (pure tt ‚äó rest) = rest</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk81"><span class="kn">Lemma</span> <span class="nf">app_unital_r_BatchM</span>: <span class="kr">forall</span> (<span class="nv">A</span>: <span class="kt">Type</span>) (<span class="nv">x</span>: BatchM A),
      map (F:= BatchM) right_unitor (x ‚äó pure (F:= BatchM) tt) = x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> : BatchM A),
map right_unitor (x ‚äó pure tt) = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk82"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> : BatchM A),
map right_unitor (x ‚äó pure tt) = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk83"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map right_unitor (x ‚äó pure tt) = x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk84"><span class="nb">induction</span> x <span class="kr">as</span> [ANY any | ANY k rest IH [w a]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>any</var><span class="hyp-type"><b>: </b><span>ANY</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map right_unitor (Go any ‚äó pure tt) = Go any</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="batch-v-chk85" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map right_unitor (rest ‚äó pure tt) = rest</span></span></span><br></div><label class="goal-separator" for="batch-v-chk85"><hr></label><div class="goal-conclusion">map right_unitor ((rest ‚ßÜ (w, a)) ‚äó pure tt) =
rest ‚ßÜ (w, a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk86">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>any</var><span class="hyp-type"><b>: </b><span>ANY</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map right_unitor (Go any ‚äó pure tt) = Go any</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk87">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map right_unitor (rest ‚äó pure tt) = rest</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map right_unitor ((rest ‚ßÜ (w, a)) ‚äó pure tt) =
rest ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk88"><span class="nb">cbn</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map right_unitor
  (map (<span class="kr">fun</span> <span class="nv">c</span> : T k B -&gt; ANY =&gt; (c, tt)) rest) =
rest</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose right_unitor)
  (map (compose (<span class="kr">fun</span> <span class="nv">c</span> : ANY =&gt; (c, tt))) rest)
‚ßÜ (w, a) = rest ‚ßÜ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk89">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map right_unitor
  (map (<span class="kr">fun</span> <span class="nv">c</span> : T k B -&gt; ANY =&gt; (c, tt)) rest) =
rest</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose right_unitor)
  (map (compose (<span class="kr">fun</span> <span class="nv">c</span> : ANY =&gt; (c, tt))) rest) = rest</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk8a"><span class="nb">rewrite</span> &lt;- IH <span class="nb">at</span> <span class="mi">2</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map right_unitor
  (map (<span class="kr">fun</span> <span class="nv">c</span> : T k B -&gt; ANY =&gt; (c, tt)) rest) =
rest</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose right_unitor)
  (map (compose (<span class="kr">fun</span> <span class="nv">c</span> : ANY =&gt; (c, tt))) rest) =
map right_unitor
  (map (<span class="kr">fun</span> <span class="nv">c</span> : T k B -&gt; ANY =&gt; (c, tt)) rest)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk8b">compose near rest.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, ANY</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; ANY)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>map right_unitor
  (map (<span class="kr">fun</span> <span class="nv">c</span> : T k B -&gt; ANY =&gt; (c, tt)) rest) =
rest</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map (compose right_unitor)
 ‚àò map (compose (<span class="kr">fun</span> <span class="nv">c</span> : ANY =&gt; (c, tt)))) rest =
(map right_unitor
 ‚àò map (<span class="kr">fun</span> <span class="nv">c</span> : T k B -&gt; ANY =&gt; (c, tt))) rest</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> (fun_map_map (F:= BatchM)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk8c"><span class="kn">Lemma</span> <span class="nf">app_mult_pure_BatchM</span>: <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span>: <span class="kt">Type</span>) (<span class="nv">a</span>: A) (<span class="nv">b</span>: B),
      pure (F:= BatchM) a ‚äó pure (F:= BatchM) b = pure (F:= BatchM) (a, b).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">a</span> : A) (<span class="nv">b</span> : B),
pure a ‚äó pure b = pure (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk8d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">a</span> : A) (<span class="nv">b</span> : B),
pure a ‚äó pure b = pure (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk8e"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A0</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pure a ‚äó pure b = pure (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>, program] <span class="kn">Instance</span> <span class="nf">App_Path</span>: Applicative BatchM.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk8f"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A0 -&gt; C</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B0 -&gt; D</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f x ‚äó map g y = map (map_tensor f g) (x ‚äó y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> app_mult_natural_BatchM.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk90"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0, B0, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map associator (x ‚äó y ‚äó z) = x ‚äó (y ‚äó z)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> app_assoc_BatchM.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk91"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map left_unitor (pure tt ‚äó x) = x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> app_unital_l_BatchM.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk92"><span class="kn">Next Obligation</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ix</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W, A, B, A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map right_unitor (x ‚äó pure tt) = x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> app_unital_r_BatchM.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">BatchM</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> Ap {ix} {T}%function_scope {W A B}%type_scope [C]%type_scope {k} _ _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Infix</span> <span class="s2">&quot;‚ßÜ&quot;</span>:= Ap (<span class="kn">at level</span> <span class="mi">51</span>, <span class="kn">left associativity</span>): tealeaves_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** *** Examples of operations *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">demo</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    `{Index}
    (W: <span class="kt">Type</span>)
    (S: <span class="kt">Type</span> -&gt; <span class="kt">Type</span>)
    `{T: K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span>}
    (A B C X: <span class="kt">Type</span>)
    (a1 a2: A) (b1 b2 b3: B)
    (w1 w2 w3 w4: W)
    (c1 c2 c3 c4: C)
    (mk1: C -&gt; X) (mk2: C -&gt; C -&gt; X) (mk0: X).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="c">(*</span>
<span class="c">  Check Go a1 ‚äó Go a2: @BatchM _ T W False False (A * A).</span>
<span class="c">  Compute Go a1 ‚äó Go a2.</span>
<span class="c">  Compute Go a1 ‚äó (Go mk1 ‚ßÜ (w1, c1)).</span>
<span class="c">  Compute (Go mk1 ‚ßÜ (w1, c1)) ‚äó (Go mk1 ‚ßÜ (w2, c2)).</span>
<span class="c">  Compute (Go mk2 ‚ßÜ (w1, c1) ‚ßÜ (w2, c2)) ‚äó (Go mk1 ‚ßÜ (w3, c3)).</span>
<span class="c">   *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">demo</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Functoriality of [BatchM] *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">mapfst_BatchM</span>
  `{ix: Index}
  {W: <span class="kt">Type</span>}
  {T: K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span>}
  {A1 A2 B C} (f: A1 -&gt; A2)
  (j: @BatchM ix T W A1 B C):
  @BatchM ix T W A2 B C :=
  <span class="kr">match</span> j <span class="kr">with</span>
  | Go a =&gt; Go a
  | Ap rest p =&gt; Ap (mapfst_BatchM f rest) (map_snd f p)
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * The &lt;&lt;runBatchM&gt;&gt; operation *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">runBatchM</span>
  {<span class="nv">ix</span>: Index}
  {<span class="nv">T</span>: K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span>}
  {<span class="nv">W</span> <span class="nv">A</span> <span class="nv">B</span>: <span class="kt">Type</span>} {<span class="nv">F</span>: <span class="kt">Type</span> -&gt; <span class="kt">Type</span>}
  `{Map F} `{Mult F} `{Pure F}
  (œï: <span class="kr">forall</span> (<span class="nv">k</span>: K), W * A -&gt; F (T k B))
  `(j: @BatchM ix T W A B C): F C :=
  <span class="kr">match</span> j <span class="kr">with</span>
  | Go a =&gt; pure a
  | @Ap _ _ _ _ _ _ k rest (pair w a) =&gt;
      runBatchM œï rest &lt;‚ãÜ&gt; œï k (w, a)
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">runBatchM_rw</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    `{Index}
    `{Applicative G}
    {A B C: <span class="kt">Type</span>}
    `(f: <span class="kr">forall</span> (<span class="nv">k</span>: K), W * A -&gt; G (T k B)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk93"><span class="kn">Lemma</span> <span class="nf">runBatchM_rw1</span> (<span class="nv">c</span>: C):
    runBatchM f (Go c) = pure c.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>A, B, C, W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (Go c) = pure c</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk94"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>A, B, C, W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (Go c) = pure c</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk95"><span class="kn">Lemma</span> <span class="nf">runBatchM_rw2</span> (<span class="nv">k</span>: K) (<span class="nv">w</span>: W) (<span class="nv">a</span>: A) (<span class="nv">rest</span>: BatchM (T k B -&gt; C)):
    runBatchM f (rest ‚ßÜ (w, a)) = runBatchM f rest &lt;‚ãÜ&gt; f k (w, a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>A, B, C, W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (rest ‚ßÜ (w, a)) =
runBatchM f rest &lt;‚ãÜ&gt; f k (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk96"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>A, B, C, W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>rest</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (rest ‚ßÜ (w, a)) =
runBatchM f rest &lt;‚ãÜ&gt; f k (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">runBatchM_rw</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Naturality of of &lt;&lt;runBatchM&gt;&gt; *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">runBatchM_naturality</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    `{Index}
    (W: <span class="kt">Type</span>)
    (S: <span class="kt">Type</span> -&gt; <span class="kt">Type</span>)
    `{T: K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span>}
    (A B C D: <span class="kt">Type</span>)
    `{Applicative G}
    (œï: <span class="kr">forall</span> <span class="nv">k</span>, W * A -&gt; G (T k B)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk97"><span class="kn">Lemma</span> <span class="nf">natural_runBatchM</span> (<span class="nv">f</span>: C -&gt; D) (<span class="nv">j</span>: @BatchM _ T W A B C):
    map (F := G) f (runBatchM œï j) = runBatchM œï (map (F := BatchM) f j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>œï</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f (runBatchM œï j) = runBatchM œï (map f j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk98"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>œï</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f (runBatchM œï j) = runBatchM œï (map f j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk99"><span class="nb">generalize dependent</span> D.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>œï</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : C -&gt; D),
map f (runBatchM œï j) = runBatchM œï (map f j)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk9a"><span class="nb">induction</span> j; <span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>œï</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>D0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f (runBatchM œï (Go c)) =
runBatchM œï (map f (Go c))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="batch-v-chk9b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>œï</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHj</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : (T k B -&gt; C) -&gt; D),
map f (runBatchM œï j) = runBatchM œï (map f j)</span></span></span><br><span><var>D0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D0</span></span></span><br></div><label class="goal-separator" for="batch-v-chk9b"><hr></label><div class="goal-conclusion">map f (runBatchM œï (j ‚ßÜ p)) =
runBatchM œï (map f (j ‚ßÜ p))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk9c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>œï</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>D0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f (runBatchM œï (Go c)) =
runBatchM œï (map f (Go c))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk9d"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>œï</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>D0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f (pure c) = pure (f c)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (app_pure_natural).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk9e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>œï</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHj</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : (T k B -&gt; C) -&gt; D),
map f (runBatchM œï j) = runBatchM œï (map f j)</span></span></span><br><span><var>D0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f (runBatchM œï (j ‚ßÜ p)) =
runBatchM œï (map f (j ‚ßÜ p))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chk9f"><span class="nb">destruct</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>œï</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHj</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : (T k B -&gt; C) -&gt; D),
map f (runBatchM œï j) = runBatchM œï (map f j)</span></span></span><br><span><var>D0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f (runBatchM œï (j ‚ßÜ (w, a))) =
runBatchM œï (map f (j ‚ßÜ (w, a)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chka0"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>œï</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHj</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : (T k B -&gt; C) -&gt; D),
map f (runBatchM œï j) = runBatchM œï (map f j)</span></span></span><br><span><var>D0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f (runBatchM œï j &lt;‚ãÜ&gt; œï k (w, a)) =
runBatchM œï (map (compose f) j) &lt;‚ãÜ&gt; œï k (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chka1"><span class="nb">rewrite</span> map_ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>œï</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHj</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : (T k B -&gt; C) -&gt; D),
map f (runBatchM œï j) = runBatchM œï (map f j)</span></span></span><br><span><var>D0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose f) (runBatchM œï j) &lt;‚ãÜ&gt; œï k (w, a) =
runBatchM œï (map (compose f) j) &lt;‚ãÜ&gt; œï k (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chka2">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>œï</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHj</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : (T k B -&gt; C) -&gt; D),
map f (runBatchM œï j) = runBatchM œï (map f j)</span></span></span><br><span><var>D0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>C -&gt; D0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (compose f) (runBatchM œï j) =
runBatchM œï (map (compose f) j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> IHj.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">runBatchM_naturality</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** &lt;&lt;runBatchM&gt;&gt; is an applicative morphism **)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">runBatchM_morphism</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    `{Index}
    (W: <span class="kt">Type</span>)
    (S: <span class="kt">Type</span> -&gt; <span class="kt">Type</span>)
    `{T: K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span>}
    (A B C D: <span class="kt">Type</span>)
    `{Applicative G}
    (f: <span class="kr">forall</span> <span class="nv">k</span>, W * A -&gt; G (T k B)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chka3"><span class="kn">Lemma</span> <span class="nf">appmor_pure_runBatchM</span>: <span class="kr">forall</span> (<span class="nv">C</span>: <span class="kt">Type</span>) (<span class="nv">c</span>: C),
      runBatchM f (pure (F := BatchM) c) = pure c.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">c</span> : C),
runBatchM f (pure c) = pure c</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chka4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">c</span> : C),
runBatchM f (pure c) = pure c</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chka5"><span class="kn">Lemma</span> <span class="nf">appmor_mult_runBatchM</span>: <span class="kr">forall</span> (<span class="nv">C</span> <span class="nv">D</span>: <span class="kt">Type</span>) (<span class="nv">x</span>: BatchM C) (<span class="nv">y</span>: BatchM D),
      runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">x</span> : BatchM C) (<span class="nv">y</span> : BatchM D),
runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chka6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">x</span> : BatchM C) (<span class="nv">y</span> : BatchM D),
runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chka7"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, D0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM D0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chka8"><span class="nb">generalize dependent</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, D0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM D0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : BatchM C0,
runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chka9"><span class="nb">induction</span> y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : BatchM C0,
runBatchM f (x ‚äó Go c) =
runBatchM f x ‚äó runBatchM f (Go c)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="batch-v-chkaa" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : BatchM C0, runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</span></span></span><br></div><label class="goal-separator" for="batch-v-chkaa"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : BatchM C0,
runBatchM f (x ‚äó (y ‚ßÜ p)) =
runBatchM f x ‚äó runBatchM f (y ‚ßÜ p)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkab">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : BatchM C0,
runBatchM f (x ‚äó Go c) =
runBatchM f x ‚äó runBatchM f (Go c)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkac"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C1</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (x ‚äó Go c) =
runBatchM f x ‚äó runBatchM f (Go c)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkad"><span class="nb">rewrite</span> mult_BatchM_rw2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C1</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (map (pair_right c) x) =
runBatchM f x ‚äó runBatchM f (Go c)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkae"><span class="nb">rewrite</span> runBatchM_rw1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C1</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (map (pair_right c) x) =
runBatchM f x ‚äó pure c</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkaf"><span class="nb">rewrite</span> triangle_4.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C1</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (map (pair_right c) x) =
map (<span class="kr">fun</span> <span class="nv">b</span> : C0 =&gt; (b, c)) (runBatchM f x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> natural_runBatchM; <span class="nb">auto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkb0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : BatchM C0, runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : BatchM C0,
runBatchM f (x ‚äó (y ‚ßÜ p)) =
runBatchM f x ‚äó runBatchM f (y ‚ßÜ p)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkb1"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : BatchM C0, runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (x ‚äó (y ‚ßÜ p)) =
runBatchM f x ‚äó runBatchM f (y ‚ßÜ p)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkb2"><span class="nb">destruct</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : BatchM C0, runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (x ‚äó (y ‚ßÜ (w, a))) =
runBatchM f x ‚äó runBatchM f (y ‚ßÜ (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkb3"><span class="nb">rewrite</span> runBatchM_rw2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : BatchM C0, runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (x ‚äó (y ‚ßÜ (w, a))) =
runBatchM f x ‚äó (runBatchM f y &lt;‚ãÜ&gt; f k (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkb4"><span class="nb">unfold</span> ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : BatchM C0, runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (x ‚äó (y ‚ßÜ (w, a))) =
runBatchM f x
‚äó map (<span class="kr">fun</span> &#39;(f, a) =&gt; f a)
    (runBatchM f y ‚äó f k (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkb5"><span class="nb">rewrite</span> (app_mult_natural_r G).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : BatchM C0, runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (x ‚äó (y ‚ßÜ (w, a))) =
map (map_snd (<span class="kr">fun</span> &#39;(f, a) =&gt; f a))
  (runBatchM f x ‚äó (runBatchM f y ‚äó f k (w, a)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkb6"><span class="nb">rewrite</span> &lt;- (app_assoc).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : BatchM C0, runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (x ‚äó (y ‚ßÜ (w, a))) =
map (map_snd (<span class="kr">fun</span> &#39;(f, a) =&gt; f a))
  (map associator
     (runBatchM f x ‚äó runBatchM f y ‚äó f k (w, a)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkb7"><span class="nb">rewrite</span> &lt;- IHy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHy</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : BatchM C0, runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (x ‚äó (y ‚ßÜ (w, a))) =
map (map_snd (<span class="kr">fun</span> &#39;(f, a) =&gt; f a))
  (map associator (runBatchM f (x ‚äó y) ‚äó f k (w, a)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkb8"><span class="nb">clear</span> IHy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (x ‚äó (y ‚ßÜ (w, a))) =
map (map_snd (<span class="kr">fun</span> &#39;(f, a) =&gt; f a))
  (map associator (runBatchM f (x ‚äó y) ‚äó f k (w, a)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkb9">compose near (runBatchM f (x ‚äó y) ‚äó f k (w, a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (x ‚äó (y ‚ßÜ (w, a))) =
(map (map_snd (<span class="kr">fun</span> &#39;(f, a) =&gt; f a)) ‚àò map associator)
  (runBatchM f (x ‚äó y) ‚äó f k (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkba"><span class="nb">rewrite</span> (fun_map_map).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (x ‚äó (y ‚ßÜ (w, a))) =
map (map_snd (<span class="kr">fun</span> &#39;(f, a) =&gt; f a) ‚àò associator)
  (runBatchM f (x ‚äó y) ‚äó f k (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkbb"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (map strength_arrow (mult_BatchM x y)) &lt;‚ãÜ&gt;
f k (w, a) =
map (map_snd (<span class="kr">fun</span> &#39;(f, a) =&gt; f a) ‚àò associator)
  (runBatchM f (mult_BatchM x y) ‚äó f k (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkbc"><span class="nb">unfold</span> ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> &#39;(f, a) =&gt; f a)
  (runBatchM f (map strength_arrow (mult_BatchM x y))
   ‚äó f k (w, a)) =
map (map_snd (<span class="kr">fun</span> &#39;(f, a) =&gt; f a) ‚àò associator)
  (runBatchM f (mult_BatchM x y) ‚äó f k (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkbd"><span class="nb">change</span> (mult_BatchM <span class="nl">?jx</span> <span class="nl">?jy</span>) <span class="kr">with</span> (jx ‚äó jy).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> &#39;(f, a) =&gt; f a)
  (runBatchM f (map strength_arrow (x ‚äó y))
   ‚äó f k (w, a)) =
map (map_snd (<span class="kr">fun</span> &#39;(f, a) =&gt; f a) ‚àò associator)
  (runBatchM f (x ‚äó y) ‚äó f k (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkbe"><span class="nb">rewrite</span> &lt;- natural_runBatchM; <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> &#39;(f, a) =&gt; f a)
  (map strength_arrow (runBatchM f (x ‚äó y))
   ‚äó f k (w, a)) =
map (map_snd (<span class="kr">fun</span> &#39;(f, a) =&gt; f a) ‚àò associator)
  (runBatchM f (x ‚äó y) ‚äó f k (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkbf"><span class="nb">rewrite</span> (app_mult_natural_l G).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> &#39;(f, a) =&gt; f a)
  (map (map_fst strength_arrow)
     (runBatchM f (x ‚äó y) ‚äó f k (w, a))) =
map (map_snd (<span class="kr">fun</span> &#39;(f, a) =&gt; f a) ‚àò associator)
  (runBatchM f (x ‚äó y) ‚äó f k (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkc0">compose near (runBatchM f (x ‚äó y) ‚äó f k (w, a)) on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map (<span class="kr">fun</span> &#39;(f, a) =&gt; f a)
 ‚àò map (map_fst strength_arrow))
  (runBatchM f (x ‚äó y) ‚äó f k (w, a)) =
map (map_snd (<span class="kr">fun</span> &#39;(f, a) =&gt; f a) ‚àò associator)
  (runBatchM f (x ‚äó y) ‚äó f k (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkc1"><span class="nb">rewrite</span> (fun_map_map).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map ((<span class="kr">fun</span> &#39;(f, a) =&gt; f a) ‚àò map_fst strength_arrow)
  (runBatchM f (x ‚äó y) ‚äó f k (w, a)) =
map (map_snd (<span class="kr">fun</span> &#39;(f, a) =&gt; f a) ‚àò associator)
  (runBatchM f (x ‚äó y) ‚äó f k (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkc2">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>C0, C1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C1)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM C0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> &#39;(f, a) =&gt; f a) ‚àò map_fst strength_arrow =
map_snd (<span class="kr">fun</span> &#39;(f, a) =&gt; f a) ‚àò associator</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> ext [[? ?] ?].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkc3">#[<span class="kn">global</span>] <span class="kn">Instance</span> <span class="nf">Morphism_store_fold</span>:
    ApplicativeMorphism BatchM G
      (@runBatchM _ T W A B G _ _ _ f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ApplicativeMorphism BatchM G
  (@runBatchM H T W A B G H0 H2 H1 f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkc4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ApplicativeMorphism BatchM G
  (@runBatchM H T W A B G H0 H2 H1 f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkc5"><span class="nb">constructor</span>; <span class="kp">try</span> <span class="nb">typeclasses eauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A0</span> <span class="nv">B0</span> : <span class="kt">Type</span>) (<span class="nv">f0</span> : A0 -&gt; B0) (<span class="nv">x</span> : BatchM A0),
runBatchM f (map f0 x) = map f0 (runBatchM f x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="batch-v-chkc6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br></div><label class="goal-separator" for="batch-v-chkc6"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A0</span> : <span class="kt">Type</span>) (<span class="nv">a</span> : A0),
runBatchM f (pure a) = pure a</div></blockquote><input class="alectryon-extra-goal-toggle" id="batch-v-chkc7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br></div><label class="goal-separator" for="batch-v-chkc7"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A0</span> <span class="nv">B0</span> : <span class="kt">Type</span>) (<span class="nv">x</span> : BatchM A0) (<span class="nv">y</span> : BatchM B0),
runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkc8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A0</span> <span class="nv">B0</span> : <span class="kt">Type</span>) (<span class="nv">f0</span> : A0 -&gt; B0) (<span class="nv">x</span> : BatchM A0),
runBatchM f (map f0 x) = map f0 (runBatchM f x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkc9"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f0</var><span class="hyp-type"><b>: </b><span>A0 -&gt; B0</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (map f0 x) = map f0 (runBatchM f x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> natural_runBatchM.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkca">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A0</span> : <span class="kt">Type</span>) (<span class="nv">a</span> : A0),
runBatchM f (pure a) = pure a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkcb"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>A0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (pure a) = pure a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkcc">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A0</span> <span class="nv">B0</span> : <span class="kt">Type</span>) (<span class="nv">x</span> : BatchM A0) (<span class="nv">y</span> : BatchM B0),
runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkcd"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G (T k B)</span></span></span><br><span><var>A0, B0</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>BatchM A0</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>BatchM B0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">runBatchM f (x ‚äó y) = runBatchM f x ‚äó runBatchM f y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> appmor_mult_runBatchM.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">runBatchM_morphism</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** &lt;&lt;runBatchM&gt;&gt; commutes with applicative morphisms **)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">runBatchM_morphism</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">

</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Generalizable All Variables</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>

    `{Index}
    (W: <span class="kt">Type</span>)
    (S: <span class="kt">Type</span> -&gt; <span class="kt">Type</span>)
    `{T: K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span>}
    (A B C D: <span class="kt">Type</span>)
    `{Applicative G1}
    `{Applicative G2}
    `{! ApplicativeMorphism G1 G2 œà}
    (f: <span class="kr">forall</span> <span class="nv">k</span>, W * A -&gt; G1 (T k B)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkce"><span class="kn">Lemma</span> <span class="nf">runBatchM_morphism</span> `(j: @BatchM _ T W A B C):
    @œà C (runBatchM f j) = runBatchM (<span class="kr">fun</span> <span class="nv">k</span> =&gt; @œà (T k B) ‚àò f k) j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G1</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G1</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G1</span></span></span><br><span><var>G2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Map G2</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>Pure G2</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>Mult G2</span></span></span><br><span><var>H7</var><span class="hyp-type"><b>: </b><span>Applicative G2</span></span></span><br><span><var>œà</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, G1 A -&gt; G2 A</span></span></span><br><span><var>ApplicativeMorphism0</var><span class="hyp-type"><b>: </b><span>ApplicativeMorphism G1 G2 œà</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G1 (T k B)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">œà (runBatchM f j) =
runBatchM (<span class="kr">fun</span> <span class="nv">k</span> : K =&gt; œà (A:=T k B) ‚àò f k) j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkcf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G1</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G1</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G1</span></span></span><br><span><var>G2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Map G2</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>Pure G2</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>Mult G2</span></span></span><br><span><var>H7</var><span class="hyp-type"><b>: </b><span>Applicative G2</span></span></span><br><span><var>œà</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, G1 A -&gt; G2 A</span></span></span><br><span><var>ApplicativeMorphism0</var><span class="hyp-type"><b>: </b><span>ApplicativeMorphism G1 G2 œà</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G1 (T k B)</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">œà (runBatchM f j) =
runBatchM (<span class="kr">fun</span> <span class="nv">k</span> : K =&gt; œà (A:=T k B) ‚àò f k) j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkd0"><span class="nb">induction</span> j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G1</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G1</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G1</span></span></span><br><span><var>G2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Map G2</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>Pure G2</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>Mult G2</span></span></span><br><span><var>H7</var><span class="hyp-type"><b>: </b><span>Applicative G2</span></span></span><br><span><var>œà</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, G1 A -&gt; G2 A</span></span></span><br><span><var>ApplicativeMorphism0</var><span class="hyp-type"><b>: </b><span>ApplicativeMorphism G1 G2 œà</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G1 (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">œà (runBatchM f (Go c)) =
runBatchM (<span class="kr">fun</span> <span class="nv">k</span> : K =&gt; œà (A:=T k B) ‚àò f k) (Go c)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="batch-v-chkd1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G1</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G1</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G1</span></span></span><br><span><var>G2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Map G2</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>Pure G2</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>Mult G2</span></span></span><br><span><var>H7</var><span class="hyp-type"><b>: </b><span>Applicative G2</span></span></span><br><span><var>œà</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, G1 A -&gt; G2 A</span></span></span><br><span><var>ApplicativeMorphism0</var><span class="hyp-type"><b>: </b><span>ApplicativeMorphism G1 G2 œà</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G1 (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHj</var><span class="hyp-type"><b>: </b><span>œà (runBatchM f j) =
runBatchM (<span class="kr">fun</span> <span class="nv">k</span> : K =&gt; œà (A:=T k B) ‚àò f k) j</span></span></span><br></div><label class="goal-separator" for="batch-v-chkd1"><hr></label><div class="goal-conclusion">œà (runBatchM f (j ‚ßÜ p)) =
runBatchM (<span class="kr">fun</span> <span class="nv">k</span> : K =&gt; œà (A:=T k B) ‚àò f k) (j ‚ßÜ p)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkd2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G1</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G1</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G1</span></span></span><br><span><var>G2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Map G2</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>Pure G2</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>Mult G2</span></span></span><br><span><var>H7</var><span class="hyp-type"><b>: </b><span>Applicative G2</span></span></span><br><span><var>œà</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, G1 A -&gt; G2 A</span></span></span><br><span><var>ApplicativeMorphism0</var><span class="hyp-type"><b>: </b><span>ApplicativeMorphism G1 G2 œà</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G1 (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">œà (runBatchM f (Go c)) =
runBatchM (<span class="kr">fun</span> <span class="nv">k</span> : K =&gt; œà (A:=T k B) ‚àò f k) (Go c)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkd3"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G1</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G1</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G1</span></span></span><br><span><var>G2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Map G2</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>Pure G2</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>Mult G2</span></span></span><br><span><var>H7</var><span class="hyp-type"><b>: </b><span>Applicative G2</span></span></span><br><span><var>œà</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, G1 A -&gt; G2 A</span></span></span><br><span><var>ApplicativeMorphism0</var><span class="hyp-type"><b>: </b><span>ApplicativeMorphism G1 G2 œà</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G1 (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">œà (pure c) = pure c</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (appmor_pure).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkd4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G1</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G1</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G1</span></span></span><br><span><var>G2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Map G2</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>Pure G2</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>Mult G2</span></span></span><br><span><var>H7</var><span class="hyp-type"><b>: </b><span>Applicative G2</span></span></span><br><span><var>œà</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, G1 A -&gt; G2 A</span></span></span><br><span><var>ApplicativeMorphism0</var><span class="hyp-type"><b>: </b><span>ApplicativeMorphism G1 G2 œà</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G1 (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>W * A</span></span></span><br><span><var>IHj</var><span class="hyp-type"><b>: </b><span>œà (runBatchM f j) =
runBatchM (<span class="kr">fun</span> <span class="nv">k</span> : K =&gt; œà (A:=T k B) ‚àò f k) j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">œà (runBatchM f (j ‚ßÜ p)) =
runBatchM (<span class="kr">fun</span> <span class="nv">k</span> : K =&gt; œà (A:=T k B) ‚àò f k) (j ‚ßÜ p)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkd5"><span class="nb">destruct</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G1</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G1</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G1</span></span></span><br><span><var>G2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Map G2</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>Pure G2</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>Mult G2</span></span></span><br><span><var>H7</var><span class="hyp-type"><b>: </b><span>Applicative G2</span></span></span><br><span><var>œà</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, G1 A -&gt; G2 A</span></span></span><br><span><var>ApplicativeMorphism0</var><span class="hyp-type"><b>: </b><span>ApplicativeMorphism G1 G2 œà</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G1 (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHj</var><span class="hyp-type"><b>: </b><span>œà (runBatchM f j) =
runBatchM (<span class="kr">fun</span> <span class="nv">k</span> : K =&gt; œà (A:=T k B) ‚àò f k) j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">œà (runBatchM f (j ‚ßÜ (w, a))) =
runBatchM (<span class="kr">fun</span> <span class="nv">k</span> : K =&gt; œà (A:=T k B) ‚àò f k)
  (j ‚ßÜ (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkd6"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G1</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G1</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G1</span></span></span><br><span><var>G2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Map G2</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>Pure G2</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>Mult G2</span></span></span><br><span><var>H7</var><span class="hyp-type"><b>: </b><span>Applicative G2</span></span></span><br><span><var>œà</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, G1 A -&gt; G2 A</span></span></span><br><span><var>ApplicativeMorphism0</var><span class="hyp-type"><b>: </b><span>ApplicativeMorphism G1 G2 œà</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G1 (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHj</var><span class="hyp-type"><b>: </b><span>œà (runBatchM f j) =
runBatchM (<span class="kr">fun</span> <span class="nv">k</span> : K =&gt; œà (A:=T k B) ‚àò f k) j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">œà (runBatchM f j &lt;‚ãÜ&gt; f k (w, a)) =
runBatchM (<span class="kr">fun</span> <span class="nv">k</span> : K =&gt; œà (A:=T k B) ‚àò f k) j &lt;‚ãÜ&gt;
(œà (A:=T k B) ‚àò f k) (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="batch-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="batch-v-chkd7"><span class="nb">rewrite</span> ap_morphism_1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Index</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span>K -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>A, B, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map G1</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Pure G1</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Mult G1</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Applicative G1</span></span></span><br><span><var>G2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Map G2</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>Pure G2</span></span></span><br><span><var>H6</var><span class="hyp-type"><b>: </b><span>Mult G2</span></span></span><br><span><var>H7</var><span class="hyp-type"><b>: </b><span>Applicative G2</span></span></span><br><span><var>œà</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, G1 A -&gt; G2 A</span></span></span><br><span><var>ApplicativeMorphism0</var><span class="hyp-type"><b>: </b><span>ApplicativeMorphism G1 G2 œà</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : K, W * A -&gt; G1 (T k B)</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>K</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>BatchM (T k B -&gt; C)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>IHj</var><span class="hyp-type"><b>: </b><span>œà (runBatchM f j) =
runBatchM (<span class="kr">fun</span> <span class="nv">k</span> : K =&gt; œà (A:=T k B) ‚àò f k) j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">œà (runBatchM f j) &lt;‚ãÜ&gt; œà (f k (w, a)) =
runBatchM (<span class="kr">fun</span> <span class="nv">k</span> : K =&gt; œà (A:=T k B) ‚àò f k) j &lt;‚ãÜ&gt;
(œà (A:=T k B) ‚àò f k) (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> IHj.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">runBatchM_morphism</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Notations *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">Notations</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Infix</span> <span class="s2">&quot;‚ßÜ&quot;</span> := Ap (<span class="kn">at level</span> <span class="mi">51</span>, <span class="kn">left associativity</span>): tealeaves_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Notations</span>.</span></span></pre>
</div>
</div></body>
</html>
