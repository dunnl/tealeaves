<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.21.2: https://docutils.sourceforge.io/" />
<title>DecoratedFunctor.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.16.0+0.16.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Tealeaves <span class="kn">Require Import</span>
  Classes.Categorical.DecoratedFunctor
  Classes.Categorical.RightComodule.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Generalizable Variables</span> <span class="nf">E</span> T W F G.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Monad.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Strength.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Product.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Monoid.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Arguments</span> map F%function_scope {Map} {A B}%type_scope f%function_scope _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Arguments</span> dec {E}%type_scope F%function_scope {Decorate} {A}%type_scope _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Arguments</span> ret T%function_scope {Return} (A)%type_scope _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Arguments</span> join T%function_scope {Join} {A}%type_scope _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * A decorated functor is precisely a right comodule of &lt;&lt;prod E&gt;&gt; *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">RightComodule_DecoratedFunctor</span>
  `{DecoratedFunctor E F}
  : RightComodule F (prod E) :=
  {| rcom_coaction_coaction := dfun_dec_dec;
    rcom_map_extr_coaction := dfun_dec_extract;
  |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">DecoratedFunctor_RightComodule</span>
  `{Map F} `{RightCoaction F (prod E)}
  `{! RightComodule F (prod E)} `{Monoid E}
  : DecoratedFunctor E F :=
  {| dfun_dec_dec := rcom_coaction_coaction;
    dfun_dec_extract := rcom_map_extr_coaction;
  |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Decorated functors form a monoidal category *)</span>
<span class="sd">(******************************************************************************)</span>

<span class="sd">(** ** Null-decorated functors *)</span>
<span class="sd">(** Every functor is trivially decorated using the operation that</span>
<span class="sd">    pairs each leaf with the unit of the monoid. We call such functors</span>
<span class="sd">    null-decorated. This allows us to see _all_ functors as (maybe</span>
<span class="sd">    trivially) decorated. *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">DecoratedFunctor_Zero</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    `{Monoid W}
    `{Functor F}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">Decorate_zero</span> : Decorate W F :=
    <span class="kr">fun</span> <span class="nv">A</span> =&gt; @map F _ A (W * A) (pair ∆µ).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk0"><span class="kn">Instance</span> <span class="nf">Natural_dec_zero</span> :
    Natural (@dec W F _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Natural (@dec W F Decorate_zero)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Natural (@dec W F Decorate_zero)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk2"><span class="nb">constructor</span>; <span class="kp">try</span> <span class="nb">typeclasses eauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
map (F ‚óã prod W) f ‚àò dec F = dec F ‚àò map F f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk3"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (F ‚óã prod W) f ‚àò dec F = dec F ‚àò map F f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk4">unfold_ops @Map_compose @Decorate_zero.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map (prod W) f) ‚àò map F (pair ∆µ) =
map F (pair ∆µ) ‚àò map F f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> fun_map_map.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk5"><span class="kn">Lemma</span> <span class="nf">dec_dec_zero</span> {<span class="nv">A</span>} :
    dec F ‚àò dec F (A:=A) =
    map F (cojoin (W :=(W √ó))) ‚àò dec F.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec F ‚àò dec F = map F cojoin ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec F ‚àò dec F = map F cojoin ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk7"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec F ‚àò dec F = map F cojoin ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk8">unfold_ops @Decorate_zero.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (pair ∆µ) ‚àò map F (pair ∆µ) =
map F cojoin ‚àò map F (pair ∆µ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> fun_map_map.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk9"><span class="kn">Lemma</span> <span class="nf">dec_extract_zero</span> {<span class="nv">A</span>} :
    map F (extract (W := (W √ó))) ‚àò dec F = @id (F A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F extract ‚àò dec F = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chka"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F extract ‚àò dec F = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkb"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F extract ‚àò dec F = id</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkc">unfold_ops @Decorate_zero.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F extract ‚àò map F (pair ∆µ) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkd"><span class="nb">rewrite</span> fun_map_map.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (extract ‚àò pair ∆µ) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chke"><span class="nb">unfold</span> compose; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; a) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> fun_map_id.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">DecoratedFunctor_zero</span> : DecoratedFunctor W F :=
    {| dfun_dec_natural := Natural_dec_zero;
       dfun_dec_dec := @dec_dec_zero;
       dfun_dec_extract := @dec_extract_zero;
    |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">DecoratedFunctor_Zero</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** The identity (zero-)decorated functor *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">DecoratedFunctor_I</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    `{Monoid W}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">dec_I</span> : <span class="kr">forall</span> <span class="nv">A</span>, A -&gt; prod W A :=
    <span class="kr">fun</span> <span class="nv">A</span> =&gt; @pair W A ∆µ.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Instance</span> <span class="nf">Decorate_I</span> : Decorate W (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A) := dec_I.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkf">#[<span class="kn">global</span>] <span class="kn">Instance</span> <span class="nf">Natural_dec_I</span> :
    Natural (G:=prod W) (<span class="kr">fun</span> <span class="nv">_</span> =&gt; dec (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Natural (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; dec (<span class="kr">fun</span> <span class="nv">A0</span> : <span class="kt">Type</span> =&gt; A0))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk10"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Natural (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; dec (<span class="kr">fun</span> <span class="nv">A0</span> : <span class="kt">Type</span> =&gt; A0))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk11"><span class="nb">constructor</span>; <span class="kp">try</span> <span class="nb">typeclasses eauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
map (prod W) f ‚àò dec (<span class="kr">fun</span> <span class="nv">A0</span> : <span class="kt">Type</span> =&gt; A0) =
dec (<span class="kr">fun</span> <span class="nv">A0</span> : <span class="kt">Type</span> =&gt; A0) ‚àò map (<span class="kr">fun</span> <span class="nv">H</span> : <span class="kt">Type</span> =&gt; H) f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk12"><span class="kn">Lemma</span> <span class="nf">dec_dec_I</span> {<span class="nv">A</span>} :
    dec (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A) ‚àò dec (A:=A) (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A) =
    map (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A) (<span class="kr">fun</span> &#39;(n, a) =&gt; (n, (n, a))) ‚àò dec (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) ‚àò dec (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) =
map (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) (<span class="kr">fun</span> &#39;(n, a) =&gt; (n, (n, a)))
‚àò dec (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk13"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) ‚àò dec (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) =
map (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) (<span class="kr">fun</span> &#39;(n, a) =&gt; (n, (n, a)))
‚àò dec (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk14"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) ‚àò dec (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) =
map (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) (<span class="kr">fun</span> &#39;(n, a) =&gt; (n, (n, a)))
‚àò dec (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk15"><span class="nb">cbv</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pair unit0 ‚óã pair unit0 = pair unit0 ‚óã pair unit0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk16"><span class="kn">Lemma</span> <span class="nf">dec_extract_I</span> {<span class="nv">A</span>} :
    map (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A) (extract (W := (W √ó))) ‚àò dec (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A) = (@id A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) extract
‚àò dec (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk17"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) extract
‚àò dec (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk18"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) extract
‚àò dec (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) = id</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Instance</span> <span class="nf">DecoratedFunctor_I</span> : DecoratedFunctor W (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A) :=
    {| dfun_dec_natural := Natural_dec_I;
       dfun_dec_dec := @dec_dec_I;
       dfun_dec_extract := @dec_extract_I;
    |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">DecoratedFunctor_I</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Decorated functors are closed under composition *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Decoratedfunctor_composition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    `{Monoid W}
    `{Map F} `{Map G}
    `{Decorate W F} `{Decorate W G}
    `{! DecoratedFunctor W F}
    `{! DecoratedFunctor W G}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Instance</span> <span class="nf">Decorate_compose</span> : Decorate W (F ‚àò G) :=
    <span class="kr">fun</span> <span class="nv">A</span> =&gt; map F (shift G) ‚àò dec F ‚àò map F (dec G).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk19"><span class="kn">Instance</span> <span class="nf">Natural_dec_compose</span> :
    Natural (<span class="kr">fun</span> <span class="nv">A</span> =&gt; dec (A:=A) (E:=W) (F ‚àò G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Natural (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; dec (F ‚àò G))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk1a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Natural (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; dec (F ‚àò G))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk1b"><span class="nb">constructor</span>; <span class="kp">try</span> <span class="nb">typeclasses eauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
map (F ‚àò G ‚óã prod W) f ‚àò dec (F ‚àò G) =
dec (F ‚àò G) ‚àò map (F ‚àò G) f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk1c">introv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (F ‚àò G ‚óã prod W) f ‚àò dec (F ‚àò G) =
dec (F ‚àò G) ‚àò map (F ‚àò G) f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk1d">unfold_ops @Map_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (F ‚àò G) (map (prod W) f) ‚àò dec (F ‚àò G) =
dec (F ‚àò G) ‚àò map F (map G f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk1e"><span class="nb">unfold</span> map <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (map (prod W) f)) ‚àò dec (F ‚àò G) =
dec (F ‚àò G) ‚àò map F (map G f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk1f">unfold_ops @Decorate_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (map (prod W) f))
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò map F (map G f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* Move &lt;&lt; F (shift G)&gt;&gt; past &lt;&lt;F (G ‚àò F) f&gt;&gt;. *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk20"><span class="kp">repeat</span> reassociate &lt;- on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (map (prod W) f)) ‚àò map F (shift G)
‚àò dec F ‚àò map F (dec G) =
map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò map F (map G f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk21">unfold_compose_in_compose; <span class="nb">rewrite</span> (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (map (prod W) f) ‚àò shift G) ‚àò dec F
‚àò map F (dec G) =
map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò map F (map G f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk22"><span class="nb">change</span> (map G (map (W √ó) f)) <span class="kr">with</span> (map (G ‚àò (W √ó)) f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map (G ‚àò prod W) f ‚àò shift G) ‚àò dec F
‚àò map F (dec G) =
map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò map F (map G f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk23">#[local] <span class="kn">Set Keyed Unification</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map (G ‚àò prod W) f ‚àò shift G) ‚àò dec F
‚àò map F (dec G) =
map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò map F (map G f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk24"><span class="nb">rewrite</span> (shift_map2 G).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G ‚àò map (prod W ‚àò G ‚àò prod W) f) ‚àò dec F
‚àò map F (dec G) =
map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò map F (map G f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk25">#[local] <span class="kn">Unset Keyed Unification</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G ‚àò map (prod W ‚àò G ‚àò prod W) f) ‚àò dec F
‚àò map F (dec G) =
map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò map F (map G f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk26"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò map F (map (prod W ‚àò G ‚àò prod W) f)
‚àò dec F ‚àò map F (dec G) =
map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò map F (map G f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* mov &lt;&lt;dec F&gt;&gt; past &lt;&lt;F ‚àò W ‚àò G ‚àò W f&gt;&gt; *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk27"><span class="nb">change</span> (map F (map (prod W ‚àò G ‚àò prod W) f))
      <span class="kr">with</span> (map (F ‚àò prod W) (map (G ‚àò prod W) f)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G)
‚àò map (F ‚àò prod W) (map (G ‚àò prod W) f) ‚àò dec F
‚àò map F (dec G) =
map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò map F (map G f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk28"><span class="kp">repeat</span> reassociate -&gt;;
           reassociate &lt;- near (map (F ‚àò prod W) (map (G ‚àò prod W) f)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G)
‚àò (map (F ‚àò prod W) (map (G ‚àò prod W) f) ‚àò dec F
   ‚àò map F (dec G)) =
map F (shift G)
‚àò (dec F ‚àò (map F (dec G) ‚àò map F (map G f)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk29"><span class="nb">rewrite</span> (natural (G := F ‚àò prod W) (œï := @dec W F _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G)
‚àò (dec F ‚àò map F (map (G ‚àò prod W) f) ‚àò map F (dec G)) =
map F (shift G)
‚àò (dec F ‚àò (map F (dec G) ‚àò map F (map G f)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* move &lt;&lt;F (dec G)&gt;&gt; past &lt;&lt;F ((G ‚àò W) f)&gt;&gt; *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk2a">reassociate -&gt; on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G)
‚àò (dec F
   ‚àò (map F (map (G ‚àò prod W) f) ‚àò map F (dec G))) =
map F (shift G)
‚àò (dec F ‚àò (map F (dec G) ‚àò map F (map G f)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk2b"><span class="nb">rewrite</span> (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G)
‚àò (dec F ‚àò map F (map (G ‚àò prod W) f ‚àò dec G)) =
map F (shift G)
‚àò (dec F ‚àò (map F (dec G) ‚àò map F (map G f)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk2c">#[local] <span class="kn">Set Keyed Unification</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G)
‚àò (dec F ‚àò map F (map (G ‚àò prod W) f ‚àò dec G)) =
map F (shift G)
‚àò (dec F ‚àò (map F (dec G) ‚àò map F (map G f)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk2d"><span class="nb">rewrite</span> (natural (G := G ‚àò prod W) (œï := @dec W G _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò (dec F ‚àò map F (dec G ‚àò map G f)) =
map F (shift G)
‚àò (dec F ‚àò (map F (dec G) ‚àò map F (map G f)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk2e">#[local] <span class="kn">Unset Keyed Unification</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò (dec F ‚àò map F (dec G ‚àò map G f)) =
map F (shift G)
‚àò (dec F ‚àò (map F (dec G) ‚àò map F (map G f)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- (fun_map_map (F := F)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** The next few lemmas are used to build up a proof of the</span>
<span class="sd">   &quot;double decoration law&quot;, [dfun_dec_dec (F ‚àò G)] *)</span>

  <span class="sd">(** Split the decoration wire on &lt;&lt;G&gt;&gt; into two wires with</span>
<span class="sd">      &lt;&lt;dfun_dec_dec G&gt;&gt; law. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk2f"><span class="kn">Lemma</span> <span class="nf">dec_dec_compose_1</span> {<span class="nv">A</span>} :
    (map F (map (G ‚àò prod W) (cojoin (W := prod W)) ‚àò strength (F := G)))
      ‚àò dec F
      ‚àò map F (dec G)
    = (map F (strength (F := G)))
        ‚àò dec F
        ‚àò map F (dec G ‚àò dec G (A := A)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map (G ‚àò prod W) cojoin ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) =
map F (œÉ) ‚àò dec F ‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk30"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map (G ‚àò prod W) cojoin ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) =
map F (œÉ) ‚àò dec F ‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* Move &lt;&lt;F (strength)&gt;&gt; past &lt;&lt;F ((W ‚óã G) (cojoin (prod W)))&gt;&gt; *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk31"><span class="nb">rewrite</span> (natural (G := (G ‚àò prod W)) (œï := @strength G _ W)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ ‚àò map (prod W ‚óã G) cojoin) ‚àò dec F
‚àò map F (dec G) =
map F (œÉ) ‚àò dec F ‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk32">unfold_ops @Map_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ ‚àò map (prod W) (map G cojoin)) ‚àò dec F
‚àò map F (dec G) =
map F (œÉ) ‚àò dec F ‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk33"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò map F (map (prod W) (map G cojoin))
‚àò dec F ‚àò map F (dec G) =
map F (œÉ) ‚àò dec F ‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* Move &lt;&lt;dec F&gt;&gt; past &lt;&lt;F ((W ‚óã G) (cojoin (prod W)))&gt;&gt; *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk34"><span class="nb">change</span> (map <span class="nl">?F</span> (map (prod W) <span class="nl">?f</span>)) <span class="kr">with</span> (map (F ‚àò (prod W)) f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò map (F ‚àò prod W) (map G cojoin) ‚àò dec F
‚àò map F (dec G) =
map F (œÉ) ‚àò dec F ‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk35">reassociate -&gt; near (dec F).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò (map (F ‚àò prod W) (map G cojoin) ‚àò dec F)
‚àò map F (dec G) =
map F (œÉ) ‚àò dec F ‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk36"><span class="nb">rewrite</span> (natural (œï := @dec W F _) (G := F ‚àò prod W)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò (dec F ‚àò map F (map G cojoin))
‚àò map F (dec G) =
map F (œÉ) ‚àò dec F ‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk37"><span class="kp">do</span> <span class="mi">2</span> reassociate -&gt; near (map F (dec G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ)
‚àò (dec F ‚àò (map F (map G cojoin) ‚àò map F (dec G))) =
map F (œÉ) ‚àò dec F ‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk38"><span class="nb">rewrite</span> (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò (dec F ‚àò map F (map G cojoin ‚àò dec G)) =
map F (œÉ) ‚àò dec F ‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> &lt;- (dfun_dec_dec (E := W) (F := G)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk39"><span class="kn">Lemma</span> <span class="nf">strength_cojoin_r</span> {<span class="nv">A</span>} :
    (map G (cojoin (W := (W √ó))))
      ‚àò strength (F := G)
    = strength (F := G)
        ‚àò map (prod W) (strength (F := G))
        ‚àò cojoin (W := (W √ó)) (A := G A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map G cojoin ‚àò œÉ = œÉ ‚àò map (prod W) (œÉ) ‚àò cojoin</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk3a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map G cojoin ‚àò œÉ = œÉ ‚àò map (prod W) (œÉ) ‚àò cojoin</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk3b">ext [w a].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map G cojoin ‚àò œÉ) (w, a) =
(œÉ ‚àò map (prod W) (œÉ) ‚àò cojoin) (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk3c"><span class="nb">unfold</span> strength, compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map G cojoin (map G (pair w) a) =
(<span class="kr">let</span>
 &#39;(a, t) :=
  map (prod W) (<span class="kr">fun</span> &#39;(a, t) =&gt; map G (pair a) t)
    (cojoin (w, a)) <span class="kr">in</span> map G (pair a) t)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk3d"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map G cojoin (map G (pair w) a) =
map G (pair (id w)) (map G (pair w) a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk3e">compose near a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>G A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map G cojoin ‚àò map G (pair w)) a =
(map G (pair (id w)) ‚àò map G (pair w)) a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> (fun_map_map (F := G)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Split the decoration wire on &lt;&lt;F&gt;&gt; into two wires with</span>
<span class="sd">     &lt;&lt;dfun_dec_dec F&gt;&gt;. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk3f"><span class="kn">Lemma</span> <span class="nf">dec_dec_compose_2</span> {<span class="nv">A</span>} :
    (map F (map G (cojoin (W := prod W)) ‚àò strength))
      ‚àò dec F
    = (map F strength)
        ‚àò dec F
        ‚àò map F strength
        ‚àò dec F (A := G A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G cojoin ‚àò œÉ) ‚àò dec F =
map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk40"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G cojoin ‚àò œÉ) ‚àò dec F =
map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk41"><span class="nb">rewrite</span> strength_cojoin_r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ ‚àò map (prod W) (œÉ) ‚àò cojoin) ‚àò dec F =
map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk42"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ ‚àò map (prod W) (œÉ)) ‚àò map F cojoin ‚àò dec F =
map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk43">reassociate -&gt; on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ ‚àò map (prod W) (œÉ)) ‚àò (map F cojoin ‚àò dec F) =
map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk44"><span class="nb">rewrite</span> &lt;- (dfun_dec_dec (E := W) (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ ‚àò map (prod W) (œÉ)) ‚àò (dec F ‚àò dec F) =
map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk45">reassociate &lt;- on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ ‚àò map (prod W) (œÉ)) ‚àò dec F ‚àò dec F =
map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk46"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò map F (map (prod W) (œÉ)) ‚àò dec F ‚àò dec F =
map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk47"><span class="nb">change</span> (<span class="nl">?f</span> ‚àò map F (map (prod W) strength) ‚àò dec F ‚àò <span class="nl">?g</span>)
      <span class="kr">with</span> (f ‚àò (map F (map (prod W) strength) ‚àò dec F) ‚àò g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò (map F (map (prod W) (œÉ)) ‚àò dec F) ‚àò dec F =
map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk48"><span class="nb">change</span> (map <span class="nl">?F</span> (map <span class="nl">?G</span> <span class="nl">?f</span>)) <span class="kr">with</span> (map (F ‚àò G) f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò (map (F ‚àò prod W) (œÉ) ‚àò dec F) ‚àò dec F =
map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (natural (œï := @dec W F _) (strength (B := A))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Slide the upper decoration wire on &lt;&lt;G&gt;&gt; past the lower</span>
<span class="sd">  decoration wire on &lt;&lt;F&gt;&gt;, which requires crossing them. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk49"><span class="kn">Lemma</span> <span class="nf">dec_dec_compose_3</span> {<span class="nv">A</span>} :
    (map F strength)
      ‚àò dec F
      ‚àò map F (dec G) =
    (map (F ‚àò G) (bdist (prod W) (prod W)))
      ‚àò map F (dec G)
      ‚àò map F strength
      ‚àò dec F (A := G A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò dec F ‚àò map F (dec G) =
map (F ‚àò G) (bdist (prod W) (prod W)) ‚àò map F (dec G)
‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk4a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò dec F ‚àò map F (dec G) =
map (F ‚àò G) (bdist (prod W) (prod W)) ‚àò map F (dec G)
‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk4b">unfold_ops @BeckDistribution_strength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò dec F ‚àò map F (dec G) =
map (F ‚àò G) (œÉ) ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk4c">#[local] <span class="kn">Set Keyed Unification</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò dec F ‚àò map F (dec G) =
map (F ‚àò G) (œÉ) ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk4d"><span class="nb">rewrite</span> (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò dec F ‚àò map F (dec G) =
map F (map G (œÉ) ‚àò dec G) ‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk4e"><span class="nb">rewrite</span> (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò dec F ‚àò map F (dec G) =
map F (map G (œÉ) ‚àò dec G ‚àò œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk4f">#[local] <span class="kn">Unset Keyed Unification</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò dec F ‚àò map F (dec G) =
map F (map G (œÉ) ‚àò dec G ‚àò œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk50">reassociate -&gt; on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò (dec F ‚àò map F (dec G)) =
map F (map G (œÉ) ‚àò dec G ‚àò œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk51"><span class="nb">rewrite</span> &lt;- (natural (œï := @dec W F _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò (map (F ‚óã prod W) (dec G) ‚àò dec F) =
map F (map G (œÉ) ‚àò dec G ‚àò œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk52">unfold_ops @Map_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò (map F (map (prod W) (dec G)) ‚àò dec F) =
map F (map G (œÉ) ‚àò dec G ‚àò œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk53">reassociate &lt;- on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ) ‚àò map F (map (prod W) (dec G)) ‚àò dec F =
map F (map G (œÉ) ‚àò dec G ‚àò œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk54"><span class="nb">rewrite</span> (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ ‚àò map (prod W) (dec G)) ‚àò dec F =
map F (map G (œÉ) ‚àò dec G ‚àò œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk55">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (œÉ ‚àò map (prod W) (dec G)) =
map F (map G (œÉ) ‚àò dec G ‚àò œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk56">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">œÉ ‚àò map (prod W) (dec G) = map G (œÉ) ‚àò dec G ‚àò œÉ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk57"><span class="nb">unfold</span> compose; ext [w x]; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map G (pair (id w)) (dec G x) =
map G (œÉ) (dec G (map G (pair w) x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk58">compose near x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map G (pair (id w)) ‚àò dec G) x =
map G (œÉ) ((dec G ‚àò map G (pair w)) x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk59"><span class="nb">rewrite</span> &lt;- (natural (œï := @dec W G _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map G (pair (id w)) ‚àò dec G) x =
map G (œÉ) ((map (G ‚óã prod W) (pair w) ‚àò dec G) x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk5a">unfold_ops @Map_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map G (pair (id w)) ‚àò dec G) x =
map G (œÉ) ((map G (map (prod W) (pair w)) ‚àò dec G) x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk5b">compose near x on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map G (pair (id w)) ‚àò dec G) x =
(map G (œÉ) ‚àò (map G (map (prod W) (pair w)) ‚àò dec G))
  x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk5c">reassociate &lt;- on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map G (pair (id w)) ‚àò dec G) x =
(map G (œÉ) ‚àò map G (map (prod W) (pair w)) ‚àò dec G) x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk5d"><span class="nb">rewrite</span> (fun_map_map (F := G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map G (pair (id w)) ‚àò dec G) x =
(map G (œÉ ‚àò map (prod W) (pair w)) ‚àò dec G) x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk5e"><span class="nb">unfold</span> strength, compose, id.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map G (pair w) (dec G x) =
map G
  (<span class="kr">fun</span> <span class="nv">a</span> : W * A =&gt;
   <span class="kr">let</span>
   &#39;(a0, t) := map (prod W) (pair w) a <span class="kr">in</span>
    map (prod W) (pair a0) t) (dec G x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk5f">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>G A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pair w =
(<span class="kr">fun</span> <span class="nv">a</span> : W * A =&gt;
 <span class="kr">let</span>
 &#39;(a0, t) := map (prod W) (pair w) a <span class="kr">in</span>
  map (prod W) (pair a0) t)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> ext [? ?].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Re-arrange using naturality *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk60"><span class="kn">Lemma</span> <span class="nf">dec_dec_compose_5</span> : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>),
      map F (map G (join (prod W))) ‚àò map F œÉ ‚àò dec F ‚àò map F (dec G)
           ‚àò (map F (map G (join (prod W))) ‚àò map F strength) ‚àò dec F ‚àò map F (dec G)
      =
      map F (map G (join (prod W)) ‚àò map G (map (prod W ‚àò prod W) (join (prod W))) ‚àò strength) ‚àò dec F
           ‚àò map F (dec G) ‚àò map F œÉ ‚àò dec F ‚àò map F (dec G (A := A)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)
‚àò (map F (map G (Œº (prod W))) ‚àò map F (œÉ)) ‚àò dec F
‚àò map F (dec G) =
map F
  (map G (Œº (prod W))
   ‚àò map G (map (prod W ‚àò prod W) (Œº (prod W))) ‚àò 
   œÉ) ‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk61"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)
‚àò (map F (map G (Œº (prod W))) ‚àò map F (œÉ)) ‚àò dec F
‚àò map F (dec G) =
map F
  (map G (Œº (prod W))
   ‚àò map G (map (prod W ‚àò prod W) (Œº (prod W))) ‚àò 
   œÉ) ‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk62"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)
‚àò (map F (map G (Œº (prod W))) ‚àò map F (œÉ)) ‚àò dec F
‚àò map F (dec G) =
map F
  (map G (Œº (prod W))
   ‚àò map G (map (prod W ‚àò prod W) (Œº (prod W))) ‚àò 
   œÉ) ‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk63">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)
‚àò (map F (map G (Œº (prod W))) ‚àò map F (œÉ)) ‚àò dec F =
map F
  (map G (Œº (prod W))
   ‚àò map G (map (prod W ‚àò prod W) (Œº (prod W))) ‚àò 
   œÉ) ‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk64">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)
‚àò (map F (map G (Œº (prod W))) ‚àò map F (œÉ)) =
map F
  (map G (Œº (prod W))
   ‚àò map G (map (prod W ‚àò prod W) (Œº (prod W))) ‚àò 
   œÉ) ‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk65">reassociate &lt;-.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W)))
‚àò map F (œÉ) =
map F
  (map G (Œº (prod W))
   ‚àò map G (map (prod W ‚àò prod W) (Œº (prod W))) ‚àò 
   œÉ) ‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk66">unfold_ops @Map_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W)))
‚àò map F (œÉ) =
map F
  (map G (Œº (prod W))
   ‚àò map G (map (prod W) (map (prod W) (Œº (prod W))))
   ‚àò œÉ) ‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk67"><span class="nb">change</span> (map G (map (prod W) (map (prod W) (join (A:=<span class="nl">?A</span>) (prod W)))))
      <span class="kr">with</span> (map (G ‚óã prod W) (map (prod W) (join (A:=A) (prod W)))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W)))
‚àò map F (œÉ) =
map F
  (map G (Œº (prod W))
   ‚àò map (G ‚óã prod W) (map (prod W) (Œº (prod W))) ‚àò 
   œÉ) ‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk68">reassociate -&gt; near strength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W)))
‚àò map F (œÉ) =
map F
  (map G (Œº (prod W))
   ‚àò (map (G ‚óã prod W) (map (prod W) (Œº (prod W))) ‚àò œÉ))
‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk69"><span class="nb">rewrite</span> (natural (œï := @strength G _ W)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W)))
‚àò map F (œÉ) =
map F
  (map G (Œº (prod W))
   ‚àò (œÉ ‚àò map (prod W ‚óã G) (map (prod W) (Œº (prod W)))))
‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk6a"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W)))
‚àò map F (œÉ) =
map F (map G (Œº (prod W)))
‚àò map F
    (œÉ ‚àò map (prod W ‚óã G) (map (prod W) (Œº (prod W))))
‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk6b"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W)))
‚àò map F (œÉ) =
map F (map G (Œº (prod W)))
‚àò (map F (œÉ)
   ‚àò map F
       (map (prod W ‚óã G) (map (prod W) (Œº (prod W)))))
‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk6c">reassociate -&gt; near (@dec W F H2 (G (W * (prod W ‚àò prod W) A))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W)))
‚àò map F (œÉ) =
map F (map G (Œº (prod W)))
‚àò (map F (œÉ)
   ‚àò map F
       (map (prod W ‚óã G) (map (prod W) (Œº (prod W))))
   ‚àò dec F) ‚àò map F (dec G) ‚àò map F (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk6d"><span class="nb">change</span> (map F (map (prod W ‚óã G) (map (prod W) (join (A:=<span class="nl">?A</span>) (prod W)))))
      <span class="kr">with</span> (map (F ‚óã prod W) (map G (map (prod W) (join (A:=A) (prod W))))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W)))
‚àò map F (œÉ) =
map F (map G (Œº (prod W)))
‚àò (map F (œÉ)
   ‚àò map (F ‚óã prod W)
       (map G (map (prod W) (Œº (prod W)))) ‚àò dec F)
‚àò map F (dec G) ‚àò map F (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk6e">reassociate -&gt; near (dec F).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò (map F (œÉ) ‚àò dec F)
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W)))
‚àò map F (œÉ) =
map F (map G (Œº (prod W)))
‚àò (map F (œÉ)
   ‚àò (map (F ‚óã prod W)
        (map G (map (prod W) (Œº (prod W)))) ‚àò dec F))
‚àò map F (dec G) ‚àò map F (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk6f"><span class="nb">rewrite</span> (natural (œï := @dec W F _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò (map F (œÉ) ‚àò dec F)
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W)))
‚àò map F (œÉ) =
map F (map G (Œº (prod W)))
‚àò (map F (œÉ)
   ‚àò (dec F
      ‚àò map F (map G (map (prod W) (Œº (prod W))))))
‚àò map F (dec G) ‚àò map F (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk70">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò (map F (œÉ) ‚àò dec F)
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W))) =
map F (map G (Œº (prod W)))
‚àò (map F (œÉ)
   ‚àò (dec F
      ‚àò map F (map G (map (prod W) (Œº (prod W))))))
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk71"><span class="kp">do</span> <span class="mi">3</span> reassociate &lt;-.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W))) =
map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (map G (map (prod W) (Œº (prod W))))
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk72">reassociate -&gt; on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W))) =
map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò (map F (map G (map (prod W) (Œº (prod W))))
   ‚àò map F (dec G))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk73"><span class="nb">rewrite</span> (fun_map_map (F := F) _ _ _ (@dec W G _ (W * (W * A)))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W))) =
map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (map G (map (prod W) (Œº (prod W))) ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk74"><span class="nb">change</span> (map G (map (prod W) (join (A:=<span class="nl">?A</span>) (prod W))))
      <span class="kr">with</span> (map (G ‚àò prod W) (join (A:=A) (prod W))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W))) =
map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (map (G ‚àò prod W) (Œº (prod W)) ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk75"><span class="nb">rewrite</span> (natural (œï := @dec W G _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W))) =
map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G ‚àò map G (Œº (prod W)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk76"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F)) <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (Œº (prod W))) =
map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò (map F (dec G) ‚àò map F (map G (Œº (prod W))))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Set Keyed Unification</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk77"><span class="kn">Theorem</span> <span class="nf">dec_dec_compose</span> {<span class="nv">A</span>} :
    dec (F ‚àò G) ‚àò dec (F ‚àò G) =
    map (F ‚àò G) (cojoin (W := prod W)) ‚àò dec (F ‚àò G) (A:=A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec (F ‚àò G) ‚àò dec (F ‚àò G) =
map (F ‚àò G) cojoin ‚àò dec (F ‚àò G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk78"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec (F ‚àò G) ‚àò dec (F ‚àò G) =
map (F ‚àò G) cojoin ‚àò dec (F ‚àò G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk79"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec (F ‚àò G) ‚àò dec (F ‚àò G) =
map (F ‚àò G) cojoin ‚àò dec (F ‚àò G)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk7a">unfold_ops @Map_compose @Decorate_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F (map G cojoin)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* Rewrite the RHS with the butterfly law *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk7b"><span class="kp">do</span> <span class="mi">2</span> reassociate &lt;- on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F (map G cojoin) ‚àò map F (shift G) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk7c"><span class="nb">rewrite</span> (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F (map G cojoin ‚àò shift G) ‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk7d"><span class="nb">unfold</span> shift <span class="nb">at</span> <span class="mi">3</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F (map G cojoin ‚àò (map G (uncurry incr) ‚àò œÉ))
‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk7e">reassociate &lt;- on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F (map G cojoin ‚àò map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk7f"><span class="nb">rewrite</span> (fun_map_map (F := G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F (map G (cojoin ‚àò uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk80"><span class="nb">rewrite</span> incr_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F (map G (cojoin ‚àò Œº (prod W)) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk81"><span class="nb">rewrite</span> (Writer.bimonad_butterfly).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W))
      ‚àò cojoin ‚àò map (prod W) cojoin) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* Rewrite the outer (prod W) wire with the &lt;&lt;dfun_dec_dec&gt;&gt; law *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk82"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W))
      ‚àò cojoin) ‚àò map G (map (prod W) cojoin) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk83"><span class="nb">change</span> (map <span class="nl">?F</span> (map <span class="nl">?G</span> <span class="nl">?f</span>)) <span class="kr">with</span> (map (F ‚àò G) f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W))
      ‚àò cojoin) ‚àò map (G ‚àò prod W) cojoin ‚àò œÉ) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk84">reassociate -&gt; near (strength (F := G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W))
      ‚àò cojoin) ‚àò (map (G ‚àò prod W) cojoin ‚àò œÉ))
‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk85"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W))
      ‚àò cojoin)) ‚àò map F (map (G ‚àò prod W) cojoin ‚àò œÉ)
‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk86"><span class="nb">change</span> (<span class="nl">?f</span> ‚àò map F (map (G ‚àò prod W) cojoin ‚àò strength (F := G)) ‚àò dec F ‚àò map F (dec G))
      <span class="kr">with</span> (f ‚àò (map F (map (G ‚àò prod W) cojoin ‚àò strength (F := G)) ‚àò dec F ‚àò map F (dec G))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W))
      ‚àò cojoin))
‚àò (map F (map (G ‚àò prod W) cojoin ‚àò œÉ) ‚àò dec F
   ‚àò map F (dec G))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk87"><span class="nb">rewrite</span> dec_dec_compose_1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W))
      ‚àò cojoin))
‚àò (map F (œÉ) ‚àò dec F ‚àò map F (dec G ‚àò dec G))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* Rewrite the outer (prod W) wire with the &lt;&lt;dfun_dec_dec&gt;&gt; law *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk88"><span class="kp">do</span> <span class="mi">2</span> reassociate &lt;- on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W))
      ‚àò cojoin)) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk89"><span class="nb">rewrite</span> (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W))
      ‚àò cojoin) ‚àò œÉ) ‚àò dec F ‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk8a"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W)))
   ‚àò map G cojoin ‚àò œÉ) ‚àò dec F ‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk8b">reassociate -&gt; near strength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W)))
   ‚àò (map G cojoin ‚àò œÉ)) ‚àò dec F
‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk8c"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W))))
‚àò map F (map G cojoin ‚àò œÉ) ‚àò dec F
‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk8d">reassociate -&gt; near (dec F).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W))))
‚àò (map F (map G cojoin ‚àò œÉ) ‚àò dec F)
‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk8e"><span class="nb">rewrite</span> dec_dec_compose_2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W))))
‚àò (map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F)
‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk8f"><span class="kp">repeat</span> <span class="nb">change</span> (map <span class="nl">?F</span> (map <span class="nl">?G</span> <span class="nl">?f</span>)) <span class="kr">with</span> (map (F ‚àò G) f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map (F ‚àò G)
  (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
   ‚àò map (prod W) (bdist (prod W) (prod W)))
‚àò (map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F)
‚àò map F (dec G ‚àò dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* Slide a decoration on &lt;&lt;F&gt;&gt; and one on &lt;&lt;G&gt;&gt; past each other *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk90"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map (F ‚àò G)
  (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
   ‚àò map (prod W) (bdist (prod W) (prod W)))
‚àò (map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F)
‚àò (map F (dec G) ‚àò map F (dec G))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk91"><span class="kp">do</span> <span class="mi">4</span> reassociate &lt;- on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) =
map (F ‚àò G)
  (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
   ‚àò map (prod W) (bdist (prod W) (prod W)))
‚àò map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk92"><span class="kp">do</span> <span class="mi">2</span> reassociate &lt;- on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò map F (shift G) ‚àò dec F ‚àò map F (dec G) =
map (F ‚àò G)
  (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
   ‚àò map (prod W) (bdist (prod W) (prod W)))
‚àò map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk93"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F ‚àò G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò map F (shift G) ‚àò dec F ‚àò map F (dec G) =
map (F ‚àò G) (map (prod W) (Œº (prod W)) ‚àò Œº (prod W))
‚àò map (F ‚àò G) (map (prod W) (bdist (prod W) (prod W)))
‚àò map F (œÉ) ‚àò dec F ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk94"><span class="nb">change</span> (<span class="nl">?f</span> ‚àò map F strength
             ‚àò dec F
             ‚àò map F (dec G)
             ‚àò <span class="nl">?g</span>) <span class="kr">with</span>
        (f ‚àò (map F strength
                   ‚àò dec F
                   ‚àò map F (dec G))
           ‚àò g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò map F (shift G) ‚àò dec F ‚àò map F (dec G) =
map (F ‚àò G) (map (prod W) (Œº (prod W)) ‚àò Œº (prod W))
‚àò map (F ‚àò G) (map (prod W) (bdist (prod W) (prod W)))
‚àò map F (œÉ) ‚àò dec F
‚àò (map F (œÉ) ‚àò dec F ‚àò map F (dec G)) ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk95"><span class="nb">rewrite</span> dec_dec_compose_3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò map F (shift G) ‚àò dec F ‚àò map F (dec G) =
map (F ‚àò G) (map (prod W) (Œº (prod W)) ‚àò Œº (prod W))
‚àò map (F ‚àò G) (map (prod W) (bdist (prod W) (prod W)))
‚àò map F (œÉ) ‚àò dec F
‚àò (map (F ‚àò G) (bdist (prod W) (prod W))
   ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F)
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* Flatten out a distribution bubble. Move the second decoration on &lt;&lt;F&gt;&gt;</span>
<span class="c">     out of the way to juxtapose the two distributions. *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk96"><span class="nb">rewrite</span> (fun_map_map (F := F ‚àò G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G)
‚àò map F (shift G) ‚àò dec F ‚àò map F (dec G) =
map (F ‚àò G)
  (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
   ‚àò map (prod W) (bdist (prod W) (prod W)))
‚àò map F (œÉ) ‚àò dec F
‚àò (map (F ‚àò G) (bdist (prod W) (prod W))
   ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F)
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk97"><span class="nb">unfold</span> shift.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map (F ‚àò G)
  (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
   ‚àò map (prod W) (bdist (prod W) (prod W)))
‚àò map F (œÉ) ‚àò dec F
‚àò (map (F ‚àò G) (bdist (prod W) (prod W))
   ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F)
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk98"><span class="nb">rewrite</span> (fun_map_map (F := F) _ _ _(@strength G _ W (W * (W * (W * A))))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G
     (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)
      ‚àò map (prod W) (bdist (prod W) (prod W))) ‚àò 
   œÉ) ‚àò dec F
‚àò (map (F ‚àò G) (bdist (prod W) (prod W))
   ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F)
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk99"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W))
   ‚àò map G (map (prod W) (bdist (prod W) (prod W)))
   ‚àò œÉ) ‚àò dec F
‚àò (map (F ‚àò G) (bdist (prod W) (prod W))
   ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F)
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk9a"><span class="nb">change</span> (map G (map (prod W) (bdist (prod W) (prod W))))
      <span class="kr">with</span> (map (G ‚óã prod W) (bdist (A := W * A) (prod W) (prod W))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W))
   ‚àò map (G ‚óã prod W) (bdist (prod W) (prod W)) ‚àò 
   œÉ) ‚àò dec F
‚àò (map (F ‚àò G) (bdist (prod W) (prod W))
   ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F)
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk9b">reassociate -&gt; near (@strength G _ W _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W))
   ‚àò (map (G ‚óã prod W) (bdist (prod W) (prod W)) ‚àò œÉ))
‚àò dec F
‚àò (map (F ‚àò G) (bdist (prod W) (prod W))
   ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F)
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk9c"><span class="nb">rewrite</span> (natural (œï := @strength G _ W)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W))
   ‚àò (œÉ ‚àò map (prod W ‚óã G) (bdist (prod W) (prod W))))
‚àò dec F
‚àò (map (F ‚àò G) (bdist (prod W) (prod W))
   ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F)
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk9d"><span class="kp">do</span> <span class="mi">4</span> reassociate &lt;-.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)) ‚àò œÉ
   ‚àò map (prod W ‚óã G) (bdist (prod W) (prod W)))
‚àò dec F ‚àò map (F ‚àò G) (bdist (prod W) (prod W))
‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk9e"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F) _ _ _ (map (prod W ‚óã G) (bdist (prod W) (prod W)))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)) ‚àò œÉ)
‚àò map F (map (prod W ‚óã G) (bdist (prod W) (prod W)))
‚àò dec F ‚àò map (F ‚àò G) (bdist (prod W) (prod W))
‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk9f"><span class="nb">change</span> (map F (map (prod W ‚óã G) (bdist (A:=<span class="nl">?A</span>) (prod W) (prod W))))
      <span class="kr">with</span> (map (F ‚àò prod W) (map G (bdist (A:=A) (prod W) (prod W)))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)) ‚àò œÉ)
‚àò map (F ‚àò prod W) (map G (bdist (prod W) (prod W)))
‚àò dec F ‚àò map (F ‚àò G) (bdist (prod W) (prod W))
‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chka0">reassociate -&gt; near (dec F (A := (G (W * (W * (W * A)))))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)) ‚àò œÉ)
‚àò (map (F ‚àò prod W) (map G (bdist (prod W) (prod W)))
   ‚àò dec F) ‚àò map (F ‚àò G) (bdist (prod W) (prod W))
‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chka1"><span class="nb">rewrite</span> (natural (œï := @dec W F _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)) ‚àò œÉ)
‚àò (dec F ‚àò map F (map G (bdist (prod W) (prod W))))
‚àò map (F ‚àò G) (bdist (prod W) (prod W))
‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chka2">reassociate &lt;-.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)) ‚àò œÉ)
‚àò dec F ‚àò map F (map G (bdist (prod W) (prod W)))
‚àò map (F ‚àò G) (bdist (prod W) (prod W))
‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chka3"><span class="nb">change</span> (map F (map G (bdist (A:=<span class="nl">?A</span>) (prod W) (prod W))))
      <span class="kr">with</span> (map (F ‚àò G) (bdist (A:=A) (prod W) (prod W))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)) ‚àò œÉ)
‚àò dec F ‚àò map (F ‚àò G) (bdist (prod W) (prod W))
‚àò map (F ‚àò G) (bdist (prod W) (prod W))
‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chka4">reassociate -&gt; near (map (F ‚àò G) (bdist (prod W) (prod W))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)) ‚àò œÉ)
‚àò dec F
‚àò (map (F ‚àò G) (bdist (prod W) (prod W))
   ‚àò map (F ‚àò G) (bdist (prod W) (prod W)))
‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chka5"><span class="nb">rewrite</span> (fun_map_map (F := F ‚àò G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)) ‚àò œÉ)
‚àò dec F
‚àò map (F ‚àò G)
    (bdist (prod W) (prod W) ‚àò bdist (prod W) (prod W))
‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chka6"><span class="nb">rewrite</span> writer_dist_involution.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)) ‚àò œÉ)
‚àò dec F ‚àò map (F ‚àò G) id ‚àò map F (dec G) ‚àò map F (œÉ)
‚àò dec F ‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chka7"><span class="nb">rewrite</span> (fun_map_id (F := F ‚àò G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)) ‚àò œÉ)
‚àò dec F ‚àò id ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chka8"><span class="nb">change</span> (<span class="nl">?x</span> ‚àò id) <span class="kr">with</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (map (prod W) (Œº (prod W)) ‚àò Œº (prod W)) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* final cleanup *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chka9"><span class="nb">rewrite</span> (natural (œï := @join (prod W) _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G
     (Œº (prod W) ‚àò map (prod W ‚àò prod W) (Œº (prod W)))
   ‚àò œÉ) ‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkaa"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr) ‚àò œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (Œº (prod W))
   ‚àò map G (map (prod W ‚àò prod W) (Œº (prod W))) ‚àò 
   œÉ) ‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkab"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F)) <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr)) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G) ‚àò map F (map G (uncurry incr) ‚àò œÉ)
‚àò dec F ‚àò map F (dec G) =
map F
  (map G (Œº (prod W))
   ‚àò map G (map (prod W ‚àò prod W) (Œº (prod W))) ‚àò 
   œÉ) ‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkac"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F)) <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (uncurry incr)) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)
‚àò (map F (map G (uncurry incr)) ‚àò map F (œÉ)) ‚àò dec F
‚àò map F (dec G) =
map F
  (map G (Œº (prod W))
   ‚àò map G (map (prod W ‚àò prod W) (Œº (prod W))) ‚àò 
   œÉ) ‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkad"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> incr_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G (Œº (prod W))) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)
‚àò (map F (map G (Œº (prod W))) ‚àò map F (œÉ)) ‚àò dec F
‚àò map F (dec G) =
map F
  (map G (Œº (prod W))
   ‚àò map G (map (prod W ‚àò prod W) (Œº (prod W))) ‚àò 
   œÉ) ‚àò dec F ‚àò map F (dec G) ‚àò map F (œÉ) ‚àò dec F
‚àò map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> dec_dec_compose_5.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Unset Keyed Unification</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkae"><span class="kn">Theorem</span> <span class="nf">dec_extract_compose</span> {<span class="nv">A</span>} :
    map (F ‚àò G) (extract (W := (W √ó))) ‚àò dec (F ‚àò G) = @id (F (G A)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (F ‚àò G) extract ‚àò dec (F ‚àò G) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkaf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (F ‚àò G) extract ‚àò dec (F ‚àò G) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkb0"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (F ‚àò G) extract ‚àò dec (F ‚àò G) = id</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkb1">unfold_ops @Map_compose @Decorate_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G extract)
‚àò (map F (shift G) ‚àò dec F ‚àò map F (dec G)) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkb2"><span class="kp">repeat</span> reassociate &lt;-.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G extract) ‚àò map F (shift G) ‚àò dec F
‚àò map F (dec G) = id</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkb3">unfold_compose_in_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G extract) ‚àò map F (shift G) ‚àò dec F
‚àò map F (dec G) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkb4"><span class="nb">rewrite</span> (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G extract ‚àò shift G) ‚àò dec F
‚àò map F (dec G) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkb5"><span class="nb">rewrite</span> (shift_extract G).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G extract ‚àò extract) ‚àò dec F
‚àò map F (dec G) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkb6"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G extract) ‚àò map F extract ‚àò dec F
‚àò map F (dec G) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkb7"><span class="kp">do</span> <span class="mi">2</span> reassociate -&gt; on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G extract)
‚àò (map F extract ‚àò (dec F ‚àò map F (dec G))) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkb8">reassociate &lt;- near (map (A := W * G (W * A)) F (extract (W := (W √ó)) (A := G (W * A)))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G extract)
‚àò (map F extract ‚àò dec F ‚àò map F (dec G)) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkb9"><span class="nb">rewrite</span> (dfun_dec_extract (E := W) (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G extract) ‚àò (id ‚àò map F (dec G)) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkba"><span class="nb">change</span> (id ‚àò <span class="nl">?f</span>) <span class="kr">with</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G extract) ‚àò map F (dec G) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkbb"><span class="nb">rewrite</span> (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map G extract ‚àò dec G) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkbc"><span class="nb">rewrite</span> (dfun_dec_extract (E := W) (F := G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W F</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W F</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F id = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (fun_map_id (F := F)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Instance</span> <span class="nf">DecoratedFunctor_compose</span> : DecoratedFunctor W (F ‚àò G) :=
    {| dfun_dec_natural := Natural_dec_compose;
       dfun_dec_dec := @dec_dec_compose;
       dfun_dec_extract := @dec_extract_compose;
    |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Decoratedfunctor_composition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Category laws for composition of decorated functors *)</span>
<span class="sd">(** Next we prove that composition of decorated functors satisfies the</span>
<span class="sd">    laws of a category, i.e. that composition with the identity</span>
<span class="sd">    decorated functor on the left or is the identity, and that</span>
<span class="sd">    composition is associative. This is not immediately obvious</span>
<span class="sd">    because in each case we must verify that the &lt;&lt;dec&gt;&gt; operation is</span>
<span class="sd">    the same for both sides. *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">DecoratedFunctor_composition_laws</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">identity_laws</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** Let &lt;&lt;T&gt;&gt; be a decorated functor. *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
      `{Functor T}
      `{dec_T : Decorate W T}
      `{op : Monoid_op W}
      `{unit : Monoid_unit W}
      `{! DecoratedFunctor W T}
      `{! Monoid W}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** Composition with a zero-decorated functor *)</span>
    <span class="sd">(** When &lt;&lt;F&gt;&gt; has a trivial decoration,</span>
<span class="sd">        &lt;&lt;dec (F ‚àòT)&gt;&gt; and &lt;&lt;dec (T ‚àò F)&gt;&gt; have a special form. *)</span>
    <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">zero_decorated_composition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
      <span class="sd">(** Let &lt;&lt;F&gt;&gt; be a functor, which we will treat as zero-decorated. *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
        (<span class="nv">F</span> : <span class="kt">Type</span> -&gt; <span class="kt">Type</span>)
        `{Functor F}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
      <span class="sd">(** Composition with a zero-decorated functor on the left returns &lt;&lt;T&gt;&gt;. *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkbd"><span class="kn">Theorem</span> <span class="nf">decorate_zero_compose_l</span> : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>),
          @dec W (F ‚àò T) (@Decorate_compose W op F _ T _ Decorate_zero dec_T) A =
          map F (dec T).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, dec (F ‚àò T) = map F (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkbe"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, dec (F ‚àò T) = map F (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkbf"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec (F ‚àò T) = map F (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkc0">unfold_ops @Decorate_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift T) ‚àò dec F ‚àò map F (dec T) =
map F (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkc1">unfold_ops @Decorate_zero.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift T) ‚àò map F (pair ∆µ) ‚àò map F (dec T) =
map F (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkc2"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift T ‚àò pair ∆µ ‚àò dec T) = map F (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkc3">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift T ‚àò pair ∆µ ‚àò dec T = dec T</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkc4"><span class="nb">unfold</span> shift.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (uncurry incr) ‚àò œÉ ‚àò pair ∆µ ‚àò dec T = dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkc5">reassociate -&gt; near (pair ∆µ).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (uncurry incr) ‚àò (œÉ ‚àò pair ∆µ) ‚àò dec T = dec T</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkc6"><span class="nb">rewrite</span> strength_2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (uncurry incr) ‚àò map T (pair ∆µ) ‚àò dec T = dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkc7"><span class="nb">rewrite</span> (fun_map_map (F := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (uncurry incr ‚àò pair ∆µ) ‚àò dec T = dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkc8"><span class="nb">change</span> (pair ∆µ) <span class="kr">with</span> (ret (W √ó) (W * A)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (uncurry incr ‚àò Œ∑ (prod W) (W * A)) ‚àò dec T =
dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkc9"><span class="nb">rewrite</span> incr_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (Œº (prod W) ‚àò Œ∑ (prod W) (W * A)) ‚àò dec T =
dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkca"><span class="nb">rewrite</span> (mon_join_ret (T := prod W)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T id ‚àò dec T = dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (fun_map_id (F := T)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
      <span class="sd">(** Composition with the identity functor on the left returns &lt;&lt;T&gt;&gt;. *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkcb"><span class="kn">Theorem</span> <span class="nf">decorate_zero_compose_r</span> : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>),
          @dec W (T ‚àò F) (@Decorate_compose W op T _ F _ dec_T Decorate_zero) A =
          map T œÉ ‚àò dec T.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, dec (T ‚àò F) = map T (œÉ) ‚àò dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkcc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, dec (T ‚àò F) = map T (œÉ) ‚àò dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkcd"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec (T ‚àò F) = map T (œÉ) ‚àò dec T</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkce">unfold_ops @Decorate_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (shift F) ‚àò dec T ‚àò map T (dec F) =
map T (œÉ) ‚àò dec T</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkcf">unfold_ops @Decorate_zero.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (shift F) ‚àò dec T ‚àò map T (map F (pair ∆µ)) =
map T (œÉ) ‚àò dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkd0">reassociate -&gt; on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (shift F) ‚àò (dec T ‚àò map T (map F (pair ∆µ))) =
map T (œÉ) ‚àò dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkd1"><span class="nb">rewrite</span> &lt;- (natural (œï := @dec W T _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (shift F)
‚àò (map (T ‚óã prod W) (map F (pair ∆µ)) ‚àò dec T) =
map T (œÉ) ‚àò dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkd2">reassociate &lt;-.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (shift F) ‚àò map (T ‚óã prod W) (map F (pair ∆µ))
‚àò dec T = map T (œÉ) ‚àò dec T</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkd3">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (shift F) ‚àò map (T ‚óã prod W) (map F (pair ∆µ)) =
map T (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkd4">unfold_ops @Map_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (shift F)
‚àò map T (map (prod W) (map F (pair ∆µ))) = map T (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkd5"><span class="nb">rewrite</span> (fun_map_map (F := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (shift F ‚àò map (prod W) (map F (pair ∆µ))) =
map T (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkd6">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift F ‚àò map (prod W) (map F (pair ∆µ)) = œÉ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkd7">ext [w t]; <span class="nb">unfold</span> compose; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>F A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift F (id w, map F (pair ∆µ) t) = map F (pair w) t</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkd8"><span class="nb">unfold</span> id.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>F A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift F (w, map F (pair ∆µ) t) = map F (pair w) t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkd9"><span class="nb">rewrite</span> (shift_spec F).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>F A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m))
  (map F (pair ∆µ) t) = map F (pair w) t</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkda">compose near t on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>F A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map F (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m)) ‚àò map F (pair ∆µ))
  t = map F (pair w) t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkdb"><span class="nb">rewrite</span> (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>F A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m) ‚àò pair ∆µ) t =
map F (pair w) t</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkdc">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>F A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m) ‚àò pair ∆µ = pair w</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkdd">ext a; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance0</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>F A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(w ‚óè ∆µ, id a) = (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> simpl_monoid.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">zero_decorated_composition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** Composition with the identity decorated functor *)</span>
    <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkde"><span class="kn">Theorem</span> <span class="nf">decorate_identity_compose_l</span> : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>),
        @dec W ((<span class="kr">fun</span> <span class="nv">A</span> =&gt; A) ‚àò T) (@Decorate_compose W op (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A) _ T _ Decorate_zero dec_T) A =
        dec T.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
dec ((<span class="kr">fun</span> <span class="nv">A0</span> : <span class="kt">Type</span> =&gt; A0) ‚àò T) = dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkdf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
dec ((<span class="kr">fun</span> <span class="nv">A0</span> : <span class="kt">Type</span> =&gt; A0) ‚àò T) = dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chke0"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec ((<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A) ‚àò T) = dec T</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (decorate_zero_compose_l (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chke1"><span class="kn">Theorem</span> <span class="nf">decorate_identity_compose_r</span> : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>),
        @dec W (T ‚àò (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A)) (@Decorate_compose W op T _ (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A) _ dec_T Decorate_zero) A =
        dec T.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
dec (T ‚àò (<span class="kr">fun</span> <span class="nv">A0</span> : <span class="kt">Type</span> =&gt; A0)) = dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chke2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
dec (T ‚àò (<span class="kr">fun</span> <span class="nv">A0</span> : <span class="kt">Type</span> =&gt; A0)) = dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chke3"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec (T ‚àò (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A)) = dec T</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chke4"><span class="nb">rewrite</span> (decorate_zero_compose_r (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T (œÉ) ‚àò dec T = dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chke5"><span class="nb">rewrite</span> strength_I.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Functor T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>dec_T</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T id ‚àò dec T = dec T</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (fun_map_id (F := T)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">identity_laws</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">associativity_law</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
      `{op : Monoid_op W}
      `{unit : Monoid_unit W}
      `{! Monoid W}
      `{Map T1} `{Map T2} `{Map T3}
      `{dec_T1 : Decorate W T1}
      `{dec_T2 : Decorate W T2}
      `{dec_T3 : Decorate W T3}
      `{! DecoratedFunctor W T1}
      `{! DecoratedFunctor W T2}
      `{! DecoratedFunctor W T3}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chke6"><span class="kn">Lemma</span> <span class="nf">decorate_compose_assoc1</span> : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>),
        (map T2 (map T1 (Œº (A:=A) (prod W)) ‚àò œÉ ‚àò Œº (prod W)) ‚àò œÉ) =
        (map T2 (map T1 (Œº (W √ó)) ‚àò œÉ) ‚àò œÉ) ‚àò map ((W √ó) ‚àò T2) (map T1 (Œº (W √ó)) ‚àò œÉ).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
map T2 (map T1 (Œº (prod W)) ‚àò œÉ ‚àò Œº (prod W)) ‚àò œÉ =
map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chke7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
map T2 (map T1 (Œº (prod W)) ‚àò œÉ ‚àò Œº (prod W)) ‚àò œÉ =
map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chke8"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T2 (map T1 (Œº (prod W)) ‚àò œÉ ‚àò Œº (prod W)) ‚àò œÉ =
map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chke9">ext [w1 t].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map T2 (map T1 (Œº (prod W)) ‚àò œÉ ‚àò Œº (prod W)) ‚àò œÉ)
  (w1, t) =
(map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
 ‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ))
  (w1, t)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkea"><span class="nb">unfold</span> compose; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T2
  (<span class="kr">fun</span> <span class="nv">a</span> : W * (W * T1 (W * A)) =&gt;
   map T1 (Œº (prod W)) (œÉ (Œº (prod W) a)))
  (map T2 (pair w1) t) =
map T2 (map T1 (Œº (prod W)) ‚óã œÉ)
  (map T2 (pair (id w1))
     (map T2 (map T1 (Œº (prod W)) ‚óã œÉ) t))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkeb">compose near t.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map T2
   (<span class="kr">fun</span> <span class="nv">a</span> : W * (W * T1 (W * A)) =&gt;
    map T1 (Œº (prod W)) (œÉ (Œº (prod W) a)))
 ‚àò map T2 (pair w1)) t =
map T2 (map T1 (Œº (prod W)) ‚óã œÉ)
  ((map T2 (pair (id w1))
    ‚àò map T2 (map T1 (Œº (prod W)) ‚óã œÉ)) t)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkec"><span class="nb">unfold</span> id.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map T2
   (<span class="kr">fun</span> <span class="nv">a</span> : W * (W * T1 (W * A)) =&gt;
    map T1 (Œº (prod W)) (œÉ (Œº (prod W) a)))
 ‚àò map T2 (pair w1)) t =
map T2 (map T1 (Œº (prod W)) ‚óã œÉ)
  ((map T2 (pair w1)
    ‚àò map T2 (map T1 (Œº (prod W)) ‚óã œÉ)) t)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chked"><span class="nb">rewrite</span> <span class="mi">2</span>(fun_map_map (F := T2)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T2
  ((<span class="kr">fun</span> <span class="nv">a</span> : W * (W * T1 (W * A)) =&gt;
    map T1 (Œº (prod W)) (œÉ (Œº (prod W) a))) ‚àò pair w1)
  t =
map T2 (map T1 (Œº (prod W)) ‚óã œÉ)
  (map T2 (pair w1 ‚àò (map T1 (Œº (prod W)) ‚óã œÉ)) t)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkee">compose near t on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T2
  ((<span class="kr">fun</span> <span class="nv">a</span> : W * (W * T1 (W * A)) =&gt;
    map T1 (Œº (prod W)) (œÉ (Œº (prod W) a))) ‚àò pair w1)
  t =
(map T2 (map T1 (Œº (prod W)) ‚óã œÉ)
 ‚àò map T2 (pair w1 ‚àò (map T1 (Œº (prod W)) ‚óã œÉ))) t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkef"><span class="nb">rewrite</span> (fun_map_map (F := T2)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T2
  ((<span class="kr">fun</span> <span class="nv">a</span> : W * (W * T1 (W * A)) =&gt;
    map T1 (Œº (prod W)) (œÉ (Œº (prod W) a))) ‚àò pair w1)
  t =
map T2
  (map T1 (Œº (prod W)) ‚óã œÉ
   ‚àò (pair w1 ‚àò (map T1 (Œº (prod W)) ‚óã œÉ))) t</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkf0">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">a</span> : W * (W * T1 (W * A)) =&gt;
 map T1 (Œº (prod W)) (œÉ (Œº (prod W) a))) ‚àò pair w1 =
map T1 (Œº (prod W)) ‚óã œÉ
‚àò (pair w1 ‚àò (map T1 (Œº (prod W)) ‚óã œÉ))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkf1">ext [w2 t2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br><span><var>w2</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t2</var><span class="hyp-type"><b>: </b><span>T1 (W * A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="kr">fun</span> <span class="nv">a</span> : W * (W * T1 (W * A)) =&gt;
  map T1 (Œº (prod W)) (œÉ (Œº (prod W) a))) ‚àò pair w1)
  (w2, t2) =
(map T1 (Œº (prod W)) ‚óã œÉ
 ‚àò (pair w1 ‚àò (map T1 (Œº (prod W)) ‚óã œÉ))) (w2, t2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkf2"><span class="nb">unfold</span> compose; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br><span><var>w2</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t2</var><span class="hyp-type"><b>: </b><span>T1 (W * A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T1 (Œº (prod W)) (map T1 (pair (w1 ‚óè w2)) (id t2)) =
map T1 (Œº (prod W))
  (map T1 (pair w1)
     (map T1 (Œº (prod W)) (map T1 (pair w2) t2)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkf3"><span class="nb">unfold</span> id.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br><span><var>w2</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t2</var><span class="hyp-type"><b>: </b><span>T1 (W * A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T1 (Œº (prod W)) (map T1 (pair (w1 ‚óè w2)) t2) =
map T1 (Œº (prod W))
  (map T1 (pair w1)
     (map T1 (Œº (prod W)) (map T1 (pair w2) t2)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkf4">compose near t2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br><span><var>w2</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t2</var><span class="hyp-type"><b>: </b><span>T1 (W * A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map T1 (Œº (prod W)) ‚àò map T1 (pair (w1 ‚óè w2))) t2 =
map T1 (Œº (prod W))
  (map T1 (pair w1)
     ((map T1 (Œº (prod W)) ‚àò map T1 (pair w2)) t2))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkf5"><span class="nb">rewrite</span> <span class="mi">2</span>(fun_map_map (F := T1)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br><span><var>w2</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t2</var><span class="hyp-type"><b>: </b><span>T1 (W * A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T1 (Œº (prod W) ‚àò pair (w1 ‚óè w2)) t2 =
map T1 (Œº (prod W))
  (map T1 (pair w1) (map T1 (Œº (prod W) ‚àò pair w2) t2))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkf6"><span class="kp">do</span> <span class="mi">2</span> (compose near t2 on <span class="nb">right</span>; <span class="nb">rewrite</span> <span class="mi">1</span>(fun_map_map (F := T1))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br><span><var>w2</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t2</var><span class="hyp-type"><b>: </b><span>T1 (W * A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T1 (Œº (prod W) ‚àò pair (w1 ‚óè w2)) t2 =
map T1
  (Œº (prod W) ‚àò (pair w1 ‚àò (Œº (prod W) ‚àò pair w2))) t2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkf7">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br><span><var>w2</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t2</var><span class="hyp-type"><b>: </b><span>T1 (W * A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œº (prod W) ‚àò pair (w1 ‚óè w2) =
Œº (prod W) ‚àò (pair w1 ‚àò (Œº (prod W) ‚àò pair w2))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkf8">ext [w3 a].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br><span><var>w2</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t2</var><span class="hyp-type"><b>: </b><span>T1 (W * A)</span></span></span><br><span><var>w3</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Œº (prod W) ‚àò pair (w1 ‚óè w2)) (w3, a) =
(Œº (prod W) ‚àò (pair w1 ‚àò (Œº (prod W) ‚àò pair w2)))
  (w3, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkf9"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br><span><var>w2</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t2</var><span class="hyp-type"><b>: </b><span>T1 (W * A)</span></span></span><br><span><var>w3</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((w1 ‚óè w2) ‚óè w3, id a) = (w1 ‚óè (w2 ‚óè w3), id (id a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkfa">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w1</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T2 (W * T1 (W * A))</span></span></span><br><span><var>w2</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t2</var><span class="hyp-type"><b>: </b><span>T1 (W * A)</span></span></span><br><span><var>w3</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(w1 ‚óè w2) ‚óè w3 = w1 ‚óè (w2 ‚óè w3)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> monoid_assoc.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Set Keyed Unification</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkfb"><span class="kn">Theorem</span> <span class="nf">decorate_compose_assoc</span> : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>),
        @dec W (T3 ‚àò T2 ‚àò T1)
             (@Decorate_compose W op (T3 ‚àò T2) _ T1 _ _ dec_T1) A =
        @dec W (T3 ‚àò T2 ‚àò T1)
             (@Decorate_compose W op T3 _ (T2 ‚àò T1) _ dec_T3 _) A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
dec (T3 ‚àò T2 ‚àò T1) = dec (T3 ‚àò T2 ‚àò T1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkfc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
dec (T3 ‚àò T2 ‚àò T1) = dec (T3 ‚àò T2 ‚àò T1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkfd"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec (T3 ‚àò T2 ‚àò T1) = dec (T3 ‚àò T2 ‚àò T1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkfe">unfold_ops @Decorate_compose; <span class="nb">unfold</span> dec <span class="nb">at</span> <span class="mi">1</span> <span class="mi">6</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (T3 ‚àò T2) (shift T1)
‚àò (map T3 (shift T2) ‚àò dec T3 ‚àò map T3 (dec T2))
‚àò map (T3 ‚àò T2) (dec T1) =
map T3 (shift (T2 ‚àò T1)) ‚àò dec T3
‚àò map T3
    (map T2 (shift T1) ‚àò dec T2 ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chkff"><span class="kp">do</span> <span class="mi">2</span> reassociate &lt;- on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (T3 ‚àò T2) (shift T1) ‚àò map T3 (shift T2) ‚àò dec T3
‚àò map T3 (dec T2) ‚àò map (T3 ‚àò T2) (dec T1) =
map T3 (shift (T2 ‚àò T1)) ‚àò dec T3
‚àò map T3
    (map T2 (shift T1) ‚àò dec T2 ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk100"><span class="nb">rewrite</span> (fun_map_map (F := T3)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3 (map T2 (shift T1) ‚àò shift T2) ‚àò dec T3
‚àò map T3 (dec T2) ‚àò map (T3 ‚àò T2) (dec T1) =
map T3 (shift (T2 ‚àò T1)) ‚àò dec T3
‚àò map T3
    (map T2 (shift T1) ‚àò dec T2 ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk101">reassociate -&gt; near (map (T3 ‚àò T2) (dec T1));
        <span class="nb">rewrite</span> (fun_map_map (F := T3)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3 (map T2 (shift T1) ‚àò shift T2) ‚àò dec T3
‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (shift (T2 ‚àò T1)) ‚àò dec T3
‚àò map T3
    (map T2 (shift T1) ‚àò dec T2 ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk102"><span class="nb">unfold</span> shift <span class="nb">at</span> <span class="mi">1</span> <span class="mi">2</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (uncurry incr) ‚àò œÉ)
   ‚àò (map T2 (uncurry incr) ‚àò œÉ)) ‚àò dec T3
‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (shift (T2 ‚àò T1)) ‚àò dec T3
‚àò map T3
    (map T2 (shift T1) ‚àò dec T2 ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk103">reassociate &lt;- on <span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (uncurry incr) ‚àò œÉ)
   ‚àò map T2 (uncurry incr) ‚àò œÉ) ‚àò dec T3
‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (shift (T2 ‚àò T1)) ‚àò dec T3
‚àò map T3
    (map T2 (shift T1) ‚àò dec T2 ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk104"><span class="nb">rewrite</span> (fun_map_map (F := T2)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (uncurry incr) ‚àò œÉ ‚àò uncurry incr)
   ‚àò œÉ) ‚àò dec T3 ‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (shift (T2 ‚àò T1)) ‚àò dec T3
‚àò map T3
    (map T2 (shift T1) ‚àò dec T2 ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk105"><span class="kp">repeat</span> <span class="nb">rewrite</span> incr_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (Œº (prod W)) ‚àò œÉ ‚àò Œº (prod W)) ‚àò œÉ)
‚àò dec T3 ‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (shift (T2 ‚àò T1)) ‚àò dec T3
‚àò map T3
    (map T2 (shift T1) ‚àò dec T2 ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk106"><span class="nb">rewrite</span> decorate_compose_assoc1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
   ‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ))
‚àò dec T3 ‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (shift (T2 ‚àò T1)) ‚àò dec T3
‚àò map T3
    (map T2 (shift T1) ‚àò dec T2 ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk107"><span class="nb">unfold</span> shift <span class="nb">at</span> <span class="mi">1</span> <span class="mi">2</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
   ‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ))
‚àò dec T3 ‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (map (T2 ‚àò T1) (uncurry incr) ‚àò œÉ) ‚àò dec T3
‚àò map T3
    (map T2 (map T1 (uncurry incr) ‚àò œÉ) ‚àò dec T2
     ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk108"><span class="nb">change</span> (map T2 (map T1 (Œº (A:=<span class="nl">?A</span>) (prod W)) ‚àò œÉ) ‚àò dec T2 ‚àò map T2 (dec T1))
        <span class="kr">with</span> (map T2 (map T1 (Œº (A:=A) (prod W)) ‚àò œÉ) ‚àò (dec T2 ‚àò map T2 (dec T1))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
   ‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ))
‚àò dec T3 ‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (map (T2 ‚àò T1) (uncurry incr) ‚àò œÉ) ‚àò dec T3
‚àò map T3
    (map T2 (map T1 (uncurry incr) ‚àò œÉ) ‚àò dec T2
     ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk109"><span class="nb">rewrite</span> &lt;- (fun_map_map (F := T3) _ _ _ (dec T2 ‚àò map T2 (dec T1))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
   ‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ))
‚àò dec T3 ‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (map (T2 ‚àò T1) (uncurry incr) ‚àò œÉ) ‚àò dec T3
‚àò (map T3
     (H0 (W * T1 (W * A)) (T1 (W * A))
        (map T1 (uncurry incr) ‚àò œÉ))
   ‚àò map T3 (dec T2 ‚àò map T2 (dec T1)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk10a"><span class="nb">change</span> (H0 <span class="nl">?x</span> <span class="nl">?y</span> <span class="nl">?f</span>) <span class="kr">with</span> (map T2 f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
   ‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ))
‚àò dec T3 ‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (map (T2 ‚àò T1) (uncurry incr) ‚àò œÉ) ‚àò dec T3
‚àò (map T3 (map T2 (map T1 (uncurry incr) ‚àò œÉ))
   ‚àò map T3 (dec T2 ‚àò map T2 (dec T1)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      <span class="c">(* ^^ not sure why this guy got unfolded *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk10b">reassociate &lt;- on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
   ‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ))
‚àò dec T3 ‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (map (T2 ‚àò T1) (uncurry incr) ‚àò œÉ) ‚àò dec T3
‚àò map T3 (map T2 (map T1 (uncurry incr) ‚àò œÉ))
‚àò map T3 (dec T2 ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk10c"><span class="kp">repeat</span> <span class="nb">rewrite</span> incr_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
   ‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ))
‚àò dec T3 ‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (map (T2 ‚àò T1) (Œº (prod W)) ‚àò œÉ) ‚àò dec T3
‚àò map T3 (map T2 (map T1 (Œº (prod W)) ‚àò œÉ))
‚àò map T3 (dec T2 ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk10d">reassociate -&gt; near (map T3 (map T2 (map T1 (Œº (prod W)) ‚àò œÉ))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
   ‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ))
‚àò dec T3 ‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (map (T2 ‚àò T1) (Œº (prod W)) ‚àò œÉ)
‚àò (dec T3 ‚àò map T3 (map T2 (map T1 (Œº (prod W)) ‚àò œÉ)))
‚àò map T3 (dec T2 ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk10e"><span class="nb">rewrite</span> &lt;- (natural (œï := @dec W T3 _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
   ‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ))
‚àò dec T3 ‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (map (T2 ‚àò T1) (Œº (prod W)) ‚àò œÉ)
‚àò (map (T3 ‚óã prod W)
     (map T2 (map T1 (Œº (prod W)) ‚àò œÉ)) ‚àò dec T3)
‚àò map T3 (dec T2 ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk10f">reassociate &lt;- on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
   ‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ))
‚àò dec T3 ‚àò map T3 (dec T2 ‚àò map T2 (dec T1)) =
map T3 (map (T2 ‚àò T1) (Œº (prod W)) ‚àò œÉ)
‚àò map (T3 ‚óã prod W) (map T2 (map T1 (Œº (prod W)) ‚àò œÉ))
‚àò dec T3 ‚àò map T3 (dec T2 ‚àò map T2 (dec T1))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk110">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
   ‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ))
‚àò dec T3 =
map T3 (map (T2 ‚àò T1) (Œº (prod W)) ‚àò œÉ)
‚àò map (T3 ‚óã prod W) (map T2 (map T1 (Œº (prod W)) ‚àò œÉ))
‚àò dec T3</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk111">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
   ‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ)) =
map T3 (map (T2 ‚àò T1) (Œº (prod W)) ‚àò œÉ)
‚àò map (T3 ‚óã prod W) (map T2 (map T1 (Œº (prod W)) ‚àò œÉ))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk112"><span class="nb">rewrite</span> (fun_map_map (F := T3)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T3
  (map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
   ‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ)) =
map T3
  (map (T2 ‚àò T1) (Œº (prod W)) ‚àò œÉ
   ‚àò map (prod W) (map T2 (map T1 (Œº (prod W)) ‚àò œÉ)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk113">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ) =
map (T2 ‚àò T1) (Œº (prod W)) ‚àò œÉ
‚àò map (prod W) (map T2 (map T1 (Œº (prod W)) ‚àò œÉ))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk114"><span class="nb">rewrite</span> strength_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ) =
map (T2 ‚àò T1) (Œº (prod W)) ‚àò (map T2 (œÉ) ‚àò œÉ)
‚àò map (prod W) (map T2 (map T1 (Œº (prod W)) ‚àò œÉ))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk115">reassociate &lt;- on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>Monoid0</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>T1</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T1</span></span></span><br><span><var>T2</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Map T2</span></span></span><br><span><var>T3</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map T3</span></span></span><br><span><var>dec_T1</var><span class="hyp-type"><b>: </b><span>Decorate W T1</span></span></span><br><span><var>dec_T2</var><span class="hyp-type"><b>: </b><span>Decorate W T2</span></span></span><br><span><var>dec_T3</var><span class="hyp-type"><b>: </b><span>Decorate W T3</span></span></span><br><span><var>DecoratedFunctor0</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T1</span></span></span><br><span><var>DecoratedFunctor1</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T2</span></span></span><br><span><var>DecoratedFunctor2</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T3</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map T2 (map T1 (Œº (prod W)) ‚àò œÉ) ‚àò œÉ
‚àò map (prod W ‚àò T2) (map T1 (Œº (prod W)) ‚àò œÉ) =
map (T2 ‚àò T1) (Œº (prod W)) ‚àò map T2 (œÉ) ‚àò œÉ
‚àò map (prod W) (map T2 (map T1 (Œº (prod W)) ‚àò œÉ))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (fun_map_map (F := T2)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Unset Keyed Unification</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">associativity_law</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">DecoratedFunctor_composition_laws</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Composition with zero-decorated functors *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">DecoratedFunctor_zero_composition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    (<span class="nv">F</span> <span class="nv">G</span> : <span class="kt">Type</span> -&gt; <span class="kt">Type</span>)
    `{Monoid W}
    `{Functor F}
    `{DecoratedFunctor W G}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span>: Decorate W F := Decorate_zero.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk116"><span class="kn">Theorem</span> <span class="nf">decorate_zero_compose</span> {<span class="nv">A</span>} :
    `(dec (F ‚àò G) (A := A) = map F (dec G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec (F ‚àò G) = map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk117"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec (F ‚àò G) = map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk118"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec (F ‚àò G) = map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk119">unfold_ops @Decorate_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò dec F ‚àò map F (dec G) =
map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk11a">unfold_ops @Decorate_instance_0 @Decorate_zero.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò map F (pair ∆µ) ‚àò map F (dec G) =
map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk11b">reassociate -&gt; near (map F (dec G)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G) ‚àò (map F (pair ∆µ) ‚àò map F (dec G)) =
map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk11c"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> (fun_map_map (F := F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G ‚àò (pair ∆µ ‚àò dec G)) = map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk11d">reassociate &lt;-.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (shift G ‚àò pair ∆µ ‚àò dec G) = map F (dec G)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk11e"><span class="nb">replace</span> (shift G ‚àò (<span class="kr">fun</span> <span class="nv">a</span> : G (W * A) =&gt; (∆µ, a))) <span class="kr">with</span> (@id (G (W * A))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map F (id ‚àò dec G) = map F (dec G)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decoratedfunctor-v-chk11f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><label class="goal-separator" for="decoratedfunctor-v-chk11f"><hr></label><div class="goal-conclusion">id = shift G ‚àò (<span class="kr">fun</span> <span class="nv">a</span> : G (W * A) =&gt; (∆µ, a))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk120"><span class="bp">now</span> <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">id = shift G ‚àò (<span class="kr">fun</span> <span class="nv">a</span> : G (W * A) =&gt; (∆µ, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk121">ext g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G (W * A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">id g = (shift G ‚àò (<span class="kr">fun</span> <span class="nv">a</span> : G (W * A) =&gt; (∆µ, a))) g</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk122"><span class="nb">unfold</span> compose; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, G</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>map_instance</var><span class="hyp-type"><b>: </b><span>Map F</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Functor F</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Map G</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Decorate W G</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W G</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>G (W * A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">id g = shift G (∆µ, g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (shift_zero G).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">DecoratedFunctor_zero_composition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Decorated monads in terms of monad homomorphisms *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">DecoratedMonad_characterization</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    `{Categorical.Monad.Monad T} `{Decorate W T} `{Monoid W}
    `{! Categorical.DecoratedFunctor.DecoratedFunctor W T}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** &lt;&lt;ret T&gt;&gt; commutes with decoration if and only if &lt;&lt;dec T&gt;&gt; maps</span>
<span class="sd">     &lt;&lt;ret T&gt;&gt; to &lt;&lt;ret (T ‚àò W)&gt;&gt; *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk123"><span class="kn">Lemma</span> <span class="nf">dec_ret_iff</span> {<span class="nv">A</span>} :
    (dec T ‚àò ret T A = ret T (W * A) ‚àò dec (<span class="kr">fun</span> <span class="nv">x</span> =&gt; x) (A:=A)) &lt;-&gt;
    (dec T ‚àò ret T A = ret (T ‚àò prod W) A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec T ‚àò Œ∑ T A = Œ∑ T (W * A) ‚àò dec (<span class="kr">fun</span> <span class="nv">x</span> : <span class="kt">Type</span> =&gt; x) &lt;-&gt;
dec T ‚àò Œ∑ T A = Œ∑ (T ‚àò prod W) A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk124"><span class="kn">Proof with</span> <span class="nb">auto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec T ‚àò Œ∑ T A = Œ∑ T (W * A) ‚àò dec (<span class="kr">fun</span> <span class="nv">x</span> : <span class="kt">Type</span> =&gt; x) &lt;-&gt;
dec T ‚àò Œ∑ T A = Œ∑ (T ‚àò prod W) A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>...</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** &lt;&lt;join T&gt;&gt; commutes with decoration if and only if &lt;&lt;dec T&gt;&gt;</span>
<span class="sd">     maps &lt;&lt;join T&gt;&gt; to &lt;&lt;join (T ‚àò prod W)&gt;&gt; of &lt;&lt;dec T ‚àò map T (dec T)&gt;&gt;</span>
<span class="sd">     (in other words iff &lt;&lt;dec T&gt;&gt; commutes with &lt;&lt;join&gt;&gt;). *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk125"><span class="kn">Lemma</span> <span class="nf">dec_join_iff</span> {<span class="nv">A</span>} :
    `(dec T ‚àò join T = join T ‚àò dec (T ‚àò T) (A := A)) &lt;-&gt;
    `(dec T ‚àò join T = join (T ‚àò prod W) ‚àò dec T ‚àò map T (dec T (A:=A))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec T ‚àò Œº T = Œº T ‚àò dec (T ‚àò T) &lt;-&gt;
dec T ‚àò Œº T = Œº (T ‚àò prod W) ‚àò dec T ‚àò map T (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk126"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec T ‚àò Œº T = Œº T ‚àò dec (T ‚àò T) &lt;-&gt;
dec T ‚àò Œº T = Œº (T ‚àò prod W) ‚àò dec T ‚àò map T (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk127"><span class="nb">enough</span> (Heq : join T ‚àò dec (A := A) (T ‚àò T)
                  = join (T ‚àò prod W) ‚àò dec T ‚àò map T (dec T))
      <span class="bp">by</span> (<span class="nb">split</span>; <span class="nb">intro</span> hyp; <span class="bp">now</span> <span class="nb">rewrite</span> hyp).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œº T ‚àò dec (T ‚àò T) =
Œº (T ‚àò prod W) ‚àò dec T ‚àò map T (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk128">unfold_ops @Join_Beck @Decorate_compose @BeckDistribution_strength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œº T ‚àò (map T (shift T) ‚àò dec T ‚àò map T (dec T)) =
map T (Œº (prod W)) ‚àò Œº T ‚àò map T (œÉ) ‚àò dec T
‚àò map T (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk129"><span class="kp">repeat</span> reassociate &lt;-.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œº T ‚àò map T (shift T) ‚àò dec T ‚àò map T (dec T) =
map T (Œº (prod W)) ‚àò Œº T ‚àò map T (œÉ) ‚àò dec T
‚àò map T (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk12a">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œº T ‚àò map T (shift T) ‚àò dec T =
map T (Œº (prod W)) ‚àò Œº T ‚àò map T (œÉ) ‚àò dec T</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk12b">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œº T ‚àò map T (shift T) =
map T (Œº (prod W)) ‚àò Œº T ‚àò map T (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk12c"><span class="nb">rewrite</span> (natural (œï := @join T _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œº T ‚àò map T (shift T) =
Œº T ‚àò map (T ‚àò T) (Œº (prod W)) ‚àò map T (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk12d">unfold_ops @Map_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œº T ‚àò map T (shift T) =
Œº T ‚àò map T (map T (Œº (prod W))) ‚àò map T (œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk12e">reassociate -&gt; on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œº T ‚àò map T (shift T) =
Œº T ‚àò (map T (map T (Œº (prod W))) ‚àò map T (œÉ))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk12f">unfold_compose_in_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œº T ‚àò map T (shift T) =
Œº T ‚àò (map T (map T (Œº (prod W))) ‚àò map T (œÉ))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk130"><span class="nb">rewrite</span> (fun_map_map (F := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œº T ‚àò map T (shift T) =
Œº T ‚àò map T (map T (Œº (prod W)) ‚àò œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk131"><span class="nb">unfold</span> shift.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œº T ‚àò map T (map T (uncurry incr) ‚àò œÉ) =
Œº T ‚àò map T (map T (Œº (prod W)) ‚àò œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedfunctor-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedfunctor-v-chk132"><span class="nb">rewrite</span> incr_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Map T</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Join T</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>Monad T</span></span></span><br><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>Decorate W T</span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H4</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>H5</var><span class="hyp-type"><b>: </b><span>DecoratedFunctor W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œº T ‚àò map T (map T (Œº (prod W)) ‚àò œÉ) =
Œº T ‚àò map T (map T (Œº (prod W)) ‚àò œÉ)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="c">(* TODO Prove (T ‚àò prod W) is a monad *)</span>
  <span class="c">(*</span>
<span class="c">  Theorem decorated_monad_compatibility_spec :</span>
<span class="c">    Monad_Hom T (T ‚àò prod W) (@dec W T _) &lt;-&gt;</span>
<span class="c">    DecoratePreservingTransformation (fun A =&gt; A) T (ret T) /\</span>
<span class="c">    DecoratePreservingTransformation (T ‚àò T) T (@join T _).</span>
<span class="c">  Proof with auto.</span>
<span class="c">    split.</span>
<span class="c">    - introv mhom. inverts mhom. inverts mhom_domain. split.</span>
<span class="c">      + constructor...</span>
<span class="c">        introv. symmetry. rewrite dec_ret_iff. apply mhom_ret.</span>
<span class="c">      + constructor...</span>
<span class="c">        introv. symmetry. rewrite dec_join_iff. apply mhom_join.</span>
<span class="c">    - intros [h1 h2]. inverts h1. inverts h2.</span>
<span class="c">      constructor; try typeclasses eauto.</span>
<span class="c">      + admit.</span>
<span class="c">      + admit.</span>
<span class="c">      + introv  rewrite &lt;- dec_ret_iff...</span>
<span class="c">      + introv. rewrite &lt;- dec_join_iff...</span>
<span class="c">  Qed.</span>

<span class="c">  Theorem decorated_monad_spec :</span>
<span class="c">    Categorical.DecoratedMonad.DecoratedMonad W T &lt;-&gt;</span>
<span class="c">      Monad_Hom T (T ‚àò prod W) (@dec W T _).</span>
<span class="c">  Proof with try typeclasses eauto.</span>
<span class="c">    rewrite decorated_monad_compatibility_spec.</span>
<span class="c">    split; intro hyp.</span>
<span class="c">    - inversion hyp. constructor...</span>
<span class="c">      + constructor... intros. now rewrite (dmon_ret (W := W) (T := T)).</span>
<span class="c">      + constructor... intros. now rewrite (dmon_join (W := W) (T := T)).</span>
<span class="c">    - destruct hyp as [hyp1 hyp2]. constructor...</span>
<span class="c">      + intros. inversion hyp1. now rewrite dectrans_commute.</span>
<span class="c">      + intros. inversion hyp2. now rewrite &lt;- dectrans_commute.</span>
<span class="c">  Qed.</span>
<span class="c">   *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">DecoratedMonad_characterization</span>.</span></span></pre>
</div>
</div></body>
</html>
