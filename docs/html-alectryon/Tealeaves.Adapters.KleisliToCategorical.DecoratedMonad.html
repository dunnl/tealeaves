<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.21.2: https://docutils.sourceforge.io/" />
<title>DecoratedMonad.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.16.0+0.16.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Tealeaves <span class="kn">Require Export</span>
  Classes.Categorical.DecoratedMonad
  Classes.Kleisli.DecoratedMonad
  Classes.Kleisli.Comonad.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> DecoratedMonad.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Product.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Monoid.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Functor.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Comonad.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Notation</span> <span class="s2">&quot;( X  √ó )&quot;</span> := (prod X) : function_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Generalizable Variables</span> <span class="nf">T</span> A B C.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Decorated monads from Kleisli decorated monads *)</span>
<span class="sd">(******************************************************************************)</span>

<span class="sd">(** ** Operations *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">operations</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    (<span class="nv">W</span> : <span class="kt">Type</span>)
    (<span class="nv">T</span> : <span class="kt">Type</span> -&gt; <span class="kt">Type</span>)
    `{Bindd W T T}
    `{Return T}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Instance</span> <span class="nf">Map_Bindd</span>: Map T :=
    <span class="kr">fun</span> <span class="nv">A</span> <span class="nv">B</span> <span class="nv">f</span> =&gt; bindd (ret ‚àò f ‚àò extract).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">Join_Bindd</span>: Join T :=
    <span class="kr">fun</span> <span class="nv">A</span> =&gt; bindd (B := A) (A := T A) (extract (W := (W √ó))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">Decorate_Bindd</span>: Decorate W T :=
    <span class="kr">fun</span> <span class="nv">A</span> =&gt; bindd (ret (A := W * A)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">operations</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Derived laws *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">ToCategorical</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">with_monad</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
      (<span class="nv">W</span> : <span class="kt">Type</span>)
      (<span class="nv">T</span> : <span class="kt">Type</span> -&gt; <span class="kt">Type</span>)
      `{Kleisli.DecoratedMonad.DecoratedMonad W T}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">Existing Instances Map_Bindd Join_Bindd Decorate_Bindd.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** Functor laws *)</span>
    <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk0"><span class="kn">Lemma</span> <span class="nf">map_id</span> : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>),
        map (@id A) = @id (T A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, map id = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, map id = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk2"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map id = id</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk3">unfold_ops @Map_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò id ‚àò extract) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk4"><span class="nb">change</span> (ret ‚àò id) <span class="kr">with</span> (ret (A := A)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò extract) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (kmond_bindd1 (T := T)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk5"><span class="kn">Lemma</span> <span class="nf">map_map</span> : <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B) (<span class="nv">g</span> : B -&gt; C),
        map g ‚àò map f = map (F := T) (g ‚àò f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B) (<span class="nv">g</span> : B -&gt; C),
map g ‚àò map f = map (g ‚àò f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B) (<span class="nv">g</span> : B -&gt; C),
map g ‚àò map f = map (g ‚àò f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk7"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map g ‚àò map f = map (g ‚àò f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk8">unfold_ops @Map_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò g ‚àò extract) ‚àò bindd (ret ‚àò f ‚àò extract) =
bindd (ret ‚àò (g ‚àò f) ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk9"><span class="nb">rewrite</span> (kmond_bindd2 (T := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò g ‚àò extract ‚ãÜ<span class="mi">5</span> ret ‚àò f ‚àò extract) =
bindd (ret ‚àò (g ‚àò f) ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chka"><span class="nb">rewrite</span> kc5_00.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò g ‚àò f ‚àò extract) =
bindd (ret ‚àò (g ‚àò f) ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Instance</span>: Classes.Functor.Functor T :=
      {| fun_map_id := map_id;
        fun_map_map := map_map;
      |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** Monad laws *)</span>
    <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chkb"><span class="kn">Lemma</span> <span class="nf">ret_natural</span> : Natural (@ret T _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Natural (@ret T ret_inst)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chkc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Natural (@ret T ret_inst)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chkd"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Functor (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decoratedmonad-v-chke" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><label class="goal-separator" for="decoratedmonad-v-chke"><hr></label><div class="goal-conclusion">Functor T</div></blockquote><input class="alectryon-extra-goal-toggle" id="decoratedmonad-v-chkf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><label class="goal-separator" for="decoratedmonad-v-chkf"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
map f ‚àò ret = ret ‚àò map f</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk10">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Functor (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk11">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Functor T</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk12">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
map f ‚àò ret = ret ‚àò map f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk13"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f ‚àò ret = ret ‚àò map f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk14">unfold_ops @Map_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò f ‚àò extract) ‚àò ret = ret ‚àò map f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk15"><span class="nb">rewrite</span> (kmond_bindd0 (T := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ret ‚àò f ‚àò extract ‚àò ret = ret ‚àò map f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk16"><span class="kn">Lemma</span> <span class="nf">join_natural</span> : Natural (@join T _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Natural (@join T (Join_Bindd W T))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk17"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Natural (@join T (Join_Bindd W T))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk18"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Functor (T ‚àò T)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decoratedmonad-v-chk19" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><label class="goal-separator" for="decoratedmonad-v-chk19"><hr></label><div class="goal-conclusion">Functor T</div></blockquote><input class="alectryon-extra-goal-toggle" id="decoratedmonad-v-chk1a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><label class="goal-separator" for="decoratedmonad-v-chk1a"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
map f ‚àò join = join ‚àò map f</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk1b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Functor (T ‚àò T)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk1c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Functor T</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk1d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
map f ‚àò join = join ‚àò map f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk1e"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f ‚àò join = join ‚àò map f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk1f">unfold_ops @Map_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f ‚àò join = join ‚àò map (map f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk20">unfold_ops @Map_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò f ‚àò extract) ‚àò join =
join
‚àò bindd (ret ‚àò bindd (ret ‚àò f ‚àò extract) ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk21">unfold_ops @Join_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò f ‚àò extract) ‚àò bindd extract =
bindd extract
‚àò bindd (ret ‚àò bindd (ret ‚àò f ‚àò extract) ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk22">unfold_compose_in_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò f ‚àò extract) ‚àò bindd extract =
bindd extract
‚àò bindd (ret ‚àò bindd (ret ‚àò f ‚àò extract) ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk23"><span class="nb">rewrite</span> (kmond_bindd2 (T := T)). <span class="c">(* left *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò f ‚àò extract ‚ãÜ<span class="mi">5</span> extract) =
bindd extract
‚àò bindd (ret ‚àò bindd (ret ‚àò f ‚àò extract) ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk24"><span class="nb">rewrite</span> (kmond_bindd2 (T := T)). <span class="c">(* right *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò f ‚àò extract ‚ãÜ<span class="mi">5</span> extract) =
bindd
  (extract
   ‚ãÜ<span class="mi">5</span> ret ‚àò bindd (ret ‚àò f ‚àò extract) ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk25"><span class="nb">rewrite</span> kc5_05.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (map f ‚àò extract) =
bindd
  (extract
   ‚ãÜ<span class="mi">5</span> ret ‚àò bindd (ret ‚àò f ‚àò extract) ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk26"><span class="nb">rewrite</span> kc5_50.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (map f ‚àò extract) =
bindd (extract ‚àò map (bindd (ret ‚àò f ‚àò extract)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk27"><span class="nb">rewrite</span> map_to_cobind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (map f ‚àò extract) =
bindd
  (extract
   ‚àò cobind (bindd (ret ‚àò f ‚àò extract) ‚àò extract))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk28"><span class="nb">rewrite</span> kcom_cobind0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (map f ‚àò extract) =
bindd (bindd (ret ‚àò f ‚àò extract) ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk29"><span class="kn">Lemma</span> <span class="nf">join_ret</span> : `(join (T := T) ‚àò ret (T := T) = @id (T A)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, join ‚àò ret = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk2a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, join ‚àò ret = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk2b"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">join ‚àò ret = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk2c">unfold_ops @Join_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd extract ‚àò ret = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk2d">unfold_compose_in_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd extract ‚àò ret = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk2e"><span class="nb">rewrite</span> (kmond_bindd0 (T := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">extract ‚àò ret = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk2f"><span class="kn">Lemma</span> <span class="nf">join_map_ret</span> : `(join (T := T) ‚àò map (F := T) ret = @id (T A)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, join ‚àò map ret = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk30"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, join ‚àò map ret = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk31"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">join ‚àò map ret = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk32">unfold_ops @Map_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">join ‚àò bindd (ret ‚àò ret ‚àò extract) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk33">unfold_ops @Join_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd extract ‚àò bindd (ret ‚àò ret ‚àò extract) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk34">unfold_compose_in_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd extract ‚àò bindd (ret ‚àò ret ‚àò extract) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk35"><span class="nb">rewrite</span> (kmond_bindd2 (T := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (extract ‚ãÜ<span class="mi">5</span> ret ‚àò ret ‚àò extract) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk36"><span class="nb">rewrite</span> kc5_50.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (extract ‚àò map ret) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk37"><span class="nb">rewrite</span> map_to_cobind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (extract ‚àò cobind (ret ‚àò extract)) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk38"><span class="nb">rewrite</span> kcom_cobind0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò extract) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk39"><span class="nb">rewrite</span> (kmond_bindd1 (T := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">id = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk3a"><span class="kn">Lemma</span> <span class="nf">join_join</span> :
      `(join ‚àò join (T := T) (A := T A) =
          join ‚àò map (F := T) join).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, join ‚àò join = join ‚àò map join</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk3b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, join ‚àò join = join ‚àò map join</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk3c"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">join ‚àò join = join ‚àò map join</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      <span class="c">(* Merge LHS *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk3d">unfold_ops @Join_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd extract ‚àò bindd extract =
bindd extract ‚àò map (bindd extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk3e">unfold_compose_in_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd extract ‚àò bindd extract =
bindd extract ‚àò map (bindd extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk3f"><span class="nb">rewrite</span> (kmond_bindd2 (T := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (extract ‚ãÜ<span class="mi">5</span> extract) =
bindd extract ‚àò map (bindd extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      <span class="c">(* Merge RHS *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk40">unfold_ops @Map_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (extract ‚ãÜ<span class="mi">5</span> extract) =
bindd extract ‚àò bindd (ret ‚àò bindd extract ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk41"><span class="nb">rewrite</span> (kmond_bindd2 (T := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (extract ‚ãÜ<span class="mi">5</span> extract) =
bindd (extract ‚ãÜ<span class="mi">5</span> ret ‚àò bindd extract ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk42">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">extract ‚ãÜ<span class="mi">5</span> extract =
extract ‚ãÜ<span class="mi">5</span> ret ‚àò bindd extract ‚àò extract</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk43"><span class="nb">rewrite</span> kc5_50.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">extract ‚ãÜ<span class="mi">5</span> extract = extract ‚àò map (bindd extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk44"><span class="nb">rewrite</span> map_to_cobind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">extract ‚ãÜ<span class="mi">5</span> extract =
extract ‚àò cobind (bindd extract ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk45"><span class="nb">rewrite</span> kcom_cobind0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">extract ‚ãÜ<span class="mi">5</span> extract = bindd extract ‚àò extract</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk46"><span class="nb">unfold</span> kc5.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> &#39;(w, a) =&gt; bindd (extract ‚¶ø w) (extract (w, a))) =
bindd extract ‚àò extract</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk47"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> &#39;(w, a) =&gt; bindd (extract ‚¶ø w) a) =
bindd extract ‚àò extract</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk48">ext [w t].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T (T A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (extract ‚¶ø w) t =
(bindd extract ‚àò extract) (w, t)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk49"><span class="nb">setoid_rewrite</span> extract_preincr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T (T A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd extract t = (bindd extract ‚àò extract) (w, t)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Instance</span>: Categorical.Monad.Monad T :=
      {| Monad.mon_ret_natural := ret_natural;
        mon_join_natural := join_natural;
        mon_join_ret := join_ret;
        mon_join_map_ret := join_map_ret;
        mon_join_join := join_join;
      |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** Decorated functor laws *)</span>
    <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk4a"><span class="kn">Lemma</span> <span class="nf">dec_dec</span> : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>),
        dec T ‚àò dec T = map (F := T) (cojoin (W := (W √ó))) ‚àò dec T (A := A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, dec T ‚àò dec T = map coŒº ‚àò dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk4b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, dec T ‚àò dec T = map coŒº ‚àò dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk4c"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec T ‚àò dec T = map coŒº ‚àò dec T</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      <span class="c">(* Merge LHS *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk4d">unfold_ops @Decorate_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd ret ‚àò bindd ret = map coŒº ‚àò bindd ret</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk4e"><span class="nb">rewrite</span> (kmond_bindd2 (T := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚ãÜ<span class="mi">5</span> ret) = map coŒº ‚àò bindd ret</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      <span class="c">(* Merge RHS *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk4f">unfold_ops @Map_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚ãÜ<span class="mi">5</span> ret) =
bindd (ret ‚àò coŒº ‚àò extract) ‚àò bindd ret</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk50"><span class="nb">rewrite</span> (kmond_bindd2 (T := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚ãÜ<span class="mi">5</span> ret) =
bindd (ret ‚àò coŒº ‚àò extract ‚ãÜ<span class="mi">5</span> ret)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk51">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ret ‚ãÜ<span class="mi">5</span> ret = ret ‚àò coŒº ‚àò extract ‚ãÜ<span class="mi">5</span> ret</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk52"><span class="nb">rewrite</span> kc5_05.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ret ‚ãÜ<span class="mi">5</span> ret = map coŒº ‚àò ret</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk53"><span class="nb">change</span> (ret (T := T) (A := W * A)) <span class="kr">with</span>
        (ret (T := T) (A := W * A) ‚àò id) <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ret ‚ãÜ<span class="mi">5</span> ret ‚àò id = map coŒº ‚àò ret</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk54"><span class="nb">rewrite</span> kc5_54.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kc4 ret id = map coŒº ‚àò ret</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk55"><span class="nb">unfold</span> kc4.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ret ‚àò cobind id = map coŒº ‚àò ret</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk56"><span class="nb">rewrite</span> (natural (œï := @ret T _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ret ‚àò cobind id = ret ‚àò map coŒº</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk57"><span class="kn">Lemma</span> <span class="nf">dec_extract</span> : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>),
        map (F := T) (extract (W := (W √ó))) ‚àò dec T = @id (T A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, map extract ‚àò dec T = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk58"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, map extract ‚àò dec T = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk59"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map extract ‚àò dec T = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk5a">unfold_ops @Decorate_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map extract ‚àò bindd ret = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk5b">unfold_ops @Map_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò extract ‚àò extract) ‚àò bindd ret = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk5c"><span class="nb">rewrite</span> (kmond_bindd2 (T := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò extract ‚àò extract ‚ãÜ<span class="mi">5</span> ret) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk5d"><span class="nb">change</span> (ret (A := W * A)) <span class="kr">with</span> (ret (A := W * A) ‚àò @id (W * A)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò extract ‚àò extract ‚ãÜ<span class="mi">5</span> ret ‚àò id) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk5e"><span class="nb">rewrite</span> kc5_05.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (map extract ‚àò (ret ‚àò id)) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk5f"><span class="nb">change</span> (<span class="nl">?f</span> ‚àò id) <span class="kr">with</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (map extract ‚àò ret) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk60"><span class="nb">rewrite</span> (natural (œï := @ret T _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò map extract) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (kmond_bindd1 (T := T)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk61"><span class="kn">Lemma</span> <span class="nf">dec_natural</span> : Natural (@dec W T _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Natural (@dec W T (Decorate_Bindd W T))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk62"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Natural (@dec W T (Decorate_Bindd W T))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk63"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Functor T</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decoratedmonad-v-chk64" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><label class="goal-separator" for="decoratedmonad-v-chk64"><hr></label><div class="goal-conclusion">Functor (T ‚óã (W √ó ))</div></blockquote><input class="alectryon-extra-goal-toggle" id="decoratedmonad-v-chk65" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><label class="goal-separator" for="decoratedmonad-v-chk65"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
map f ‚àò dec T = dec T ‚àò map f</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk66">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Functor T</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk67">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Functor (T ‚óã (W √ó ))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk68">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
map f ‚àò dec T = dec T ‚àò map f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk69"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f ‚àò dec T = dec T ‚àò map f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk6a">unfold_ops @Map_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (map f) ‚àò dec T = dec T ‚àò map f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk6b">unfold_ops @Map_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò map f ‚àò extract) ‚àò dec T =
dec T ‚àò bindd (ret ‚àò f ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk6c">unfold_ops @Decorate_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò map f ‚àò extract) ‚àò bindd ret =
bindd ret ‚àò bindd (ret ‚àò f ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk6d"><span class="nb">rewrite</span> (kmond_bindd2 (T := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò map f ‚àò extract ‚ãÜ<span class="mi">5</span> ret) =
bindd ret ‚àò bindd (ret ‚àò f ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk6e"><span class="nb">rewrite</span> (kmond_bindd2 (T := T)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚àò map f ‚àò extract ‚ãÜ<span class="mi">5</span> ret) =
bindd (ret ‚ãÜ<span class="mi">5</span> ret ‚àò f ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk6f">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ret ‚àò map f ‚àò extract ‚ãÜ<span class="mi">5</span> ret =
ret ‚ãÜ<span class="mi">5</span> ret ‚àò f ‚àò extract</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk70"><span class="nb">rewrite</span> kc5_05.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (map f) ‚àò ret = ret ‚ãÜ<span class="mi">5</span> ret ‚àò f ‚àò extract</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk71"><span class="nb">rewrite</span> kc5_50.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (map f) ‚àò ret = ret ‚àò map f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk72"><span class="nb">rewrite</span> (natural (œï := @ret T _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ret ‚àò map (map f) = ret ‚àò map f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Instance</span>: Categorical.DecoratedFunctor.DecoratedFunctor W T :=
      {| dfun_dec_natural := dec_natural;
        dfun_dec_dec := dec_dec;
        dfun_dec_extract := dec_extract;
      |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** Decorated monad laws *)</span>
    <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk73"><span class="kn">Lemma</span> <span class="nf">dmon_ret_</span> : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>),
        dec T ‚àò ret (T := T) = ret ‚àò pair ∆µ (B := A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, dec T ‚àò ret = ret ‚àò pair ∆µ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk74"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, dec T ‚àò ret = ret ‚àò pair ∆µ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk75"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec T ‚àò ret = ret ‚àò pair ∆µ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk76">unfold_ops @Decorate_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd ret ‚àò ret = ret ‚àò pair ∆µ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> (kmond_bindd0 (T := T)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk77"><span class="kn">Lemma</span> <span class="nf">dmon_join_</span> : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>),
        dec T ‚àò join (T := T) (A:=A) =
          join (T := T) ‚àò map (F := T) (shift T) ‚àò dec T ‚àò map (F := T) (dec T).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
dec T ‚àò join =
join ‚àò map (shift T) ‚àò dec T ‚àò map (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk78"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
dec T ‚àò join =
join ‚àò map (shift T) ‚àò dec T ‚àò map (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk79"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec T ‚àò join =
join ‚àò map (shift T) ‚àò dec T ‚àò map (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk7a"><span class="nb">unfold</span> shift, strength.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">dec T ‚àò join =
join
‚àò map
    (map (uncurry incr)
     ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt; map (pair a) t)) ‚àò dec T
‚àò map (dec T)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk7b">unfold_ops @Decorate_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd ret ‚àò join =
join
‚àò map
    (map (uncurry incr)
     ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt; map (pair a) t)) ‚àò bindd ret
‚àò map (bindd ret)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk7c">unfold_ops @Map_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd ret ‚àò join =
join
‚àò bindd
    (ret
     ‚àò (bindd (ret ‚àò uncurry incr ‚àò extract)
        ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt;
           bindd (ret ‚àò pair a ‚àò extract) t))
     ‚àò extract) ‚àò bindd ret
‚àò bindd (ret ‚àò bindd ret ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk7d">unfold_ops @Join_Bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd ret ‚àò bindd extract =
bindd extract
‚àò bindd
    (ret
     ‚àò (bindd (ret ‚àò uncurry incr ‚àò extract)
        ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt;
           bindd (ret ‚àò pair a ‚àò extract) t))
     ‚àò extract) ‚àò bindd ret
‚àò bindd (ret ‚àò bindd ret ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk7e">unfold_compose_in_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd ret ‚àò bindd extract =
bindd extract
‚àò bindd
    (ret
     ‚àò (bindd (ret ‚àò uncurry incr ‚àò extract)
        ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt;
           bindd (ret ‚àò pair a ‚àò extract) t))
     ‚àò extract) ‚àò bindd ret
‚àò bindd (ret ‚àò bindd ret ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      <span class="c">(* Fuse LHS *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk7f"><span class="nb">rewrite</span> kmond_bindd2 <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚ãÜ<span class="mi">5</span> extract) =
bindd extract
‚àò bindd
    (ret
     ‚àò (bindd (ret ‚àò uncurry incr ‚àò extract)
        ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt;
           bindd (ret ‚àò pair a ‚àò extract) t))
     ‚àò extract) ‚àò bindd ret
‚àò bindd (ret ‚àò bindd ret ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk80"><span class="nb">change</span> (extract (W := (W √ó)) (A := T A))
        <span class="kr">with</span> (id ‚àò extract (W := (W √ó)) (A := T A)) <span class="nb">at</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚ãÜ<span class="mi">5</span> id ‚àò extract) =
bindd extract
‚àò bindd
    (ret
     ‚àò (bindd (ret ‚àò uncurry incr ‚àò extract)
        ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt;
           bindd (ret ‚àò pair a ‚àò extract) t))
     ‚àò extract) ‚àò bindd ret
‚àò bindd (ret ‚àò bindd ret ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk81"><span class="nb">rewrite</span> kc5_51.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd ((<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) ‚àò map id) =
bindd extract
‚àò bindd
    (ret
     ‚àò (bindd (ret ‚àò uncurry incr ‚àò extract)
        ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt;
           bindd (ret ‚àò pair a ‚àò extract) t))
     ‚àò extract) ‚àò bindd ret
‚àò bindd (ret ‚àò bindd ret ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk82"><span class="nb">rewrite</span> fun_map_id.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd ((<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) ‚àò id) =
bindd extract
‚àò bindd
    (ret
     ‚àò (bindd (ret ‚àò uncurry incr ‚àò extract)
        ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt;
           bindd (ret ‚àò pair a ‚àò extract) t))
     ‚àò extract) ‚àò bindd ret
‚àò bindd (ret ‚àò bindd ret ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk83"><span class="nb">change</span> (<span class="nl">?f</span> ‚àò id) <span class="kr">with</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) =
bindd extract
‚àò bindd
    (ret
     ‚àò (bindd (ret ‚àò uncurry incr ‚àò extract)
        ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt;
           bindd (ret ‚àò pair a ‚àò extract) t))
     ‚àò extract) ‚àò bindd ret
‚àò bindd (ret ‚àò bindd ret ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      <span class="c">(* Fuse RHS *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk84"><span class="nb">rewrite</span> kmond_bindd2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) =
bindd
  (extract
   ‚ãÜ<span class="mi">5</span> ret
      ‚àò (bindd (ret ‚àò uncurry incr ‚àò extract)
         ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt;
            bindd (ret ‚àò pair a ‚àò extract) t))
      ‚àò extract) ‚àò bindd ret
‚àò bindd (ret ‚àò bindd ret ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk85">reassociate -&gt; near (extract (W := (W √ó))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) =
bindd
  (extract
   ‚ãÜ<span class="mi">5</span> ret
      ‚àò (bindd (ret ‚àò uncurry incr ‚àò extract)
         ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt;
            bindd (ret ‚àò pair a ‚àò extract) t)
         ‚àò extract)) ‚àò bindd ret
‚àò bindd (ret ‚àò (bindd ret ‚àò extract))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk86"><span class="nb">rewrite</span> kc5_54.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) =
bindd
  (kc4 extract
     (bindd (ret ‚àò uncurry incr ‚àò extract)
      ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt;
         bindd (ret ‚àò pair a ‚àò extract) t) ‚àò extract))
‚àò bindd ret ‚àò bindd (ret ‚àò (bindd ret ‚àò extract))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk87"><span class="nb">rewrite</span> kc4_id_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) =
bindd
  (bindd (ret ‚àò uncurry incr ‚àò extract)
   ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt; bindd (ret ‚àò pair a ‚àò extract) t)
   ‚àò extract) ‚àò bindd ret
‚àò bindd (ret ‚àò (bindd ret ‚àò extract))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk88"><span class="nb">rewrite</span> kmond_bindd2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) =
bindd
  (bindd (ret ‚àò uncurry incr ‚àò extract)
   ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt; bindd (ret ‚àò pair a ‚àò extract) t)
   ‚àò extract ‚ãÜ<span class="mi">5</span> ret)
‚àò bindd (ret ‚àò (bindd ret ‚àò extract))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk89"><span class="nb">change</span> (ret (T := T) ( A:= (W √ó) (T ((W √ó) A))))
        <span class="kr">with</span> ((ret (T := T) (A := (W √ó) (T ((W √ó) A)))) ‚àò id).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) =
bindd
  (bindd (ret ‚àò uncurry incr ‚àò extract)
   ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt; bindd (ret ‚àò pair a ‚àò extract) t)
   ‚àò extract ‚ãÜ<span class="mi">5</span> ret ‚àò id)
‚àò bindd (ret ‚àò (bindd ret ‚àò extract))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk8a"><span class="nb">rewrite</span> kc5_54.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) =
bindd
  (kc4
     (bindd (ret ‚àò uncurry incr ‚àò extract)
      ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt;
         bindd (ret ‚àò pair a ‚àò extract) t) ‚àò extract)
     id) ‚àò bindd (ret ‚àò (bindd ret ‚àò extract))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk8b"><span class="nb">rewrite</span> kc4_04.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) =
bindd
  (bindd (ret ‚àò uncurry incr ‚àò extract)
   ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt; bindd (ret ‚àò pair a ‚àò extract) t)
   ‚àò id) ‚àò bindd (ret ‚àò (bindd ret ‚àò extract))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk8c"><span class="nb">change</span> (<span class="nl">?f</span> ‚àò id) <span class="kr">with</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) =
bindd
  (bindd (ret ‚àò uncurry incr ‚àò extract)
   ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt; bindd (ret ‚àò pair a ‚àò extract) t))
‚àò bindd (ret ‚àò (bindd ret ‚àò extract))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk8d"><span class="nb">rewrite</span> kmond_bindd2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) =
bindd
  (bindd (ret ‚àò uncurry incr ‚àò extract)
   ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt; bindd (ret ‚àò pair a ‚àò extract) t)
   ‚ãÜ<span class="mi">5</span> ret ‚àò (bindd ret ‚àò extract))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk8e"><span class="nb">rewrite</span> kc5_54.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) =
bindd
  (kc4
     (bindd (ret ‚àò uncurry incr ‚àò extract)
      ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt;
         bindd (ret ‚àò pair a ‚àò extract) t))
     (bindd ret ‚àò extract))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk8f"><span class="nb">rewrite</span> kc4_40.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) =
bindd
  (bindd (ret ‚àò uncurry incr ‚àò extract)
   ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt; bindd (ret ‚àò pair a ‚àò extract) t)
   ‚àò map (bindd ret))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      <span class="c">(* Now compare inner functions *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk90">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> &#39;(w, t) =&gt; bindd (ret ‚¶ø w) t) =
bindd (ret ‚àò uncurry incr ‚àò extract)
‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt; bindd (ret ‚àò pair a ‚àò extract) t)
‚àò map (bindd ret)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk91">ext [w t].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚¶ø w) t =
(bindd (ret ‚àò uncurry incr ‚àò extract)
 ‚àò (<span class="kr">fun</span> &#39;(a, t) =&gt; bindd (ret ‚àò pair a ‚àò extract) t)
 ‚àò map (bindd ret)) (w, t)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk92"><span class="kp">do</span> <span class="mi">2</span> (<span class="nb">unfold</span> compose; <span class="nb">cbn</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚¶ø w) t =
bindd
  (<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
   ret (uncurry incr (extract a)))
  (bindd
     (<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) A) =&gt; ret (w, extract a))
     (bindd ret t))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk93">compose near t on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚¶ø w) t =
bindd
  (<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
   ret (uncurry incr (extract a)))
  ((bindd
      (<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) A) =&gt; ret (w, extract a))
    ‚àò bindd ret) t)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk94"><span class="nb">rewrite</span> kmond_bindd2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (ret ‚¶ø w) t =
bindd
  (<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
   ret (uncurry incr (extract a)))
  (bindd
     ((<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) A) =&gt; ret (w, extract a))
      ‚ãÜ<span class="mi">5</span> ret) t)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk95"><span class="nb">change</span> (ret (A := (W √ó) A)) <span class="kr">with</span> (ret (A := (W √ó) A) ‚àò id).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd ((ret ‚àò id) ‚¶ø w) t =
bindd
  (<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
   (ret ‚àò id) (uncurry incr (extract a)))
  (bindd
     ((<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) A) =&gt; ret (w, extract a))
      ‚ãÜ<span class="mi">5</span> ret ‚àò id) t)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk96"><span class="nb">rewrite</span> kc5_54.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd ((ret ‚àò id) ‚¶ø w) t =
bindd
  (<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
   (ret ‚àò id) (uncurry incr (extract a)))
  (bindd
     (kc4
        (<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) A) =&gt;
         ret (w, extract a)) id) t)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk97">compose near t on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd ((ret ‚àò id) ‚¶ø w) t =
(bindd
   (<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
    (ret ‚àò id) (uncurry incr (extract a)))
 ‚àò bindd
     (kc4
        (<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) A) =&gt;
         ret (w, extract a)) id)) t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk98"><span class="nb">rewrite</span> kmond_bindd2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd ((ret ‚àò id) ‚¶ø w) t =
bindd
  ((<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
    (ret ‚àò id) (uncurry incr (extract a)))
   ‚ãÜ<span class="mi">5</span> kc4
        (<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) A) =&gt;
         ret (w, extract a)) id) t</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      <span class="c">(* Now compare inner functions again *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk99">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(ret ‚àò id) ‚¶ø w =
(<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
 (ret ‚àò id) (uncurry incr (extract a)))
‚ãÜ<span class="mi">5</span> kc4
     (<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) A) =&gt; ret (w, extract a))
     id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk9a">ext [w&#39; a].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((ret ‚àò id) ‚¶ø w) (w&#39;, a) =
((<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
  (ret ‚àò id) (uncurry incr (extract a)))
 ‚ãÜ<span class="mi">5</span> kc4
      (<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) A) =&gt; ret (w, extract a))
      id) (w&#39;, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk9b"><span class="nb">unfold</span> preincr; <span class="nb">unfold</span> compose; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ret (w ‚óè w&#39;, a) =
bindd
  ((<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
    ret (id (uncurry incr (extract a)))) ‚¶ø w&#39;)
  (kc4
     (<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) A) =&gt; ret (w, extract a))
     id (w&#39;, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk9c"><span class="nb">unfold</span> kc4; unfold_ops @Cobind_reader.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ret (w ‚óè w&#39;, a) =
bindd
  ((<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
    ret (id (uncurry incr (extract a)))) ‚¶ø w&#39;)
  (((<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) A) =&gt; ret (w, extract a))
    ‚àò (<span class="kr">fun</span> &#39;(e, a) =&gt; (e, id (e, a)))) (w&#39;, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk9d"><span class="nb">unfold</span> compose; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ret (w ‚óè w&#39;, a) =
bindd
  ((<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
    ret (id (uncurry incr (extract a)))) ‚¶ø w&#39;)
  (ret (w, id (w&#39;, a)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk9e"><span class="nb">change</span> (id <span class="nl">?x</span>) <span class="kr">with</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ret (w ‚óè w&#39;, a) =
bindd
  ((<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
    ret (uncurry incr (extract a))) ‚¶ø w&#39;)
  (ret (w, (w&#39;, a)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chk9f">compose near (w, (w&#39;, a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ret (w ‚óè w&#39;, a) =
(bindd
   ((<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
     ret (uncurry incr (extract a))) ‚¶ø w&#39;) ‚àò ret)
  (w, (w&#39;, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decoratedmonad-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="decoratedmonad-v-chka0"><span class="nb">rewrite</span> kmond_bindd0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>T</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>ret_inst</var><span class="hyp-type"><b>: </b><span>Return T</span></span></span><br><span><var>bindd_inst</var><span class="hyp-type"><b>: </b><span>Bindd W T T</span></span></span><br><span><var>mon_op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>mon_unit</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecoratedMonad W T</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>T A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ret (w ‚óè w&#39;, a) =
((<span class="kr">fun</span> <span class="nv">a</span> : (W √ó ) ((W √ó ) ((W √ó ) A)) =&gt;
  ret (uncurry incr (extract a))) ‚¶ø w&#39; ‚àò ret)
  (w, (w&#39;, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Instance</span>: Categorical.DecoratedMonad.DecoratedMonad W T :=
      {| dmon_ret := dmon_ret_;
        dmon_join := dmon_join_;
      |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">with_monad</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">ToCategorical</span>.</span></span></pre>
</div>
</div></body>
</html>
