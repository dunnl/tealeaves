<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.21.2: https://docutils.sourceforge.io/" />
<title>Ctxset.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.16.0+0.16.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">From</span> Tealeaves <span class="kn">Require Export</span>
  Functors.Subset
  Classes.Kleisli.DecoratedFunctor
  Classes.Kleisli.DecoratedTraversableFunctor (map_strength_cobind_spec)
  Classes.Kleisli.DecoratedMonad
  Classes.Categorical.DecoratedFunctor (shift).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Kleisli.Monad.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Categorical.Monad.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Product.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Misc.Subset.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> Monoid.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Import</span> DecoratedMonad.Notations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Generalizable Variables</span> <span class="nf">W</span> A B.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * The &lt;&lt;ctxset&gt;&gt; functor *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ctxset</span> (<span class="nv">E</span> : <span class="kt">Type</span>) := <span class="kr">fun</span> <span class="nv">A</span> =&gt; subset (E * A).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">ctxset</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span>
    (<span class="nv">E</span> : <span class="kt">Type</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** ** Operations and specifications *)</span>
  <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">Mapd_ctxset</span> : Mapd E (ctxset E) :=
    <span class="kr">fun</span> `(f : E * A -&gt; B) (s : ctxset E A) =&gt;
    <span class="kr">fun</span> &#39;(e, b) =&gt; <span class="kr">exists</span> (<span class="nv">a</span> : A), s (e, a) /\ f (e, a) = b.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">Map_ctxset</span> : Map (ctxset E) :=
    <span class="kr">fun</span> `(f : A -&gt; B) (s : ctxset E A) =&gt;
    <span class="kr">fun</span> &#39;(e, b) =&gt; <span class="kr">exists</span> (<span class="nv">a</span> : A), s (e, a) /\ f a = b.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk0"><span class="kn">Lemma</span> <span class="nf">ctxset_mapd_spec</span> : <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) `(f : E * A -&gt; B),
      mapd (T := ctxset E) f = map (F := subset) (cobind f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : E * A -&gt; B),
mapd f = map (cobind f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : E * A -&gt; B),
mapd f = map (cobind f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk2"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">mapd f = map (cobind f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk3">ext s [e b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">mapd f s (e, b) = map (cobind f) s (e, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk4"><span class="nb">cbv</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a</span> : A, s (e, a) /\ f (e, a) = b) =
(<span class="kr">exists</span> <span class="nv">a</span> : E * A,
   s a /\
   (<span class="kr">let</span> &#39;(e, a0) := a <span class="kr">in</span> (e, f (e, a0))) = (e, b))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk5">propext.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a</span> : A, s (e, a) /\ f (e, a) = b) -&gt;
<span class="kr">exists</span> <span class="nv">a</span> : E * A,
  s a /\
  (<span class="kr">let</span> &#39;(e, a0) := a <span class="kr">in</span> (e, f (e, a0))) = (e, b)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ctxset-v-chk6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chk6"><hr></label><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a</span> : E * A,
   s a /\
   (<span class="kr">let</span> &#39;(e, a0) := a <span class="kr">in</span> (e, f (e, a0))) = (e, b)) -&gt;
<span class="kr">exists</span> <span class="nv">a</span> : A, s (e, a) /\ f (e, a) = b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a</span> : A, s (e, a) /\ f (e, a) = b) -&gt;
<span class="kr">exists</span> <span class="nv">a</span> : E * A,
  s a /\
  (<span class="kr">let</span> &#39;(e, a0) := a <span class="kr">in</span> (e, f (e, a0))) = (e, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk8"><span class="nb">intros</span> [a [Hin Heq]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (e, a)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>f (e, a) = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">a</span> : E * A,
  s a /\
  (<span class="kr">let</span> &#39;(e, a0) := a <span class="kr">in</span> (e, f (e, a0))) = (e, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk9"><span class="kr">exists</span> (<span class="nv">e</span>, a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (e, a)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>f (e, a) = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s (e, a) /\ (e, f (e, a)) = (e, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">subst</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chka">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a</span> : E * A,
   s a /\
   (<span class="kr">let</span> &#39;(e, a0) := a <span class="kr">in</span> (e, f (e, a0))) = (e, b)) -&gt;
<span class="kr">exists</span> <span class="nv">a</span> : A, s (e, a) /\ f (e, a) = b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkb"><span class="nb">intros</span> [[e&#39; a] [Hin Heq]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>e'</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (e&#39;, a)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(e&#39;, f (e&#39;, a)) = (e, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">a</span> : A, s (e, a) /\ f (e, a) = b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkc"><span class="kr">exists</span> <span class="nv">a</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>e'</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (e&#39;, a)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(e&#39;, f (e&#39;, a)) = (e, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s (e, a) /\ f (e, a) = b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkd"><span class="nb">inversion</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>e'</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (e&#39;, a)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(e&#39;, f (e&#39;, a)) = (e, b)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>e&#39; = e</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>f (e, a) = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s (e, a) /\ f (e, a) = f (e, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">subst</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chke"><span class="kn">Lemma</span> <span class="nf">ctxset_map_spec</span> : <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) `(f : A -&gt; B),
      map (F := ctxset E) f = map (F := subset) (map f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B), map f = map (map f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B), map f = map (map f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk10"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f = map (map f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk11">ext s [e b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f s (e, b) = map (map f) s (e, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk12"><span class="nb">cbv</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a</span> : A, s (e, a) /\ f a = b) =
(<span class="kr">exists</span> <span class="nv">a</span> : E * A,
   s a /\ (<span class="kr">let</span> &#39;(e, a0) := a <span class="kr">in</span> (e, f a0)) = (e, b))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk13">propext.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a</span> : A, s (e, a) /\ f a = b) -&gt;
<span class="kr">exists</span> <span class="nv">a</span> : E * A,
  s a /\ (<span class="kr">let</span> &#39;(e, a0) := a <span class="kr">in</span> (e, f a0)) = (e, b)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ctxset-v-chk14" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chk14"><hr></label><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a</span> : E * A,
   s a /\ (<span class="kr">let</span> &#39;(e, a0) := a <span class="kr">in</span> (e, f a0)) = (e, b)) -&gt;
<span class="kr">exists</span> <span class="nv">a</span> : A, s (e, a) /\ f a = b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk15">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a</span> : A, s (e, a) /\ f a = b) -&gt;
<span class="kr">exists</span> <span class="nv">a</span> : E * A,
  s a /\ (<span class="kr">let</span> &#39;(e, a0) := a <span class="kr">in</span> (e, f a0)) = (e, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk16"><span class="nb">intros</span> [a [Hin Heq]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (e, a)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>f a = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">a</span> : E * A,
  s a /\ (<span class="kr">let</span> &#39;(e, a0) := a <span class="kr">in</span> (e, f a0)) = (e, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk17"><span class="kr">exists</span> (<span class="nv">e</span>, a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (e, a)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>f a = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s (e, a) /\ (e, f a) = (e, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">subst</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk18">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a</span> : E * A,
   s a /\ (<span class="kr">let</span> &#39;(e, a0) := a <span class="kr">in</span> (e, f a0)) = (e, b)) -&gt;
<span class="kr">exists</span> <span class="nv">a</span> : A, s (e, a) /\ f a = b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk19"><span class="nb">intros</span> [[e&#39; a] [Hin Heq]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>e'</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (e&#39;, a)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(e&#39;, f a) = (e, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">a</span> : A, s (e, a) /\ f a = b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk1a"><span class="kr">exists</span> <span class="nv">a</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>e'</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (e&#39;, a)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(e&#39;, f a) = (e, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s (e, a) /\ f a = b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk1b"><span class="nb">inversion</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset E A</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>e'</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (e&#39;, a)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(e&#39;, f a) = (e, b)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>e&#39; = e</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>f a = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s (e, a) /\ f a = f a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">subst</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** ** Operations and specifications *)</span>
  <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk1c"><span class="kn">Lemma</span> <span class="nf">ctxset_map_to_mapd</span> : <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
      map f = mapd (T := ctxset E) (f ‚àò extract).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
map f = mapd (f ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk1d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
map f = mapd (f ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk1e"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f = mapd (f ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk1f"><span class="nb">rewrite</span> ctxset_mapd_spec, ctxset_map_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (map f) = map (cobind (f ‚àò extract))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> map_to_cobind.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk20"><span class="kn">Lemma</span> <span class="nf">dfun_subset_mapd1</span> :
    <span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, mapd (T := ctxset E) extract = @id (ctxset E A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, mapd extract = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk21"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, mapd extract = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk22"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">mapd extract = id</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk23"><span class="nb">cbv</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> (<span class="nv">s</span> : E * A -&gt; <span class="kt">Prop</span>) &#39;(e, b) =&gt;
 <span class="kr">exists</span> <span class="nv">a</span> : A, s (e, a) /\ a = b) =
(<span class="kr">fun</span> <span class="nv">x</span> : E * A -&gt; <span class="kt">Prop</span> =&gt; x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk24">ext f [e a].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; <span class="kt">Prop</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a0</span> : A, f (e, a0) /\ a0 = a) = f (e, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk25">propext.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; <span class="kt">Prop</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a0</span> : A, f (e, a0) /\ a0 = a) -&gt; f (e, a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ctxset-v-chk26" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; <span class="kt">Prop</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chk26"><hr></label><div class="goal-conclusion">f (e, a) -&gt; <span class="kr">exists</span> <span class="nv">a0</span> : A, f (e, a0) /\ a0 = a</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk27">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; <span class="kt">Prop</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a0</span> : A, f (e, a0) /\ a0 = a) -&gt; f (e, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk28"><span class="nb">intros</span> [a&#39; Heq].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; <span class="kt">Prop</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>a, a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>f (e, a&#39;) /\ a&#39; = a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (e, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> preprocess.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk29">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; <span class="kt">Prop</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (e, a) -&gt; <span class="kr">exists</span> <span class="nv">a0</span> : A, f (e, a0) /\ a0 = a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk2a"><span class="nb">intros</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; <span class="kt">Prop</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>f (e, a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">a0</span> : A, f (e, a0) /\ a0 = a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk2b"><span class="kr">exists</span> <span class="nv">a</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; <span class="kt">Prop</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>E</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>f (e, a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (e, a) /\ a = a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intuition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk2c"><span class="kn">Lemma</span> <span class="nf">dfun_subset_mapd2</span> :
    <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : E * B -&gt; C) (<span class="nv">f</span> : E * A -&gt; B),
      mapd g ‚àò mapd f = mapd (kc4 g f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : E * B -&gt; C)
  (<span class="nv">f</span> : E * A -&gt; B), mapd g ‚àò mapd f = mapd (kc4 g f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk2d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : E * B -&gt; C)
  (<span class="nv">f</span> : E * A -&gt; B), mapd g ‚àò mapd f = mapd (kc4 g f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk2e"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>E * B -&gt; C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">mapd g ‚àò mapd f = mapd (kc4 g f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk2f"><span class="kp">do</span> <span class="mi">2</span> <span class="nb">rewrite</span> ctxset_mapd_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>E * B -&gt; C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (cobind g) ‚àò map (cobind f) = mapd (kc4 g f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk30"><span class="nb">rewrite</span> (fun_map_map (E * A) (E * B) (E * C) (F := subset)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>E * B -&gt; C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (cobind g ‚àò cobind f) = mapd (kc4 g f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk31"><span class="nb">rewrite</span> (kcom_cobind2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>E * B -&gt; C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (cobind (kc4 g f)) = mapd (kc4 g f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk32"><span class="nb">rewrite</span> &lt;- ctxset_mapd_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>E * B -&gt; C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">mapd (kc4 g f) = mapd (kc4 g f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** ** Decorated functor typeclass instance *)</span>
  <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">DTF_ctxset</span> : DecoratedFunctor E (ctxset E) :=
    {| dfun_mapd1 := dfun_subset_mapd1;
       dfun_mapd2 := dfun_subset_mapd2;
    |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk33">#[export] <span class="kn">Instance</span> <span class="nf">Compat_Map_Mapd_ctxset</span> :
    `{Compat_Map_Mapd}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Compat_Map_Mapd</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk34"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Compat_Map_Mapd</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk35"><span class="nb">hnf</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">@map (ctxset E) Map_ctxset = @map (ctxset E) Map_Mapd</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk36">ext A B f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f = map f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> ctxset_map_to_mapd.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk37">#[export] <span class="kn">Instance</span> <span class="nf">Functor_ctxset</span> :
    Functor (ctxset E).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Functor (ctxset E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk38"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Functor (ctxset E)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** ** Monoid instances *)</span>
  <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">Monoid_ctxset</span> : <span class="kr">forall</span> <span class="nv">A</span>, Monoid (ctxset E A) := <span class="kp">ltac</span>:(<span class="nb">typeclasses eauto</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk39">#[export] <span class="kn">Instance</span> <span class="nf">Monmor_ctxset_mapd</span> : <span class="kr">forall</span> `(f : E * A -&gt; B),
      Monoid_Morphism (ctxset E A) (ctxset E B) (mapd f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : E * A -&gt; B),
Monoid_Morphism (ctxset E A) (ctxset E B) (mapd f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk3a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : E * A -&gt; B),
Monoid_Morphism (ctxset E A) (ctxset E B) (mapd f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk3b"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid_Morphism (ctxset E A) (ctxset E B) (mapd f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk3c"><span class="nb">unfold</span> ctxset.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid_Morphism (E * A -&gt; <span class="kt">Prop</span>) (E * B -&gt; <span class="kt">Prop</span>)
  (mapd f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk3d"><span class="nb">rewrite</span> ctxset_mapd_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>E * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid_Morphism (E * A -&gt; <span class="kt">Prop</span>) (E * B -&gt; <span class="kt">Prop</span>)
  (map (cobind f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk3e">#[export] <span class="kn">Instance</span> <span class="nf">map_ctxset_morphism</span> : <span class="kr">forall</span> `(f : A -&gt; B),
      Monoid_Morphism (ctxset E A) (ctxset E B) (map f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Monoid_Morphism (ctxset E A) (ctxset E B) (map f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk3f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Monoid_Morphism (ctxset E A) (ctxset E B) (map f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk40"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid_Morphism (ctxset E A) (ctxset E B) (map f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk41"><span class="nb">unfold</span> ctxset.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid_Morphism (E * A -&gt; <span class="kt">Prop</span>) (E * B -&gt; <span class="kt">Prop</span>)
  (map f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk42"><span class="nb">rewrite</span> ctxset_map_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>E, A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid_Morphism (E * A -&gt; <span class="kt">Prop</span>) (E * B -&gt; <span class="kt">Prop</span>)
  (map (map f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">ctxset</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * The &lt;&lt;ctxset&gt;&gt; monad *)</span>
<span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">ctxset</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> `{Monoid W}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** ** Monad instance *)</span>
  <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">Return_ctxset</span> : Return (ctxset W) :=
    <span class="kr">fun</span> <span class="nv">A</span> <span class="nv">a</span> &#39;(w, b) =&gt; a = b /\ w = ∆µ.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">Bindd_ctxset</span> : Bindd W (ctxset W) (ctxset W) :=
    <span class="kr">fun</span> <span class="nv">A</span> <span class="nv">B</span> <span class="nv">f</span> <span class="nv">s_a</span> =&gt;
      (<span class="kr">fun</span> &#39;(w, b) =&gt; <span class="kr">exists</span> (<span class="nv">wa</span> : W) (<span class="nv">a</span> : A),
           s_a (wa, a) /\
             <span class="kr">exists</span> (<span class="nv">wb</span> : W), f (wa, a) (wb, b) /\ w = wa ‚óè wb).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">Bind_ctxset</span> : Bind (ctxset W) (ctxset W) :=
    <span class="kr">fun</span> <span class="nv">A</span> <span class="nv">B</span> <span class="nv">f</span> <span class="nv">s_a</span> =&gt;
      (<span class="kr">fun</span> &#39;(w, b) =&gt; <span class="kr">exists</span> (<span class="nv">wa</span> : W) (<span class="nv">a</span> : A),
           s_a (wa, a) /\
             <span class="kr">exists</span> (<span class="nv">wb</span> : W), f a (wb, b) /\ w = wa ‚óè wb).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk43"><span class="kn">Lemma</span> <span class="nf">ctxset_ret_spec</span> : <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>),
      ret (T := ctxset W) (A := A) =
        ret (T := subset) ‚àò ret (T := (W √ó)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Œ∑ = Œ∑ ‚àò Œ∑</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk44"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Œ∑ = Œ∑ ‚àò Œ∑</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk45"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œ∑ = Œ∑ ‚àò Œ∑</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk46">ext a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œ∑ a = (Œ∑ ‚àò Œ∑) a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk47">ext [w b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œ∑ a (w, b) = (Œ∑ ‚àò Œ∑) a (w, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk48">propext.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œ∑ a (w, b) -&gt; (Œ∑ ‚àò Œ∑) a (w, b)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ctxset-v-chk49" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chk49"><hr></label><div class="goal-conclusion">(Œ∑ ‚àò Œ∑) a (w, b) -&gt; Œ∑ a (w, b)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk4a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œ∑ a (w, b) -&gt; (Œ∑ ‚àò Œ∑) a (w, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk4b"><span class="nb">cbv</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a = b /\ w = unit0 -&gt; (unit0, a) = (w, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">intuition</span> <span class="nb">subst</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk4c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Œ∑ ‚àò Œ∑) a (w, b) -&gt; Œ∑ a (w, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk4d"><span class="nb">cbv</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(unit0, a) = (w, b) -&gt; a = b /\ w = unit0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">inversion</span> <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk4e"><span class="kn">Lemma</span> <span class="nf">ctxset_bindd_spec</span> : <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : W * A -&gt; ctxset W B),
      bindd (T := ctxset W) f =
        bind (T := subset) (shift subset ‚àò cobind (W := (W √ó)) f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : W * A -&gt; ctxset W B),
bindd f = bind (shift subset ‚àò cobind f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk4f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : W * A -&gt; ctxset W B),
bindd f = bind (shift subset ‚àò cobind f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk50"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd f = bind (shift subset ‚àò cobind f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk51">ext s [w b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd f s (w, b) =
bind (shift subset ‚àò cobind f) s (w, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk52"><span class="nb">unfold</span> shift.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd f s (w, b) =
bind (map (uncurry incr) ‚àò strength ‚àò cobind f) s
  (w, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk53"><span class="nb">rewrite</span> (map_strength_cobind_spec (G := subset)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd f s (w, b) =
bind
  (<span class="kr">fun</span> &#39;(w, a) =&gt;
   map (uncurry incr ‚àò pair w) (f (w, a))) s (w, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk54">unfold_ops @Bind_subset @Bindd_ctxset @Map_subset.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> (<span class="nv">wa</span> : W) (<span class="nv">a</span> : A),
   s (wa, a) /\
   (<span class="kr">exists</span> <span class="nv">wb</span> : W, f (wa, a) (wb, b) /\ w = wa ‚óè wb)) =
(<span class="kr">exists</span> <span class="nv">a</span> : W * A,
   s a /\
   (<span class="kr">let</span>
    &#39;(w, a0) := a <span class="kr">in</span>
     <span class="kr">fun</span> <span class="nv">b</span> : W * B =&gt;
     <span class="kr">exists</span> <span class="nv">a1</span> : W * B,
       f (w, a0) a1 /\ (uncurry incr ‚àò pair w) a1 = b)
     (w, b))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk55">propext.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> (<span class="nv">wa</span> : W) (<span class="nv">a</span> : A),
   s (wa, a) /\
   (<span class="kr">exists</span> <span class="nv">wb</span> : W, f (wa, a) (wb, b) /\ w = wa ‚óè wb)) -&gt;
<span class="kr">exists</span> <span class="nv">a</span> : W * A,
  s a /\
  (<span class="kr">let</span>
   &#39;(w, a0) := a <span class="kr">in</span>
    <span class="kr">fun</span> <span class="nv">b</span> : W * B =&gt;
    <span class="kr">exists</span> <span class="nv">a1</span> : W * B,
      f (w, a0) a1 /\ (uncurry incr ‚àò pair w) a1 = b)
    (w, b)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ctxset-v-chk56" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chk56"><hr></label><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a</span> : W * A,
   s a /\
   (<span class="kr">let</span>
    &#39;(w, a0) := a <span class="kr">in</span>
     <span class="kr">fun</span> <span class="nv">b</span> : W * B =&gt;
     <span class="kr">exists</span> <span class="nv">a1</span> : W * B,
       f (w, a0) a1 /\ (uncurry incr ‚àò pair w) a1 = b)
     (w, b)) -&gt;
<span class="kr">exists</span> (<span class="nv">wa</span> : W) (<span class="nv">a</span> : A),
  s (wa, a) /\
  (<span class="kr">exists</span> <span class="nv">wb</span> : W, f (wa, a) (wb, b) /\ w = wa ‚óè wb)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk57">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> (<span class="nv">wa</span> : W) (<span class="nv">a</span> : A),
   s (wa, a) /\
   (<span class="kr">exists</span> <span class="nv">wb</span> : W, f (wa, a) (wb, b) /\ w = wa ‚óè wb)) -&gt;
<span class="kr">exists</span> <span class="nv">a</span> : W * A,
  s a /\
  (<span class="kr">let</span>
   &#39;(w, a0) := a <span class="kr">in</span>
    <span class="kr">fun</span> <span class="nv">b</span> : W * B =&gt;
    <span class="kr">exists</span> <span class="nv">a1</span> : W * B,
      f (w, a0) a1 /\ (uncurry incr ‚àò pair w) a1 = b)
    (w, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk58"><span class="nb">intros</span> [wa [a [contra [w&#39; [Hin Heq]]]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>f (wa, a) (w&#39;, b)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>w = wa ‚óè w&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">a</span> : W * A,
  s a /\
  (<span class="kr">let</span>
   &#39;(w, a0) := a <span class="kr">in</span>
    <span class="kr">fun</span> <span class="nv">b</span> : W * B =&gt;
    <span class="kr">exists</span> <span class="nv">a1</span> : W * B,
      f (w, a0) a1 /\ (uncurry incr ‚àò pair w) a1 = b)
    (w, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk59"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>f (wa, a) (w&#39;, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">a</span> : W * A,
  s a /\
  (<span class="kr">let</span>
   &#39;(w, a0) := a <span class="kr">in</span>
    <span class="kr">fun</span> <span class="nv">b</span> : W * B =&gt;
    <span class="kr">exists</span> <span class="nv">a1</span> : W * B,
      f (w, a0) a1 /\ (uncurry incr ‚àò pair w) a1 = b)
    (wa ‚óè w&#39;, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk5a"><span class="kr">exists</span> (<span class="nv">wa</span>, a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>f (wa, a) (w&#39;, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s (wa, a) /\
(<span class="kr">exists</span> <span class="nv">a0</span> : W * B,
   f (wa, a) a0 /\
   (uncurry incr ‚àò pair wa) a0 = (wa ‚óè w&#39;, b))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk5b"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>f (wa, a) (w&#39;, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s (wa, a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ctxset-v-chk5c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>f (wa, a) (w&#39;, b)</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chk5c"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">a0</span> : W * B,
  f (wa, a) a0 /\
  (uncurry incr ‚àò pair wa) a0 = (wa ‚óè w&#39;, b)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk5d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>f (wa, a) (w&#39;, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s (wa, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk5e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>f (wa, a) (w&#39;, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">a0</span> : W * B,
  f (wa, a) a0 /\
  (uncurry incr ‚àò pair wa) a0 = (wa ‚óè w&#39;, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk5f"><span class="kr">exists</span> (<span class="nv">w&#39;</span>, b).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>f (wa, a) (w&#39;, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (wa, a) (w&#39;, b) /\
(uncurry incr ‚àò pair wa) (w&#39;, b) = (wa ‚óè w&#39;, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk60">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a</span> : W * A,
   s a /\
   (<span class="kr">let</span>
    &#39;(w, a0) := a <span class="kr">in</span>
     <span class="kr">fun</span> <span class="nv">b</span> : W * B =&gt;
     <span class="kr">exists</span> <span class="nv">a1</span> : W * B,
       f (w, a0) a1 /\ (uncurry incr ‚àò pair w) a1 = b)
     (w, b)) -&gt;
<span class="kr">exists</span> (<span class="nv">wa</span> : W) (<span class="nv">a</span> : A),
  s (wa, a) /\
  (<span class="kr">exists</span> <span class="nv">wb</span> : W, f (wa, a) (wb, b) /\ w = wa ‚óè wb)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk61"><span class="nb">intros</span> [[wa a] [Hin [[wb b&#39;] [Hin&#39; Heq]]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>wb</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Hin'</var><span class="hyp-type"><b>: </b><span>f (wa, a) (wb, b&#39;)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(uncurry incr ‚àò pair wa) (wb, b&#39;) = (w, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> (<span class="nv">wa</span> : W) (<span class="nv">a</span> : A),
  s (wa, a) /\
  (<span class="kr">exists</span> <span class="nv">wb</span> : W, f (wa, a) (wb, b) /\ w = wa ‚óè wb)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk62"><span class="nb">inversion</span> Heq.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>wb</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>Hin'</var><span class="hyp-type"><b>: </b><span>f (wa, a) (wb, b&#39;)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(uncurry incr ‚àò pair wa) (wb, b&#39;) = (w, b)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>wa ‚óè wb = w</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>b&#39; = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> (<span class="nv">wa0</span> : W) (<span class="nv">a</span> : A),
  s (wa0, a) /\
  (<span class="kr">exists</span> <span class="nv">wb0</span> : W,
     f (wa0, a) (wb0, b) /\ wa ‚óè wb = wa0 ‚óè wb0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk63"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>wb</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(uncurry incr ‚àò pair wa) (wb, b) = (wa ‚óè wb, b)</span></span></span><br><span><var>Hin'</var><span class="hyp-type"><b>: </b><span>f (wa, a) (wb, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> (<span class="nv">wa0</span> : W) (<span class="nv">a</span> : A),
  s (wa0, a) /\
  (<span class="kr">exists</span> <span class="nv">wb0</span> : W,
     f (wa0, a) (wb0, b) /\ wa ‚óè wb = wa0 ‚óè wb0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk64"><span class="kr">exists</span> <span class="nv">wa</span> <span class="nv">a</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>wb</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(uncurry incr ‚àò pair wa) (wb, b) = (wa ‚óè wb, b)</span></span></span><br><span><var>Hin'</var><span class="hyp-type"><b>: </b><span>f (wa, a) (wb, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s (wa, a) /\
(<span class="kr">exists</span> <span class="nv">wb0</span> : W,
   f (wa, a) (wb0, b) /\ wa ‚óè wb = wa ‚óè wb0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk65"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>wb</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(uncurry incr ‚àò pair wa) (wb, b) = (wa ‚óè wb, b)</span></span></span><br><span><var>Hin'</var><span class="hyp-type"><b>: </b><span>f (wa, a) (wb, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s (wa, a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ctxset-v-chk66" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>wb</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(uncurry incr ‚àò pair wa) (wb, b) = (wa ‚óè wb, b)</span></span></span><br><span><var>Hin'</var><span class="hyp-type"><b>: </b><span>f (wa, a) (wb, b)</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chk66"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">wb0</span> : W,
  f (wa, a) (wb0, b) /\ wa ‚óè wb = wa ‚óè wb0</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk67">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>wb</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(uncurry incr ‚àò pair wa) (wb, b) = (wa ‚óè wb, b)</span></span></span><br><span><var>Hin'</var><span class="hyp-type"><b>: </b><span>f (wa, a) (wb, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s (wa, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk68">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>wb</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(uncurry incr ‚àò pair wa) (wb, b) = (wa ‚óè wb, b)</span></span></span><br><span><var>Hin'</var><span class="hyp-type"><b>: </b><span>f (wa, a) (wb, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">wb0</span> : W,
  f (wa, a) (wb0, b) /\ wa ‚óè wb = wa ‚óè wb0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk69"><span class="kr">exists</span> <span class="nv">wb</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>s (wa, a)</span></span></span><br><span><var>wb</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>(uncurry incr ‚àò pair wa) (wb, b) = (wa ‚óè wb, b)</span></span></span><br><span><var>Hin'</var><span class="hyp-type"><b>: </b><span>f (wa, a) (wb, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (wa, a) (wb, b) /\ wa ‚óè wb = wa ‚óè wb</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">easy</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk6a"><span class="kn">Lemma</span> <span class="nf">ctxset_bind_to_bindd</span> : <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; ctxset W B),
      bind (T := ctxset W) f =
        bindd (T := ctxset W) (f ‚àò extract).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; ctxset W B),
bind f = bindd (f ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk6b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; ctxset W B),
bind f = bindd (f ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk6c"><span class="kn">Lemma</span> <span class="nf">ctxset_mapd_to_bindd</span> : <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : W * A -&gt; B),
      mapd (T := ctxset W) f =
        bindd (T := ctxset W) (ret ‚àò f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : W * A -&gt; B),
mapd f = bindd (Œ∑ ‚àò f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk6d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : W * A -&gt; B),
mapd f = bindd (Œ∑ ‚àò f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk6e"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">mapd f = bindd (Œ∑ ‚àò f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk6f"><span class="nb">rewrite</span> ctxset_mapd_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (cobind f) = bindd (Œ∑ ‚àò f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk70"><span class="nb">rewrite</span> ctxset_bindd_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (cobind f) = bind (shift subset ‚àò cobind (Œ∑ ‚àò f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk71"><span class="nb">rewrite</span> Monad.map_to_bind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (Œ∑ ‚àò cobind f) =
bind (shift subset ‚àò cobind (Œ∑ ‚àò f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk72">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œ∑ ‚àò cobind f = shift subset ‚àò cobind (Œ∑ ‚àò f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk73"><span class="nb">rewrite</span> ctxset_ret_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Œ∑ ‚àò cobind f = shift subset ‚àò cobind (Œ∑ ‚àò Œ∑ ‚àò f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk74">unfold_ops @Return_subset @Return_Writer.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">a</span> <span class="nv">b</span> : W * B =&gt; a = b) ‚àò cobind f =
shift subset
‚àò cobind
    ((<span class="kr">fun</span> <span class="nv">a</span> <span class="nv">b</span> : W * B =&gt; a = b)
     ‚àò (<span class="kr">fun</span> <span class="nv">a</span> : B =&gt; (∆µ, a)) ‚àò f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk75">ext [w a] [w&#39; b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="kr">fun</span> <span class="nv">a</span> <span class="nv">b</span> : W * B =&gt; a = b) ‚àò cobind f) (w, a) (w&#39;, b) =
(shift subset
 ‚àò cobind
     ((<span class="kr">fun</span> <span class="nv">a</span> <span class="nv">b</span> : W * B =&gt; a = b)
      ‚àò (<span class="kr">fun</span> <span class="nv">a</span> : B =&gt; (∆µ, a)) ‚àò f)) (w, a) (w&#39;, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk76"><span class="nb">unfold</span> shift, compose; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((w, f (w, a)) = (w&#39;, b)) =
map (uncurry incr)
  (map (pair w) (<span class="kr">fun</span> <span class="nv">b</span> : W * B =&gt; (∆µ, f (w, a)) = b))
  (w&#39;, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk77">unfold_ops @Map_subset; <span class="nb">unfold</span> uncurry.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((w, f (w, a)) = (w&#39;, b)) =
(<span class="kr">exists</span> <span class="nv">a0</span> : W * (W * B),
   (<span class="kr">exists</span> <span class="nv">a1</span> : W * B,
      (∆µ, f (w, a)) = a1 /\ (w, a1) = a0) /\
   (<span class="kr">let</span> &#39;(x, y) := a0 <span class="kr">in</span> incr x y) = (w&#39;, b))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk78">propext.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(w, f (w, a)) = (w&#39;, b) -&gt;
<span class="kr">exists</span> <span class="nv">a0</span> : W * (W * B),
  (<span class="kr">exists</span> <span class="nv">a1</span> : W * B,
     (∆µ, f (w, a)) = a1 /\ (w, a1) = a0) /\
  (<span class="kr">let</span> &#39;(x, y) := a0 <span class="kr">in</span> incr x y) = (w&#39;, b)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ctxset-v-chk79" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chk79"><hr></label><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a0</span> : W * (W * B),
   (<span class="kr">exists</span> <span class="nv">a1</span> : W * B,
      (∆µ, f (w, a)) = a1 /\ (w, a1) = a0) /\
   (<span class="kr">let</span> &#39;(x, y) := a0 <span class="kr">in</span> incr x y) = (w&#39;, b)) -&gt;
(w, f (w, a)) = (w&#39;, b)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk7a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(w, f (w, a)) = (w&#39;, b) -&gt;
<span class="kr">exists</span> <span class="nv">a0</span> : W * (W * B),
  (<span class="kr">exists</span> <span class="nv">a1</span> : W * B,
     (∆µ, f (w, a)) = a1 /\ (w, a1) = a0) /\
  (<span class="kr">let</span> &#39;(x, y) := a0 <span class="kr">in</span> incr x y) = (w&#39;, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk7b"><span class="nb">inversion</span> <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(w, f (w, a)) = (w&#39;, b)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>w = w&#39;</span></span></span><br><span><var>H3</var><span class="hyp-type"><b>: </b><span>f (w&#39;, a) = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">a0</span> : W * (W * B),
  (<span class="kr">exists</span> <span class="nv">a1</span> : W * B,
     (∆µ, f (w&#39;, a)) = a1 /\ (w&#39;, a1) = a0) /\
  (<span class="kr">let</span> &#39;(x, y) := a0 <span class="kr">in</span> incr x y) = (w&#39;, f (w&#39;, a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk7c"><span class="nb">subst</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(w&#39;, f (w&#39;, a)) = (w&#39;, f (w&#39;, a))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">a0</span> : W * (W * B),
  (<span class="kr">exists</span> <span class="nv">a1</span> : W * B,
     (∆µ, f (w&#39;, a)) = a1 /\ (w&#39;, a1) = a0) /\
  (<span class="kr">let</span> &#39;(x, y) := a0 <span class="kr">in</span> incr x y) = (w&#39;, f (w&#39;, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk7d"><span class="kr">exists</span> (<span class="nv">w&#39;</span>, (∆µ, f (w&#39;, a))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(w&#39;, f (w&#39;, a)) = (w&#39;, f (w&#39;, a))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a0</span> : W * B,
   (∆µ, f (w&#39;, a)) = a0 /\
   (w&#39;, a0) = (w&#39;, (∆µ, f (w&#39;, a)))) /\
incr w&#39; (∆µ, f (w&#39;, a)) = (w&#39;, f (w&#39;, a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk7e">splits.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(w&#39;, f (w&#39;, a)) = (w&#39;, f (w&#39;, a))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">a0</span> : W * B,
  (∆µ, f (w&#39;, a)) = a0 /\
  (w&#39;, a0) = (w&#39;, (∆µ, f (w&#39;, a)))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ctxset-v-chk7f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(w&#39;, f (w&#39;, a)) = (w&#39;, f (w&#39;, a))</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chk7f"><hr></label><div class="goal-conclusion">incr w&#39; (∆µ, f (w&#39;, a)) = (w&#39;, f (w&#39;, a))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk80">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(w&#39;, f (w&#39;, a)) = (w&#39;, f (w&#39;, a))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">a0</span> : W * B,
  (∆µ, f (w&#39;, a)) = a0 /\
  (w&#39;, a0) = (w&#39;, (∆µ, f (w&#39;, a)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk81">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(w&#39;, f (w&#39;, a)) = (w&#39;, f (w&#39;, a))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">incr w&#39; (∆µ, f (w&#39;, a)) = (w&#39;, f (w&#39;, a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk82"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>(w&#39;, f (w&#39;, a)) = (w&#39;, f (w&#39;, a))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(w&#39; ‚óè ∆µ, f (w&#39;, a)) = (w&#39;, f (w&#39;, a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> simpl_monoid.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk83">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> <span class="nv">a0</span> : W * (W * B),
   (<span class="kr">exists</span> <span class="nv">a1</span> : W * B,
      (∆µ, f (w, a)) = a1 /\ (w, a1) = a0) /\
   (<span class="kr">let</span> &#39;(x, y) := a0 <span class="kr">in</span> incr x y) = (w&#39;, b)) -&gt;
(w, f (w, a)) = (w&#39;, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk84"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">exists</span> <span class="nv">a0</span> : W * (W * B),
  (<span class="kr">exists</span> <span class="nv">a1</span> : W * B,
     (∆µ, f (w, a)) = a1 /\ (w, a1) = a0) /\
  (<span class="kr">let</span> &#39;(x, y) := a0 <span class="kr">in</span> incr x y) = (w&#39;, b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(w, f (w, a)) = (w&#39;, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk85">preprocess.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w0</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(w0, f (w0, a)) = (w0 ‚óè ∆µ, f (w0, a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> simpl_monoid.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk86"><span class="kn">Lemma</span> <span class="nf">ctxset_map_to_bindd</span> : <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
      map f = bindd (T := ctxset W) (ret ‚àò f ‚àò extract).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
map f = bindd (Œ∑ ‚àò f ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk87"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
map f = bindd (Œ∑ ‚àò f ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk88"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f = bindd (Œ∑ ‚àò f ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk89"><span class="nb">rewrite</span> ctxset_map_to_mapd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">mapd (f ‚àò extract) = bindd (Œ∑ ‚àò f ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk8a"><span class="nb">rewrite</span> ctxset_mapd_to_bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (Œ∑ ‚àò (f ‚àò extract)) = bindd (Œ∑ ‚àò f ‚àò extract)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk8b"><span class="kn">Lemma</span> <span class="nf">ctxset_bind_spec</span> : <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; ctxset W B),
      bind (T := ctxset W) f =
        bind (T := subset) (shift subset ‚àò map (F := (W √ó)) f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; ctxset W B),
bind f = bind (shift subset ‚àò map f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk8c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; ctxset W B),
bind f = bind (shift subset ‚àò map f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk8d"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind f = bind (shift subset ‚àò map f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk8e"><span class="nb">rewrite</span> ctxset_bind_to_bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (f ‚àò extract) = bind (shift subset ‚àò map f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk8f"><span class="nb">rewrite</span> ctxset_bindd_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind (f ‚àò extract)) =
bind (shift subset ‚àò map f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk90"><span class="nb">rewrite</span> map_to_cobind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind (f ‚àò extract)) =
bind (shift subset ‚àò cobind (f ‚àò extract))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk91">#[export] <span class="kn">Instance</span> <span class="nf">Compat_Bind_Bindd_ctxset</span> :
    Compat_Bind_Bindd W (ctxset W) (ctxset W).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Compat_Bind_Bindd W (ctxset W) (ctxset W)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk92"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Compat_Bind_Bindd W (ctxset W) (ctxset W)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk93">#[export] <span class="kn">Instance</span> <span class="nf">Compat_Map_Bindd_ctxset</span> :
    Compat_Map_Bindd W (ctxset W) (ctxset W).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Compat_Map_Bindd W (ctxset W) (ctxset W)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk94"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Compat_Map_Bindd W (ctxset W) (ctxset W)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk95"><span class="nb">hnf</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">@map (ctxset W) (Map_ctxset W) =
@map (ctxset W) (Map_Bindd W (ctxset W) (ctxset W))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk96">ext A B f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map f = map f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk97"><span class="nb">rewrite</span> ctxset_map_to_bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (Œ∑ ‚àò f ‚àò extract) = map f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk98">#[export] <span class="kn">Instance</span> <span class="nf">Compat_Mapd_Bindd_ctxset</span> :
    Compat_Mapd_Bindd W (ctxset W) (ctxset W).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Compat_Mapd_Bindd W (ctxset W) (ctxset W)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk99"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Compat_Mapd_Bindd W (ctxset W) (ctxset W)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk9a"><span class="nb">hnf</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">@mapd W (ctxset W) (Mapd_ctxset W) =
@mapd W (ctxset W)
  (Mapd_Bindd W (ctxset W) (ctxset W))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk9b">ext A B f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">mapd f = mapd f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk9c"><span class="nb">rewrite</span> ctxset_mapd_to_bindd.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (Œ∑ ‚àò f) = mapd f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** ** Rewriting laws *)</span>
  <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk9d"><span class="kn">Lemma</span> <span class="nf">bindd_ctxset_nil</span> `{f : W * A -&gt; ctxset W B} :
    bindd f (@subset_empty (W * A)) = @subset_empty (W * B).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd f ‚àÖ = ‚àÖ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk9e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd f ‚àÖ = ‚àÖ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk9f">ext [w b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd f ‚àÖ (w, b) = ‚àÖ (w, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chka0"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> (<span class="nv">wa</span> : W) (<span class="nv">a</span> : A),
   ‚àÖ (wa, a) /\
   (<span class="kr">exists</span> <span class="nv">wb</span> : W, f (wa, a) (wb, b) /\ w = wa ‚óè wb)) =
‚àÖ (w, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chka1">propext.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> (<span class="nv">wa</span> : W) (<span class="nv">a</span> : A),
   ‚àÖ (wa, a) /\
   (<span class="kr">exists</span> <span class="nv">wb</span> : W, f (wa, a) (wb, b) /\ w = wa ‚óè wb)) -&gt;
‚àÖ (w, b)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ctxset-v-chka2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chka2"><hr></label><div class="goal-conclusion">‚àÖ (w, b) -&gt;
<span class="kr">exists</span> (<span class="nv">wa</span> : W) (<span class="nv">a</span> : A),
  ‚àÖ (wa, a) /\
  (<span class="kr">exists</span> <span class="nv">wb</span> : W, f (wa, a) (wb, b) /\ w = wa ‚óè wb)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chka3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">exists</span> (<span class="nv">wa</span> : W) (<span class="nv">a</span> : A),
   ‚àÖ (wa, a) /\
   (<span class="kr">exists</span> <span class="nv">wb</span> : W, f (wa, a) (wb, b) /\ w = wa ‚óè wb)) -&gt;
‚àÖ (w, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chka4"><span class="nb">intros</span> [wa [a [contra [w&#39; [Hin Heq]]]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>wa</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>contra</var><span class="hyp-type"><b>: </b><span>‚àÖ (wa, a)</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span>f (wa, a) (w&#39;, b)</span></span></span><br><span><var>Heq</var><span class="hyp-type"><b>: </b><span>w = wa ‚óè w&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚àÖ (w, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> contra.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chka5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">‚àÖ (w, b) -&gt;
<span class="kr">exists</span> (<span class="nv">wa</span> : W) (<span class="nv">a</span> : A),
  ‚àÖ (wa, a) /\
  (<span class="kr">exists</span> <span class="nv">wb</span> : W, f (wa, a) (wb, b) /\ w = wa ‚óè wb)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">inversion</span> <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chka6"><span class="kn">Lemma</span> <span class="nf">bindd_ctxset_one</span> `{f : W * A -&gt; ctxset W B} {w : W} {a : A} :
    bindd f {{ (w, a) }} = shift subset (w, f (w, a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd f {{(w, a)}} = shift subset (w, f (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chka7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd f {{(w, a)}} = shift subset (w, f (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chka8"><span class="nb">rewrite</span> ctxset_bindd_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind f) {{(w, a)}} =
shift subset (w, f (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chka9"><span class="nb">autorewrite with</span> tea_set.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(shift subset ‚àò cobind f) (w, a) =
shift subset (w, f (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkaa"><span class="kn">Lemma</span> <span class="nf">bindd_ctxset_add</span> `{f : W * A -&gt; ctxset W B} {x y} :
      bindd f (x ‚à™ y : ctxset W A) = bindd f x ‚à™ bindd f y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>W * A -&gt; <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd f (x ‚à™ y : ctxset W A) = bindd f x ‚à™ bindd f y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkab"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>W * A -&gt; <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd f (x ‚à™ y : ctxset W A) = bindd f x ‚à™ bindd f y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkac"><span class="nb">rewrite</span> ctxset_bindd_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>W * A -&gt; <span class="kt">Prop</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind f) (x ‚à™ y) =
bind (shift subset ‚àò cobind f) x
‚à™ bind (shift subset ‚àò cobind f) y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">autorewrite with</span> tea_set.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[local] <span class="kn">Hint Rewrite</span>
    @bindd_ctxset_nil @bindd_ctxset_one @bindd_ctxset_add
    : tea_set.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** ** Decorated monad laws *)</span>
  <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkad"><span class="kn">Lemma</span> <span class="nf">ctxset_bindd0</span> : <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : W * A -&gt; ctxset W B),
      bindd f ‚àò ret = f ‚àò pair ∆µ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : W * A -&gt; ctxset W B),
bindd f ‚àò Œ∑ = f ‚àò pair ∆µ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkae"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : W * A -&gt; ctxset W B),
bindd f ‚àò Œ∑ = f ‚àò pair ∆µ</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkaf"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd f ‚àò Œ∑ = f ‚àò pair ∆µ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkb0">ext a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(bindd f ‚àò Œ∑) a = (f ‚àò pair ∆µ) a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkb1"><span class="nb">rewrite</span> ctxset_bindd_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(bind (shift subset ‚àò cobind f) ‚àò Œ∑) a =
(f ‚àò pair ∆µ) a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkb2"><span class="nb">rewrite</span> ctxset_ret_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(bind (shift subset ‚àò cobind f) ‚àò (Œ∑ ‚àò Œ∑)) a =
(f ‚àò pair ∆µ) a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkb3"><span class="nb">unfold</span> compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚óã cobind f) (Œ∑ (Œ∑ a)) = f (∆µ, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkb4"><span class="nb">rewrite</span> bind_set_one.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift subset (cobind f (Œ∑ a)) = f (∆µ, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkb5"><span class="nb">change</span> (cobind f (Œ∑ a)) <span class="kr">with</span> (∆µ, f (∆µ, a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift subset (∆µ, f (∆µ, a)) = f (∆µ, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkb6"><span class="nb">unfold</span> ctxset. <span class="c">(* hidden *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift subset (∆µ, f (∆µ, a)) = f (∆µ, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkb7"><span class="nb">rewrite</span> (DecoratedFunctor.shift_zero subset).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (∆µ, a) = f (∆µ, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkb8"><span class="kn">Lemma</span> <span class="nf">ctxset_bindd1</span> : <span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
      bindd (T := ctxset W) (ret (T := ctxset W) ‚àò extract) = @id (ctxset W A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, bindd (Œ∑ ‚àò extract) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkb9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, bindd (Œ∑ ‚àò extract) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkba"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd (Œ∑ ‚àò extract) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkbb"><span class="nb">rewrite</span> ctxset_bindd_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind (Œ∑ ‚àò extract)) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkbc"><span class="nb">rewrite</span> &lt;- map_to_cobind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò map (Œ∑)) = id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkbd"><span class="nb">replace</span> (@id (ctxset W A))
      <span class="kr">with</span> (bind (U := subset) (T := subset) (@ret subset _ (W * A)))
      <span class="bp">by</span> (<span class="bp">now</span> <span class="nb">rewrite</span> kmon_bind1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò map (Œ∑)) = bind (Œ∑)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkbe">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift subset ‚àò map (Œ∑) = Œ∑</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkbf"><span class="nb">unfold</span> compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift subset ‚óã map (Œ∑) = Œ∑</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkc0">ext [w a].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift subset (map (Œ∑) (w, a)) = Œ∑ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkc1"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift subset (w, (Œ∑ ‚àò extract) (w, a)) = Œ∑ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkc2"><span class="nb">change</span> ((Œ∑ ‚àò extract) (w, a)) <span class="kr">with</span> (Œ∑ a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift subset (w, Œ∑ a) = Œ∑ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkc3"><span class="nb">rewrite</span> ctxset_ret_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift subset (w, (Œ∑ ‚àò Œ∑) a) = Œ∑ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkc4"><span class="nb">change</span> ((Œ∑ ‚àò Œ∑) a) <span class="kr">with</span> ({{ (∆µ, a) }}).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift subset (w, {{(∆µ, a)}}) = Œ∑ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkc5"><span class="nb">unfold</span> ctxset. <span class="c">(* hidden *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift subset (w, {{(∆µ, a)}}) = Œ∑ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkc6"><span class="nb">rewrite</span> (DecoratedFunctor.shift_spec subset).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m)) {{(∆µ, a)}} =
Œ∑ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkc7"><span class="nb">autorewrite with</span> tea_set.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{{map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m) (∆µ, a)}} = Œ∑ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkc8"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{{(w ‚óè ∆µ, id a)}} = Œ∑ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkc9">simpl_monoid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{{(w, id a)}} = Œ∑ (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkca"><span class="kn">Lemma</span> <span class="nf">ctxset_bindd2_lemma</span> :
    <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> :<span class="kt">Type</span>) (<span class="nv">g</span> : W * B -&gt; ctxset W C)
      (<span class="nv">f</span> : W * A -&gt; ctxset W B),
      kc1 (T := subset) (shift subset ‚àò cobind g)
        (shift subset ‚àò cobind f) =
        shift subset ‚àò cobind (g ‚ãÜ<span class="mi">5</span> f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : W * B -&gt; ctxset W C)
  (<span class="nv">f</span> : W * A -&gt; ctxset W B),
shift subset ‚àò cobind g ‚ãÜ<span class="mi">1</span> shift subset ‚àò cobind f =
shift subset ‚àò cobind (g ‚ãÜ<span class="mi">5</span> f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkcb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : W * B -&gt; ctxset W C)
  (<span class="nv">f</span> : W * A -&gt; ctxset W B),
shift subset ‚àò cobind g ‚ãÜ<span class="mi">1</span> shift subset ‚àò cobind f =
shift subset ‚àò cobind (g ‚ãÜ<span class="mi">5</span> f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkcc"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift subset ‚àò cobind g ‚ãÜ<span class="mi">1</span> shift subset ‚àò cobind f =
shift subset ‚àò cobind (g ‚ãÜ<span class="mi">5</span> f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkcd"><span class="nb">unfold</span> kc1, kc5.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind g)
‚àò (shift subset ‚àò cobind f) =
shift subset
‚àò cobind (<span class="kr">fun</span> &#39;(w, a) =&gt; bindd (g ‚¶ø w) (f (w, a)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkce">ext [w a].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(bind (shift subset ‚àò cobind g)
 ‚àò (shift subset ‚àò cobind f)) (w, a) =
(shift subset
 ‚àò cobind (<span class="kr">fun</span> &#39;(w, a) =&gt; bindd (g ‚¶ø w) (f (w, a))))
  (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkcf"><span class="nb">unfold</span> compose <span class="nb">at</span> <span class="mi">1</span> <span class="mi">3</span>. <span class="c">(* LHS *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind g)
  (shift subset (cobind f (w, a))) =
(shift subset
 ‚àò cobind (<span class="kr">fun</span> &#39;(w, a) =&gt; bindd (g ‚¶ø w) (f (w, a))))
  (w, a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkd0"><span class="nb">unfold</span> compose <span class="nb">at</span> <span class="mi">2</span>. <span class="c">(* RHS *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind g)
  (shift subset (cobind f (w, a))) =
shift subset
  (cobind (<span class="kr">fun</span> &#39;(w, a) =&gt; bindd (g ‚¶ø w) (f (w, a)))
     (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkd1"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind g)
  (shift subset (w, f (w, a))) =
shift subset (w, bindd (g ‚¶ø w) (f (w, a)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkd2"><span class="nb">rewrite</span> ctxset_bindd_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind g)
  (shift subset (w, f (w, a))) =
shift subset
  (w, bind (shift subset ‚àò cobind (g ‚¶ø w)) (f (w, a)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkd3"><span class="nb">unfold</span> ctxset.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind g)
  (shift subset (w, f (w, a))) =
shift subset
  (w, bind (shift subset ‚àò cobind (g ‚¶ø w)) (f (w, a)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkd4"><span class="nb">rewrite</span> (DecoratedFunctor.shift_spec subset).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind g)
  (map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m)) (f (w, a))) =
shift subset
  (w, bind (shift subset ‚àò cobind (g ‚¶ø w)) (f (w, a)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkd5"><span class="nb">rewrite</span> (DecoratedFunctor.shift_spec subset).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind g)
  (map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m)) (f (w, a))) =
map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m))
  (bind (shift subset ‚àò cobind (g ‚¶ø w)) (f (w, a)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkd6">compose near (f (w, a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(bind (shift subset ‚àò cobind g)
 ‚àò map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m))) (f (w, a)) =
(map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m))
 ‚àò bind (shift subset ‚àò cobind (g ‚¶ø w))) (f (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkd7"><span class="nb">rewrite</span> (bind_map (U := subset)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind
  (shift subset ‚àò cobind g
   ‚àò map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m)) (f (w, a)) =
(map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m))
 ‚àò bind (shift subset ‚àò cobind (g ‚¶ø w))) (f (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkd8"><span class="nb">rewrite</span> (map_bind (U := subset)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind
  (shift subset ‚àò cobind g
   ‚àò map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m)) (f (w, a)) =
bind
  (map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m))
   ‚àò (shift subset ‚àò cobind (g ‚¶ø w))) (f (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkd9">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">shift subset ‚àò cobind g ‚àò map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m) =
map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m))
‚àò (shift subset ‚àò cobind (g ‚¶ø w))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkda">ext [w&#39; b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(shift subset ‚àò cobind g
 ‚àò map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m)) (w&#39;, b) =
(map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m))
 ‚àò (shift subset ‚àò cobind (g ‚¶ø w))) (w&#39;, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkdb"><span class="nb">unfold</span> shift.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map (uncurry incr) ‚àò strength ‚àò cobind g
 ‚àò map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m)) (w&#39;, b) =
(map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m))
 ‚àò (map (uncurry incr) ‚àò strength ‚àò cobind (g ‚¶ø w)))
  (w&#39;, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkdc"><span class="kp">do</span> <span class="mi">2</span> reassociate &lt;- on <span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map (uncurry incr) ‚àò strength ‚àò cobind g
 ‚àò map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m)) (w&#39;, b) =
(map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m))
 ‚àò map (uncurry incr) ‚àò strength ‚àò cobind (g ‚¶ø w))
  (w&#39;, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkdd"><span class="nb">rewrite</span> (fun_map_map (F:= subset)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(map (uncurry incr) ‚àò strength ‚àò cobind g
 ‚àò map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m)) (w&#39;, b) =
(map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m) ‚àò uncurry incr)
 ‚àò strength ‚àò cobind (g ‚¶ø w)) (w&#39;, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkde"><span class="nb">rewrite</span> (map_strength_cobind_spec (G := subset) (E := W)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="kr">fun</span> &#39;(w, a) =&gt;
  map (uncurry incr ‚àò pair w) (g (w, a)))
 ‚àò map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m)) (w&#39;, b) =
(map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m) ‚àò uncurry incr)
 ‚àò strength ‚àò cobind (g ‚¶ø w)) (w&#39;, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkdf"><span class="nb">rewrite</span> (map_strength_cobind_spec (G := subset) (E := W)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="kr">fun</span> &#39;(w, a) =&gt;
  map (uncurry incr ‚àò pair w) (g (w, a)))
 ‚àò map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m)) (w&#39;, b) =
map
  (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m) ‚àò uncurry incr
   ‚àò pair w&#39;) ((g ‚¶ø w) (w&#39;, b))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chke0"><span class="nb">unfold</span> preincr, compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">let</span>
 &#39;(w, a) := map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m) (w&#39;, b) <span class="kr">in</span>
  map (uncurry incr ‚óã pair w) (g (w, a))) =
map
  (<span class="kr">fun</span> <span class="nv">a</span> : W * C =&gt;
   map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m) (uncurry incr (w&#39;, a)))
  (g (incr w (w&#39;, b)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chke1"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">map (<span class="kr">fun</span> <span class="nv">a</span> : W * C =&gt; incr (w ‚óè w&#39;) a)
  (g (w ‚óè w&#39;, id b)) =
map (map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m) ‚óã incr w&#39;)
  (g (w ‚óè w&#39;, b))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chke2">fequal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">a</span> : W * C =&gt; incr (w ‚óè w&#39;) a) =
map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m) ‚óã incr w&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chke3">ext [w&#39;&#39; c].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>w''</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">incr (w ‚óè w&#39;) (w&#39;&#39;, c) =
map_fst (<span class="kr">fun</span> <span class="nv">m</span> : W =&gt; w ‚óè m) (incr w&#39; (w&#39;&#39;, c))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chke4"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>w''</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((w ‚óè w&#39;) ‚óè w&#39;&#39;, c) = (w ‚óè (w&#39; ‚óè w&#39;&#39;), id c)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chke5">simpl_monoid.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w'</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>w''</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(w ‚óè (w&#39; ‚óè w&#39;&#39;), c) = (w ‚óè (w&#39; ‚óè w&#39;&#39;), id c)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chke6"><span class="kn">Lemma</span> <span class="nf">ctxset_bindd2</span> :
    <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : W * B -&gt; ctxset W C) (<span class="nv">f</span> : W * A -&gt; ctxset W B),
      bindd g ‚àò bindd f = bindd (g ‚ãÜ<span class="mi">5</span> f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : W * B -&gt; ctxset W C)
  (<span class="nv">f</span> : W * A -&gt; ctxset W B),
bindd g ‚àò bindd f = bindd (g ‚ãÜ<span class="mi">5</span> f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chke7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : W * B -&gt; ctxset W C)
  (<span class="nv">f</span> : W * A -&gt; ctxset W B),
bindd g ‚àò bindd f = bindd (g ‚ãÜ<span class="mi">5</span> f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chke8"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd g ‚àò bindd f = bindd (g ‚ãÜ<span class="mi">5</span> f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chke9"><span class="kp">do</span> <span class="mi">3</span> <span class="nb">rewrite</span> ctxset_bindd_spec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind g)
‚àò bind (shift subset ‚àò cobind f) =
bind (shift subset ‚àò cobind (g ‚ãÜ<span class="mi">5</span> f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkea"><span class="nb">unfold</span> ctxset. <span class="c">(*hidden*)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind g)
‚àò bind (shift subset ‚àò cobind f) =
bind (shift subset ‚àò cobind (g ‚ãÜ<span class="mi">5</span> f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkeb"><span class="nb">rewrite</span> (kmon_bind2 (T := subset)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind
  (shift subset ‚àò cobind g ‚ãÜ<span class="mi">1</span> shift subset ‚àò cobind f) =
bind (shift subset ‚àò cobind (g ‚ãÜ<span class="mi">5</span> f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkec"><span class="nb">rewrite</span> ctxset_bindd2_lemma.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>W * B -&gt; ctxset W C</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bind (shift subset ‚àò cobind (g ‚ãÜ<span class="mi">5</span> f)) =
bind (shift subset ‚àò cobind (g ‚ãÜ<span class="mi">5</span> f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">DecoratedRightPreModule_ctxset</span> :
    DecoratedRightPreModule W (ctxset W) (ctxset W) :=
    {| kmodd_bindd1 := ctxset_bindd1;
       kmodd_bindd2 := ctxset_bindd2;
    |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">DecoratedMonad_ctxset</span> :
    DecoratedMonad W (ctxset W) :=
    {| kmond_bindd0 := ctxset_bindd0;
    |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">DecoratedRightModule_ctxset</span> :
    DecoratedRightModule W (ctxset W) (ctxset W) :=
    {| kmodd_monad := _ |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** * &lt;&lt;bindd&gt;&gt; is a monoid homomorphism *)</span>
  <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chked">#[export] <span class="kn">Instance</span> <span class="nf">Monmor_ctxset_bindd</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">f</span>} :
    Monoid_Morphism (ctxset W A) (ctxset W B) (bindd f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid_Morphism (ctxset W A) (ctxset W B) (bindd f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkee"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid_Morphism (ctxset W A) (ctxset W B) (bindd f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkef"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid (ctxset W A)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ctxset-v-chkf0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chkf0"><hr></label><div class="goal-conclusion">Monoid (ctxset W B)</div></blockquote><input class="alectryon-extra-goal-toggle" id="ctxset-v-chkf1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chkf1"><hr></label><div class="goal-conclusion">bindd f ∆µ = ∆µ</div></blockquote><input class="alectryon-extra-goal-toggle" id="ctxset-v-chkf2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chkf2"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a1</span> <span class="nv">a2</span> : ctxset W A,
bindd f (a1 ‚óè a2) = bindd f a1 ‚óè bindd f a2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkf3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid (ctxset W A)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkf4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid (ctxset W B)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkf5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd f ∆µ = ∆µ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">now</span> <span class="nb">rewrite</span> bindd_ctxset_nil.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkf6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a1</span> <span class="nv">a2</span> : ctxset W A,
bindd f (a1 ‚óè a2) = bindd f a1 ‚óè bindd f a2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkf7"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>W * A -&gt; ctxset W B</span></span></span><br><span><var>a1, a2</var><span class="hyp-type"><b>: </b><span>ctxset W A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">bindd f (a1 ‚óè a2) = bindd f a1 ‚óè bindd f a2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> bindd_ctxset_add.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** * Querying for an element is a monoid homomorphism *)</span>
  <span class="sd">(******************************************************************************)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkf8">#[export] <span class="kn">Instance</span> <span class="nf">Monmor_ctxset_evalAt</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">w</span> : W) (<span class="nv">a</span> : A) :
    @Monoid_Morphism (ctxset W A) <span class="kt">Prop</span>
      (@Monoid_op_subset (W * A))
      (@Monoid_unit_subset (W * A))
      (Monoid_op_or) (Monoid_unit_false)
      (evalAt (w, a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid_Morphism (ctxset W A) <span class="kt">Prop</span> (evalAt (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkf9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid_Morphism (ctxset W A) <span class="kt">Prop</span> (evalAt (w, a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkfa"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid (ctxset W A)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="ctxset-v-chkfb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chkfb"><hr></label><div class="goal-conclusion">Monoid <span class="kt">Prop</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="ctxset-v-chkfc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chkfc"><hr></label><div class="goal-conclusion">evalAt (w, a) ∆µ = ∆µ</div></blockquote><input class="alectryon-extra-goal-toggle" id="ctxset-v-chkfd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><label class="goal-separator" for="ctxset-v-chkfd"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a1</span> <span class="nv">a2</span> : ctxset W A,
evalAt (w, a) (a1 ‚óè a2) =
evalAt (w, a) a1 ‚óè evalAt (w, a) a2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkfe">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid (ctxset W A)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chkff">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Monoid <span class="kt">Prop</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk100">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">evalAt (w, a) ∆µ = ∆µ</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="ctxset-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="ctxset-v-chk101">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>W</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>op</var><span class="hyp-type"><b>: </b><span>Monoid_op W</span></span></span><br><span><var>unit0</var><span class="hyp-type"><b>: </b><span>Monoid_unit W</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Monoid W</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>W</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a1</span> <span class="nv">a2</span> : ctxset W A,
evalAt (w, a) (a1 ‚óè a2) =
evalAt (w, a) a1 ‚óè evalAt (w, a) a2</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">ctxset</span>.</span></span></pre>
</div>
</div></body>
</html>
